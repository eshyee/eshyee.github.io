<!DOCTYPE html><html lang="zh_CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>学习pandas(从kaggle上) | SHYEE-PLASMA</title><meta name="author" content="SHYEE"><meta name="copyright" content="SHYEE"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="先来个小测试1234import pandas as pdprint(&quot;Setup complete.&quot;)  Setup complete.  1.In the cell below, create a DataFrame fruits that looks like this:  123# Your code goes here. Create a dataframe mat">
<meta property="og:type" content="article">
<meta property="og:title" content="学习pandas(从kaggle上)">
<meta property="og:url" content="https://eshyee.github.io/2023/07/18/%E5%AD%A6%E4%B9%A0pandas-%E4%BB%8Ekaggle%E4%B8%8A/index.html">
<meta property="og:site_name" content="SHYEE-PLASMA">
<meta property="og:description" content="先来个小测试1234import pandas as pdprint(&quot;Setup complete.&quot;)  Setup complete.  1.In the cell below, create a DataFrame fruits that looks like this:  123# Your code goes here. Create a dataframe mat">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://source.unsplash.com/1920x1080/?plasma">
<meta property="article:published_time" content="2023-07-18T14:16:20.000Z">
<meta property="article:modified_time" content="2023-08-28T12:43:11.428Z">
<meta property="article:author" content="SHYEE">
<meta property="article:tag" content="python">
<meta property="article:tag" content="pandas">
<meta property="article:tag" content="kaggle">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://source.unsplash.com/1920x1080/?plasma"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://eshyee.github.io/2023/07/18/%E5%AD%A6%E4%B9%A0pandas-%E4%BB%8Ekaggle%E4%B8%8A/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":true,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: {"limitCount":50,"languages":{"author":"Author: SHYEE","link":"Link: ","source":"Source: SHYEE-PLASMA","info":"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source."}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '学习pandas(从kaggle上)',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-08-28 20:43:11'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script><meta name="generator" content="Hexo 5.4.2"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/pic/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">106</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">107</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">37</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 列表</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://source.unsplash.com/1920x1080/?plasma')"><nav id="nav"><span id="blog-info"><a href="/" title="SHYEE-PLASMA"><span class="site-name">SHYEE-PLASMA</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 列表</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">学习pandas(从kaggle上)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-07-18T14:16:20.000Z" title="Created 2023-07-18 22:16:20">2023-07-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-08-28T12:43:11.428Z" title="Updated 2023-08-28 20:43:11">2023-08-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/python/">python</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">22.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>121min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="学习pandas(从kaggle上)"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="先来个小测试"><a href="#先来个小测试" class="headerlink" title="先来个小测试"></a>先来个小测试</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Setup complete.&quot;</span>)</span><br></pre></td></tr></table></figure>

<pre><code>Setup complete.
</code></pre>
<h2 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h2><p>In the cell below, create a DataFrame <code>fruits</code> that looks like this:</p>
<p><img src="https://i.imgur.com/Ax3pp2A.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Your code goes here. Create a dataframe matching the above diagram and assign it to the variable fruits.</span></span><br><span class="line">fruits = pd.DataFrame(&#123;<span class="string">&#x27;Apples&#x27;</span>: [<span class="number">30</span>], <span class="string">&#x27;Bananas&#x27;</span>: [<span class="number">21</span>]&#125;)</span><br><span class="line"><span class="built_in">print</span>(fruits)</span><br></pre></td></tr></table></figure>

<pre><code>   Apples  Bananas
0      30       21
</code></pre>
<h2 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h2><p>Create a dataframe <code>fruit_sales</code> that matches the diagram below:</p>
<p><img src="https://i.imgur.com/CHPn7ZF.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Your code goes here. Create a dataframe matching the above diagram and assign it to the variable fruit_sales.</span></span><br><span class="line">fruit_sales = pd.DataFrame(&#123;<span class="string">&#x27;Apples&#x27;</span>: [<span class="number">35</span>,<span class="number">41</span>], <span class="string">&#x27;Bananas&#x27;</span>: [<span class="number">21</span>,<span class="number">34</span>]&#125;,index= [<span class="string">&#x27;2017 Sales&#x27;</span>,<span class="string">&#x27;2018 Sales&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(fruit_sales)</span><br></pre></td></tr></table></figure>

<pre><code>            Apples  Bananas
2017 Sales      35       21
2018 Sales      41       34
</code></pre>
<h2 id="3"><a href="#3" class="headerlink" title="3."></a>3.</h2><p>Create a variable <code>ingredients</code> with a Series that looks like:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Flour     4 cups</span><br><span class="line">Milk       1 cup</span><br><span class="line">Eggs     2 large</span><br><span class="line">Spam       1 can</span><br><span class="line">Name: Dinner, dtype: object</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ingredients = pd.Series([<span class="string">&#x27;4 cups&#x27;</span>,<span class="string">&#x27;1 cup&#x27;</span>, <span class="string">&#x27;2 large&#x27;</span>, <span class="string">&#x27;1 can&#x27;</span>],index=[<span class="string">&#x27;Flour&#x27;</span>,<span class="string">&#x27;Milk&#x27;</span>,<span class="string">&#x27;Eggs&#x27;</span>,<span class="string">&#x27;Spam&#x27;</span>],name=<span class="string">&#x27;Dinner&#x27;</span>,dtype=<span class="built_in">object</span>)</span><br><span class="line">ingredients</span><br></pre></td></tr></table></figure>




<pre><code>Flour     4 cups
Milk       1 cup
Eggs     2 large
Spam       1 can
Name: Dinner, dtype: object
</code></pre>
<h2 id="4"><a href="#4" class="headerlink" title="4."></a>4.</h2><p>Read the following csv dataset of wine reviews into a DataFrame called <code>reviews</code>:</p>
<p><img src="https://i.imgur.com/74RCZtU.png"></p>
<p>The filepath to the csv file is <code>../input/wine-reviews/winemag-data_first150k.csv</code>. The first few lines look like:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">,country,description,designation,points,price,province,region_1,region_2,variety,winery</span><br><span class="line">0,US,&quot;This tremendous 100% varietal wine[...]&quot;,Martha&#x27;s Vineyard,96,235.0,California,Napa Valley,Napa,Cabernet Sauvignon,Heitz</span><br><span class="line">1,Spain,&quot;Ripe aromas of fig, blackberry and[...]&quot;,Carodorum Selección Especial Reserva,96,110.0,Northern Spain,Toro,,Tinta de Toro,Bodega Carmen Rodríguez</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews = pd.read_csv(<span class="string">&#x27;../input/wine-reviews/winemag-data_first150k.csv&#x27;</span>,index_col=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<p>reviews &#x3D; pd.read_csv(‘..&#x2F;input&#x2F;wine-reviews&#x2F;winemag-data_first150k.csv’,index_col&#x3D;0)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">animals = pd.DataFrame(&#123;<span class="string">&#x27;Cows&#x27;</span>: [<span class="number">12</span>, <span class="number">20</span>], <span class="string">&#x27;Goats&#x27;</span>: [<span class="number">22</span>, <span class="number">19</span>]&#125;, index=[<span class="string">&#x27;Year 1&#x27;</span>, <span class="string">&#x27;Year 2&#x27;</span>])</span><br><span class="line">animals</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Cows</th>
      <th>Goats</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Year 1</th>
      <td>12</td>
      <td>22</td>
    </tr>
    <tr>
      <th>Year 2</th>
      <td>20</td>
      <td>19</td>
    </tr>
  </tbody>
</table>
</div>



<p>In the cell below, write code to save this DataFrame to disk as a csv file with the name <code>cows_and_goats.csv</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">animals.to_csv(<span class="string">&#x27;cows_and_goats.csv&#x27;</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">reviews = pd.read_csv(<span class="string">&quot;datasets/wine/winemag-data-130k-v2.csv&quot;</span>, index_col=<span class="number">0</span>)</span><br><span class="line">reviews</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>description</th>
      <th>designation</th>
      <th>points</th>
      <th>price</th>
      <th>province</th>
      <th>region_1</th>
      <th>region_2</th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>title</th>
      <th>variety</th>
      <th>winery</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Italy</td>
      <td>Aromas include tropical fruit, broom, brimston...</td>
      <td>Vulkà Bianco</td>
      <td>87</td>
      <td>NaN</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Etna</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Nicosia 2013 Vulkà Bianco  (Etna)</td>
      <td>White Blend</td>
      <td>Nicosia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Portugal</td>
      <td>This is ripe and fruity, a wine that is smooth...</td>
      <td>Avidagos</td>
      <td>87</td>
      <td>15.0</td>
      <td>Douro</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Quinta dos Avidagos 2011 Avidagos Red (Douro)</td>
      <td>Portuguese Red</td>
      <td>Quinta dos Avidagos</td>
    </tr>
    <tr>
      <th>2</th>
      <td>US</td>
      <td>Tart and snappy, the flavors of lime flesh and...</td>
      <td>NaN</td>
      <td>87</td>
      <td>14.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Rainstorm 2013 Pinot Gris (Willamette Valley)</td>
      <td>Pinot Gris</td>
      <td>Rainstorm</td>
    </tr>
    <tr>
      <th>3</th>
      <td>US</td>
      <td>Pineapple rind, lemon pith and orange blossom ...</td>
      <td>Reserve Late Harvest</td>
      <td>87</td>
      <td>13.0</td>
      <td>Michigan</td>
      <td>Lake Michigan Shore</td>
      <td>NaN</td>
      <td>Alexander Peartree</td>
      <td>NaN</td>
      <td>St. Julian 2013 Reserve Late Harvest Riesling ...</td>
      <td>Riesling</td>
      <td>St. Julian</td>
    </tr>
    <tr>
      <th>4</th>
      <td>US</td>
      <td>Much like the regular bottling from 2012, this...</td>
      <td>Vintner's Reserve Wild Child Block</td>
      <td>87</td>
      <td>65.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Sweet Cheeks 2012 Vintner's Reserve Wild Child...</td>
      <td>Pinot Noir</td>
      <td>Sweet Cheeks</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>129966</th>
      <td>Germany</td>
      <td>Notes of honeysuckle and cantaloupe sweeten th...</td>
      <td>Brauneberger Juffer-Sonnenuhr Spätlese</td>
      <td>90</td>
      <td>28.0</td>
      <td>Mosel</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Anna Lee C. Iijima</td>
      <td>NaN</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef) 2013 ...</td>
      <td>Riesling</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef)</td>
    </tr>
    <tr>
      <th>129967</th>
      <td>US</td>
      <td>Citation is given as much as a decade of bottl...</td>
      <td>NaN</td>
      <td>90</td>
      <td>75.0</td>
      <td>Oregon</td>
      <td>Oregon</td>
      <td>Oregon Other</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Citation 2004 Pinot Noir (Oregon)</td>
      <td>Pinot Noir</td>
      <td>Citation</td>
    </tr>
    <tr>
      <th>129968</th>
      <td>France</td>
      <td>Well-drained gravel soil gives this wine its c...</td>
      <td>Kritt</td>
      <td>90</td>
      <td>30.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Gresser 2013 Kritt Gewurztraminer (Als...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Gresser</td>
    </tr>
    <tr>
      <th>129969</th>
      <td>France</td>
      <td>A dry style of Pinot Gris, this is crisp with ...</td>
      <td>NaN</td>
      <td>90</td>
      <td>32.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Marcel Deiss 2012 Pinot Gris (Alsace)</td>
      <td>Pinot Gris</td>
      <td>Domaine Marcel Deiss</td>
    </tr>
    <tr>
      <th>129970</th>
      <td>France</td>
      <td>Big, rich and off-dry, this is powered by inte...</td>
      <td>Lieu-dit Harth Cuvée Caroline</td>
      <td>90</td>
      <td>21.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Schoffit 2012 Lieu-dit Harth Cuvée Car...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Schoffit</td>
    </tr>
  </tbody>
</table>
<p>129971 rows × 13 columns</p>
</div>



<p>我们将数据当对象来访问</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.country</span><br></pre></td></tr></table></figure>




<pre><code>0            Italy
1         Portugal
2               US
3               US
4               US
            ...   
129966     Germany
129967          US
129968      France
129969      France
129970      France
Name: country, Length: 129971, dtype: object
</code></pre>
<p>如果我们有一个 Python 字典，我们可以使用索引 ([]) 运算符访问它的值。我们可以对 DataFrame 中的列执行相同的操作：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews[<span class="string">&#x27;country&#x27;</span>]</span><br></pre></td></tr></table></figure>




<pre><code>0            Italy
1         Portugal
2               US
3               US
4               US
            ...   
129966     Germany
129967          US
129968      France
129969      France
129970      France
Name: country, Length: 129971, dtype: object
</code></pre>
<p>这是从 DataFrame 中选择特定 Series 的两种方法。这两种方法在语法上都不太有效，但索引操作符[]的优点是可以处理列名中的保留字符（例如，如果我们有一个country providence列，reviews.country providence就不起作用）。</p>
<p>pandas 系列看起来不像一本精美的dictionary吗？几乎是这样，所以毫不奇怪，要深入到单个特定值，我们只需要再次使用索引运算符 [] ：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews[<span class="string">&#x27;country&#x27;</span>][<span class="number">0</span>]</span><br></pre></td></tr></table></figure>




<pre><code>&#39;Italy&#39;
</code></pre>
<h1 id="Indexing-in-pandas"><a href="#Indexing-in-pandas" class="headerlink" title="Indexing in pandas"></a>Indexing in pandas</h1><p>索引运算符和属性选择很好，因为它们就像在 Python 生态系统的其它部分一样工作。作为新手，这使得它们很容易上手和使用。然而，pandas有自己的访问操作符，loc和iloc。对于更高级的操作，你应该使用它们。</p>
<h2 id="Index-based-selection"><a href="#Index-based-selection" class="headerlink" title="Index-based selection"></a>Index-based selection</h2><p>Pandas 索引以两种范式之一工作。第一种是基于索引的选择：根据数据在数据中的数字位置来选择数据。iloc遵循这一范例。</p>
<p>要选择 DataFrame 中的第一行数据，我们可以使用以下命令：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.iloc[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>




<pre><code>country                                                              Italy
description              Aromas include tropical fruit, broom, brimston...
designation                                                   Vulkà Bianco
points                                                                  87
price                                                                  NaN
province                                                 Sicily &amp; Sardinia
region_1                                                              Etna
region_2                                                               NaN
taster_name                                                  Kerin O’Keefe
taster_twitter_handle                                         @kerinokeefe
title                                    Nicosia 2013 Vulkà Bianco  (Etna)
variety                                                        White Blend
winery                                                             Nicosia
Name: 0, dtype: object
</code></pre>
<p>loc 和 iloc 都是行第一、列第二。这与我们在原生 Python 中所做的相反，即列在前，行在后。</p>
<p>这意味着检索行稍微容易一些，而检索列稍微困难一些。要使用 iloc 获取列，我们可以执行以下操作：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.iloc[:, <span class="number">0</span>]</span><br></pre></td></tr></table></figure>




<pre><code>0            Italy
1         Portugal
2               US
3               US
4               US
            ...   
129966     Germany
129967          US
129968      France
129969      France
129970      France
Name: country, Length: 129971, dtype: object
</code></pre>
<p>就其本身而言，:操作符（也来自本地Python）表示 “一切”。然而，当与其他选择器组合时，它可以用来表示值的范围。例如，要从第一、第二和第三行中选择country列，我们可以这样做</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.iloc[:<span class="number">3</span>, <span class="number">0</span>]</span><br></pre></td></tr></table></figure>




<pre><code>0       Italy
1    Portugal
2          US
Name: country, dtype: object
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.iloc[<span class="number">999</span>:-<span class="number">99999</span>, <span class="number">0</span>]</span><br></pre></td></tr></table></figure>




<pre><code>999             US
1000            US
1001         Italy
1002            US
1003        France
           ...    
29967       France
29968           US
29969    Argentina
29970           US
29971           US
Name: country, Length: 28973, dtype: object
</code></pre>
<p>It’s also possible to pass a list:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.iloc[[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>], <span class="number">0</span>]</span><br></pre></td></tr></table></figure>




<pre><code>0       Italy
1    Portugal
2          US
Name: country, dtype: object
</code></pre>
<p>最后，值得注意的是，负数可以用于选择。这将从数值的末尾开始向前计数。例如，这里是数据集的最后五个元素。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.iloc[-<span class="number">5</span>:]</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>description</th>
      <th>designation</th>
      <th>points</th>
      <th>price</th>
      <th>province</th>
      <th>region_1</th>
      <th>region_2</th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>title</th>
      <th>variety</th>
      <th>winery</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>129966</th>
      <td>Germany</td>
      <td>Notes of honeysuckle and cantaloupe sweeten th...</td>
      <td>Brauneberger Juffer-Sonnenuhr Spätlese</td>
      <td>90</td>
      <td>28.0</td>
      <td>Mosel</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Anna Lee C. Iijima</td>
      <td>NaN</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef) 2013 ...</td>
      <td>Riesling</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef)</td>
    </tr>
    <tr>
      <th>129967</th>
      <td>US</td>
      <td>Citation is given as much as a decade of bottl...</td>
      <td>NaN</td>
      <td>90</td>
      <td>75.0</td>
      <td>Oregon</td>
      <td>Oregon</td>
      <td>Oregon Other</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Citation 2004 Pinot Noir (Oregon)</td>
      <td>Pinot Noir</td>
      <td>Citation</td>
    </tr>
    <tr>
      <th>129968</th>
      <td>France</td>
      <td>Well-drained gravel soil gives this wine its c...</td>
      <td>Kritt</td>
      <td>90</td>
      <td>30.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Gresser 2013 Kritt Gewurztraminer (Als...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Gresser</td>
    </tr>
    <tr>
      <th>129969</th>
      <td>France</td>
      <td>A dry style of Pinot Gris, this is crisp with ...</td>
      <td>NaN</td>
      <td>90</td>
      <td>32.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Marcel Deiss 2012 Pinot Gris (Alsace)</td>
      <td>Pinot Gris</td>
      <td>Domaine Marcel Deiss</td>
    </tr>
    <tr>
      <th>129970</th>
      <td>France</td>
      <td>Big, rich and off-dry, this is powered by inte...</td>
      <td>Lieu-dit Harth Cuvée Caroline</td>
      <td>90</td>
      <td>21.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Schoffit 2012 Lieu-dit Harth Cuvée Car...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Schoffit</td>
    </tr>
  </tbody>
</table>
</div>



<h2 id="Label-based-selection"><a href="#Label-based-selection" class="headerlink" title="Label-based selection"></a>Label-based selection</h2><p>属性选择的第二种模式是loc操作符所遵循的模式：基于标签的选择。在这种模式下，重要的是数据索引值，而不是它的位置。</p>
<p>例如，要获得reviews中的第一个条目，我们现在要做如下操作：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.loc[<span class="number">0</span>, <span class="string">&#x27;country&#x27;</span>]</span><br></pre></td></tr></table></figure>




<pre><code>&#39;Italy&#39;
</code></pre>
<p>iloc在概念上比loc简单，因为它忽略了数据集的索引。当我们使用 iloc 时，我们把数据集当作一个大矩阵（一个列表的列表），一个我们必须按位置进行索引的矩阵。由于您的数据集通常具有有意义的索引，因此使用loc通常会更容易。例如，这里有一个使用loc更容易的操作：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.loc[:, [<span class="string">&#x27;taster_name&#x27;</span>, <span class="string">&#x27;taster_twitter_handle&#x27;</span>, <span class="string">&#x27;points&#x27;</span>]]</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>points</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>87</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>87</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>87</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Alexander Peartree</td>
      <td>NaN</td>
      <td>87</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>87</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>129966</th>
      <td>Anna Lee C. Iijima</td>
      <td>NaN</td>
      <td>90</td>
    </tr>
    <tr>
      <th>129967</th>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>90</td>
    </tr>
    <tr>
      <th>129968</th>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>90</td>
    </tr>
    <tr>
      <th>129969</th>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>90</td>
    </tr>
    <tr>
      <th>129970</th>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
<p>129971 rows × 3 columns</p>
</div>



<h2 id="Choosing-between-loc-and-iloc"><a href="#Choosing-between-loc-and-iloc" class="headerlink" title="Choosing between loc and iloc"></a>Choosing between loc and iloc</h2><p>在 loc 和 iloc 之间选择或转换时，有一个 “小问题 “值得注意，那就是这两种方法使用的索引方案略有不同。</p>
<p>iloc 使用 Python stdlib 索引方案，其中包含范围的第一个元素，而排除最后一个元素。因此，0:10 将选择条目 0,……9。而loc包含最后一个元素，因此0:10将选择0,…,10。</p>
<p>为什么会有这样的变化？请记住，loc可以索引任何stdlib类型：例如字符串。如果我们有一个索引值为 Apples, …, Potatoes, … 的 DataFrame，并且我们想选择 “所有按字母顺序排列的苹果和土豆之间的水果选择”，那么索引 df.loc[‘Apples’:’Potatoes’] 要比索引 df.loc[‘Apples’, ‘Potatoet’] 这样的东西方便得多 (t 在字母表的 s 后面)。</p>
<p>当DataFrame索引是一个简单的数字列表（例如0,…,1000）时，这种情况尤其令人困惑。在这种情况下，df.iloc[0:1000]将返回1000个条目，而df.loc[0:1000]将返回1001个条目！要使用 loc 得到 1000 个元素，您需要再低一级，请求 df.loc[0:999]。</p>
<p>否则，使用loc的语义和使用iloc的语义是一样的。</p>
<h2 id="Manipulating-the-index"><a href="#Manipulating-the-index" class="headerlink" title="Manipulating the index"></a>Manipulating the index</h2><p>基于标签的选择功能来自索引中的标签。重要的是，我们使用的索引并非一成不变。我们可以以任何我们认为合适的方式操作索引。</p>
<p>我们可以使用set_index()方法来完成这项工作。下面是当我们将set_index设置为title字段时发生的情况：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.set_index(<span class="string">&quot;title&quot;</span>)</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>description</th>
      <th>designation</th>
      <th>points</th>
      <th>price</th>
      <th>province</th>
      <th>region_1</th>
      <th>region_2</th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>variety</th>
      <th>winery</th>
    </tr>
    <tr>
      <th>title</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Nicosia 2013 Vulkà Bianco  (Etna)</th>
      <td>Italy</td>
      <td>Aromas include tropical fruit, broom, brimston...</td>
      <td>Vulkà Bianco</td>
      <td>87</td>
      <td>NaN</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Etna</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>White Blend</td>
      <td>Nicosia</td>
    </tr>
    <tr>
      <th>Quinta dos Avidagos 2011 Avidagos Red (Douro)</th>
      <td>Portugal</td>
      <td>This is ripe and fruity, a wine that is smooth...</td>
      <td>Avidagos</td>
      <td>87</td>
      <td>15.0</td>
      <td>Douro</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Portuguese Red</td>
      <td>Quinta dos Avidagos</td>
    </tr>
    <tr>
      <th>Rainstorm 2013 Pinot Gris (Willamette Valley)</th>
      <td>US</td>
      <td>Tart and snappy, the flavors of lime flesh and...</td>
      <td>NaN</td>
      <td>87</td>
      <td>14.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Pinot Gris</td>
      <td>Rainstorm</td>
    </tr>
    <tr>
      <th>St. Julian 2013 Reserve Late Harvest Riesling (Lake Michigan Shore)</th>
      <td>US</td>
      <td>Pineapple rind, lemon pith and orange blossom ...</td>
      <td>Reserve Late Harvest</td>
      <td>87</td>
      <td>13.0</td>
      <td>Michigan</td>
      <td>Lake Michigan Shore</td>
      <td>NaN</td>
      <td>Alexander Peartree</td>
      <td>NaN</td>
      <td>Riesling</td>
      <td>St. Julian</td>
    </tr>
    <tr>
      <th>Sweet Cheeks 2012 Vintner's Reserve Wild Child Block Pinot Noir (Willamette Valley)</th>
      <td>US</td>
      <td>Much like the regular bottling from 2012, this...</td>
      <td>Vintner's Reserve Wild Child Block</td>
      <td>87</td>
      <td>65.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Pinot Noir</td>
      <td>Sweet Cheeks</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Dr. H. Thanisch (Erben Müller-Burggraef) 2013 Brauneberger Juffer-Sonnenuhr Spätlese Riesling (Mosel)</th>
      <td>Germany</td>
      <td>Notes of honeysuckle and cantaloupe sweeten th...</td>
      <td>Brauneberger Juffer-Sonnenuhr Spätlese</td>
      <td>90</td>
      <td>28.0</td>
      <td>Mosel</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Anna Lee C. Iijima</td>
      <td>NaN</td>
      <td>Riesling</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef)</td>
    </tr>
    <tr>
      <th>Citation 2004 Pinot Noir (Oregon)</th>
      <td>US</td>
      <td>Citation is given as much as a decade of bottl...</td>
      <td>NaN</td>
      <td>90</td>
      <td>75.0</td>
      <td>Oregon</td>
      <td>Oregon</td>
      <td>Oregon Other</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Pinot Noir</td>
      <td>Citation</td>
    </tr>
    <tr>
      <th>Domaine Gresser 2013 Kritt Gewurztraminer (Alsace)</th>
      <td>France</td>
      <td>Well-drained gravel soil gives this wine its c...</td>
      <td>Kritt</td>
      <td>90</td>
      <td>30.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Gewürztraminer</td>
      <td>Domaine Gresser</td>
    </tr>
    <tr>
      <th>Domaine Marcel Deiss 2012 Pinot Gris (Alsace)</th>
      <td>France</td>
      <td>A dry style of Pinot Gris, this is crisp with ...</td>
      <td>NaN</td>
      <td>90</td>
      <td>32.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Pinot Gris</td>
      <td>Domaine Marcel Deiss</td>
    </tr>
    <tr>
      <th>Domaine Schoffit 2012 Lieu-dit Harth Cuvée Caroline Gewurztraminer (Alsace)</th>
      <td>France</td>
      <td>Big, rich and off-dry, this is powered by inte...</td>
      <td>Lieu-dit Harth Cuvée Caroline</td>
      <td>90</td>
      <td>21.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Gewürztraminer</td>
      <td>Domaine Schoffit</td>
    </tr>
  </tbody>
</table>
<p>129971 rows × 12 columns</p>
</div>



<p>如果您可以为数据集找到一个比当前索引更好的索引，那么这将非常有用。</p>
<h2 id="Conditional-selection"><a href="#Conditional-selection" class="headerlink" title="Conditional selection"></a>Conditional selection</h2><p>到目前为止，我们已经使用 DataFrame 本身的结构属性对各种数据进行索引。然而，为了利用数据做有趣的事情，我们经常需要根据条件提出问题。</p>
<p>例如，假设我们对意大利生产的优于平均水平的葡萄酒特别感兴趣。 </p>
<p>我们可以首先检查每种葡萄酒是否是意大利的：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.country == <span class="string">&#x27;Italy&#x27;</span></span><br></pre></td></tr></table></figure>




<pre><code>0          True
1         False
2         False
3         False
4         False
          ...  
129966    False
129967    False
129968    False
129969    False
129970    False
Name: country, Length: 129971, dtype: bool
</code></pre>
<p>此操作根据每条记录的国家&#x2F;地区生成一系列 True&#x2F;False 布尔值。然后可以在 loc 内部使用此结果来选择相关数据：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.loc[reviews.country == <span class="string">&#x27;Italy&#x27;</span>]</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>description</th>
      <th>designation</th>
      <th>points</th>
      <th>price</th>
      <th>province</th>
      <th>region_1</th>
      <th>region_2</th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>title</th>
      <th>variety</th>
      <th>winery</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Italy</td>
      <td>Aromas include tropical fruit, broom, brimston...</td>
      <td>Vulkà Bianco</td>
      <td>87</td>
      <td>NaN</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Etna</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Nicosia 2013 Vulkà Bianco  (Etna)</td>
      <td>White Blend</td>
      <td>Nicosia</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Italy</td>
      <td>Here's a bright, informal red that opens with ...</td>
      <td>Belsito</td>
      <td>87</td>
      <td>16.0</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Vittoria</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Terre di Giurfo 2013 Belsito Frappato (Vittoria)</td>
      <td>Frappato</td>
      <td>Terre di Giurfo</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Italy</td>
      <td>This is dominated by oak and oak-driven aromas...</td>
      <td>Rosso</td>
      <td>87</td>
      <td>NaN</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Etna</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Masseria Setteporte 2012 Rosso  (Etna)</td>
      <td>Nerello Mascalese</td>
      <td>Masseria Setteporte</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Italy</td>
      <td>Delicate aromas recall white flower and citrus...</td>
      <td>Ficiligno</td>
      <td>87</td>
      <td>19.0</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Sicilia</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Baglio di Pianetto 2007 Ficiligno White (Sicilia)</td>
      <td>White Blend</td>
      <td>Baglio di Pianetto</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Italy</td>
      <td>Aromas of prune, blackcurrant, toast and oak c...</td>
      <td>Aynat</td>
      <td>87</td>
      <td>35.0</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Sicilia</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Canicattì 2009 Aynat Nero d'Avola (Sicilia)</td>
      <td>Nero d'Avola</td>
      <td>Canicattì</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>129929</th>
      <td>Italy</td>
      <td>This luminous sparkler has a sweet, fruit-forw...</td>
      <td>NaN</td>
      <td>91</td>
      <td>38.0</td>
      <td>Veneto</td>
      <td>Prosecco Superiore di Cartizze</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Col Vetoraz Spumanti NV  Prosecco Superiore di...</td>
      <td>Prosecco</td>
      <td>Col Vetoraz Spumanti</td>
    </tr>
    <tr>
      <th>129943</th>
      <td>Italy</td>
      <td>A blend of Nero d'Avola and Syrah, this convey...</td>
      <td>Adènzia</td>
      <td>90</td>
      <td>29.0</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Sicilia</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Baglio del Cristo di Campobello 2012 Adènzia R...</td>
      <td>Red Blend</td>
      <td>Baglio del Cristo di Campobello</td>
    </tr>
    <tr>
      <th>129947</th>
      <td>Italy</td>
      <td>A blend of 65% Cabernet Sauvignon, 30% Merlot ...</td>
      <td>Symposio</td>
      <td>90</td>
      <td>20.0</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Terre Siciliane</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Feudo Principi di Butera 2012 Symposio Red (Te...</td>
      <td>Red Blend</td>
      <td>Feudo Principi di Butera</td>
    </tr>
    <tr>
      <th>129961</th>
      <td>Italy</td>
      <td>Intense aromas of wild cherry, baking spice, t...</td>
      <td>NaN</td>
      <td>90</td>
      <td>30.0</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Sicilia</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>COS 2013 Frappato (Sicilia)</td>
      <td>Frappato</td>
      <td>COS</td>
    </tr>
    <tr>
      <th>129962</th>
      <td>Italy</td>
      <td>Blackberry, cassis, grilled herb and toasted a...</td>
      <td>Sàgana Tenuta San Giacomo</td>
      <td>90</td>
      <td>40.0</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Sicilia</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Cusumano 2012 Sàgana Tenuta San Giacomo Nero d...</td>
      <td>Nero d'Avola</td>
      <td>Cusumano</td>
    </tr>
  </tbody>
</table>
<p>19540 rows × 13 columns</p>
</div>



<p>该DataFrame有~20,000行。原来的数据约为130,000行。这意味着大约15%的葡萄酒来自意大利。</p>
<p>我们还想知道哪些葡萄酒比平均水平好。葡萄酒的评价标准为80-100分，因此这可能意味着至少获得90分的葡萄酒。</p>
<p>我们可以用”&amp;”将这两个问题联系起来：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.loc[(reviews.country == <span class="string">&#x27;Italy&#x27;</span>) &amp; (reviews.points &gt;= <span class="number">90</span>)]</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>description</th>
      <th>designation</th>
      <th>points</th>
      <th>price</th>
      <th>province</th>
      <th>region_1</th>
      <th>region_2</th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>title</th>
      <th>variety</th>
      <th>winery</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>120</th>
      <td>Italy</td>
      <td>Slightly backward, particularly given the vint...</td>
      <td>Bricco Rocche Prapó</td>
      <td>92</td>
      <td>70.0</td>
      <td>Piedmont</td>
      <td>Barolo</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Ceretto 2003 Bricco Rocche Prapó  (Barolo)</td>
      <td>Nebbiolo</td>
      <td>Ceretto</td>
    </tr>
    <tr>
      <th>130</th>
      <td>Italy</td>
      <td>At the first it was quite muted and subdued, b...</td>
      <td>Bricco Rocche Brunate</td>
      <td>91</td>
      <td>70.0</td>
      <td>Piedmont</td>
      <td>Barolo</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Ceretto 2003 Bricco Rocche Brunate  (Barolo)</td>
      <td>Nebbiolo</td>
      <td>Ceretto</td>
    </tr>
    <tr>
      <th>133</th>
      <td>Italy</td>
      <td>Einaudi's wines have been improving lately, an...</td>
      <td>NaN</td>
      <td>91</td>
      <td>68.0</td>
      <td>Piedmont</td>
      <td>Barolo</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Poderi Luigi Einaudi 2003  Barolo</td>
      <td>Nebbiolo</td>
      <td>Poderi Luigi Einaudi</td>
    </tr>
    <tr>
      <th>135</th>
      <td>Italy</td>
      <td>The color is just beginning to show signs of b...</td>
      <td>Sorano</td>
      <td>91</td>
      <td>60.0</td>
      <td>Piedmont</td>
      <td>Barolo</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Giacomo Ascheri 2001 Sorano  (Barolo)</td>
      <td>Nebbiolo</td>
      <td>Giacomo Ascheri</td>
    </tr>
    <tr>
      <th>140</th>
      <td>Italy</td>
      <td>A big, fat, luscious wine with plenty of toast...</td>
      <td>Costa Bruna</td>
      <td>90</td>
      <td>26.0</td>
      <td>Piedmont</td>
      <td>Barbera d'Alba</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Poderi Colla 2005 Costa Bruna  (Barbera d'Alba)</td>
      <td>Barbera</td>
      <td>Poderi Colla</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>129929</th>
      <td>Italy</td>
      <td>This luminous sparkler has a sweet, fruit-forw...</td>
      <td>NaN</td>
      <td>91</td>
      <td>38.0</td>
      <td>Veneto</td>
      <td>Prosecco Superiore di Cartizze</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Col Vetoraz Spumanti NV  Prosecco Superiore di...</td>
      <td>Prosecco</td>
      <td>Col Vetoraz Spumanti</td>
    </tr>
    <tr>
      <th>129943</th>
      <td>Italy</td>
      <td>A blend of Nero d'Avola and Syrah, this convey...</td>
      <td>Adènzia</td>
      <td>90</td>
      <td>29.0</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Sicilia</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Baglio del Cristo di Campobello 2012 Adènzia R...</td>
      <td>Red Blend</td>
      <td>Baglio del Cristo di Campobello</td>
    </tr>
    <tr>
      <th>129947</th>
      <td>Italy</td>
      <td>A blend of 65% Cabernet Sauvignon, 30% Merlot ...</td>
      <td>Symposio</td>
      <td>90</td>
      <td>20.0</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Terre Siciliane</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Feudo Principi di Butera 2012 Symposio Red (Te...</td>
      <td>Red Blend</td>
      <td>Feudo Principi di Butera</td>
    </tr>
    <tr>
      <th>129961</th>
      <td>Italy</td>
      <td>Intense aromas of wild cherry, baking spice, t...</td>
      <td>NaN</td>
      <td>90</td>
      <td>30.0</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Sicilia</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>COS 2013 Frappato (Sicilia)</td>
      <td>Frappato</td>
      <td>COS</td>
    </tr>
    <tr>
      <th>129962</th>
      <td>Italy</td>
      <td>Blackberry, cassis, grilled herb and toasted a...</td>
      <td>Sàgana Tenuta San Giacomo</td>
      <td>90</td>
      <td>40.0</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Sicilia</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Cusumano 2012 Sàgana Tenuta San Giacomo Nero d...</td>
      <td>Nero d'Avola</td>
      <td>Cusumano</td>
    </tr>
  </tbody>
</table>
<p>6648 rows × 13 columns</p>
</div>



<p>Pandas内置了一些条件选择器，我们在此重点介绍其中的两个。</p>
<p>第一个是 “isin”。”isin “让您选择其值 “位于 “一个值列表中的数据。例如，我们可以用它来选择仅来自意大利或法国的葡萄酒：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.loc[reviews.country.isin([<span class="string">&#x27;Italy&#x27;</span>, <span class="string">&#x27;France&#x27;</span>])]</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>description</th>
      <th>designation</th>
      <th>points</th>
      <th>price</th>
      <th>province</th>
      <th>region_1</th>
      <th>region_2</th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>title</th>
      <th>variety</th>
      <th>winery</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Italy</td>
      <td>Aromas include tropical fruit, broom, brimston...</td>
      <td>Vulkà Bianco</td>
      <td>87</td>
      <td>NaN</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Etna</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Nicosia 2013 Vulkà Bianco  (Etna)</td>
      <td>White Blend</td>
      <td>Nicosia</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Italy</td>
      <td>Here's a bright, informal red that opens with ...</td>
      <td>Belsito</td>
      <td>87</td>
      <td>16.0</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Vittoria</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Terre di Giurfo 2013 Belsito Frappato (Vittoria)</td>
      <td>Frappato</td>
      <td>Terre di Giurfo</td>
    </tr>
    <tr>
      <th>7</th>
      <td>France</td>
      <td>This dry and restrained wine offers spice in p...</td>
      <td>NaN</td>
      <td>87</td>
      <td>24.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Trimbach 2012 Gewurztraminer (Alsace)</td>
      <td>Gewürztraminer</td>
      <td>Trimbach</td>
    </tr>
    <tr>
      <th>9</th>
      <td>France</td>
      <td>This has great depth of flavor with its fresh ...</td>
      <td>Les Natures</td>
      <td>87</td>
      <td>27.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Jean-Baptiste Adam 2012 Les Natures Pinot Gris...</td>
      <td>Pinot Gris</td>
      <td>Jean-Baptiste Adam</td>
    </tr>
    <tr>
      <th>11</th>
      <td>France</td>
      <td>This is a dry wine, very spicy, with a tight, ...</td>
      <td>NaN</td>
      <td>87</td>
      <td>30.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Leon Beyer 2012 Gewurztraminer (Alsace)</td>
      <td>Gewürztraminer</td>
      <td>Leon Beyer</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>129964</th>
      <td>France</td>
      <td>Initially quite muted, this wine slowly develo...</td>
      <td>Domaine Saint-Rémy Herrenweg</td>
      <td>90</td>
      <td>NaN</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Ehrhart 2013 Domaine Saint-Rémy Herren...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Ehrhart</td>
    </tr>
    <tr>
      <th>129965</th>
      <td>France</td>
      <td>While it's rich, this beautiful dry wine also ...</td>
      <td>Seppi Landmann Vallée Noble</td>
      <td>90</td>
      <td>28.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Rieflé-Landmann 2013 Seppi Landmann Va...</td>
      <td>Pinot Gris</td>
      <td>Domaine Rieflé-Landmann</td>
    </tr>
    <tr>
      <th>129968</th>
      <td>France</td>
      <td>Well-drained gravel soil gives this wine its c...</td>
      <td>Kritt</td>
      <td>90</td>
      <td>30.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Gresser 2013 Kritt Gewurztraminer (Als...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Gresser</td>
    </tr>
    <tr>
      <th>129969</th>
      <td>France</td>
      <td>A dry style of Pinot Gris, this is crisp with ...</td>
      <td>NaN</td>
      <td>90</td>
      <td>32.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Marcel Deiss 2012 Pinot Gris (Alsace)</td>
      <td>Pinot Gris</td>
      <td>Domaine Marcel Deiss</td>
    </tr>
    <tr>
      <th>129970</th>
      <td>France</td>
      <td>Big, rich and off-dry, this is powered by inte...</td>
      <td>Lieu-dit Harth Cuvée Caroline</td>
      <td>90</td>
      <td>21.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Schoffit 2012 Lieu-dit Harth Cuvée Car...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Schoffit</td>
    </tr>
  </tbody>
</table>
<p>41633 rows × 13 columns</p>
</div>



<p>第二个是 isnull （及其同伴 notnull）。这些方法可让您突出显示空（或非空）(NaN) 的值。例如，要过滤掉数据集中缺少价格标签的葡萄酒，我们将执行以下操作：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.loc[reviews.price.notnull()]</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>description</th>
      <th>designation</th>
      <th>points</th>
      <th>price</th>
      <th>province</th>
      <th>region_1</th>
      <th>region_2</th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>title</th>
      <th>variety</th>
      <th>winery</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Portugal</td>
      <td>This is ripe and fruity, a wine that is smooth...</td>
      <td>Avidagos</td>
      <td>87</td>
      <td>15.0</td>
      <td>Douro</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Quinta dos Avidagos 2011 Avidagos Red (Douro)</td>
      <td>Portuguese Red</td>
      <td>Quinta dos Avidagos</td>
    </tr>
    <tr>
      <th>2</th>
      <td>US</td>
      <td>Tart and snappy, the flavors of lime flesh and...</td>
      <td>NaN</td>
      <td>87</td>
      <td>14.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Rainstorm 2013 Pinot Gris (Willamette Valley)</td>
      <td>Pinot Gris</td>
      <td>Rainstorm</td>
    </tr>
    <tr>
      <th>3</th>
      <td>US</td>
      <td>Pineapple rind, lemon pith and orange blossom ...</td>
      <td>Reserve Late Harvest</td>
      <td>87</td>
      <td>13.0</td>
      <td>Michigan</td>
      <td>Lake Michigan Shore</td>
      <td>NaN</td>
      <td>Alexander Peartree</td>
      <td>NaN</td>
      <td>St. Julian 2013 Reserve Late Harvest Riesling ...</td>
      <td>Riesling</td>
      <td>St. Julian</td>
    </tr>
    <tr>
      <th>4</th>
      <td>US</td>
      <td>Much like the regular bottling from 2012, this...</td>
      <td>Vintner's Reserve Wild Child Block</td>
      <td>87</td>
      <td>65.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Sweet Cheeks 2012 Vintner's Reserve Wild Child...</td>
      <td>Pinot Noir</td>
      <td>Sweet Cheeks</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Spain</td>
      <td>Blackberry and raspberry aromas show a typical...</td>
      <td>Ars In Vitro</td>
      <td>87</td>
      <td>15.0</td>
      <td>Northern Spain</td>
      <td>Navarra</td>
      <td>NaN</td>
      <td>Michael Schachner</td>
      <td>@wineschach</td>
      <td>Tandem 2011 Ars In Vitro Tempranillo-Merlot (N...</td>
      <td>Tempranillo-Merlot</td>
      <td>Tandem</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>129966</th>
      <td>Germany</td>
      <td>Notes of honeysuckle and cantaloupe sweeten th...</td>
      <td>Brauneberger Juffer-Sonnenuhr Spätlese</td>
      <td>90</td>
      <td>28.0</td>
      <td>Mosel</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Anna Lee C. Iijima</td>
      <td>NaN</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef) 2013 ...</td>
      <td>Riesling</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef)</td>
    </tr>
    <tr>
      <th>129967</th>
      <td>US</td>
      <td>Citation is given as much as a decade of bottl...</td>
      <td>NaN</td>
      <td>90</td>
      <td>75.0</td>
      <td>Oregon</td>
      <td>Oregon</td>
      <td>Oregon Other</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Citation 2004 Pinot Noir (Oregon)</td>
      <td>Pinot Noir</td>
      <td>Citation</td>
    </tr>
    <tr>
      <th>129968</th>
      <td>France</td>
      <td>Well-drained gravel soil gives this wine its c...</td>
      <td>Kritt</td>
      <td>90</td>
      <td>30.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Gresser 2013 Kritt Gewurztraminer (Als...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Gresser</td>
    </tr>
    <tr>
      <th>129969</th>
      <td>France</td>
      <td>A dry style of Pinot Gris, this is crisp with ...</td>
      <td>NaN</td>
      <td>90</td>
      <td>32.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Marcel Deiss 2012 Pinot Gris (Alsace)</td>
      <td>Pinot Gris</td>
      <td>Domaine Marcel Deiss</td>
    </tr>
    <tr>
      <th>129970</th>
      <td>France</td>
      <td>Big, rich and off-dry, this is powered by inte...</td>
      <td>Lieu-dit Harth Cuvée Caroline</td>
      <td>90</td>
      <td>21.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Schoffit 2012 Lieu-dit Harth Cuvée Car...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Schoffit</td>
    </tr>
  </tbody>
</table>
<p>120975 rows × 13 columns</p>
</div>



<h2 id="分配数据"><a href="#分配数据" class="headerlink" title="分配数据"></a>分配数据</h2><p>另一方面，将数据分配给 DataFrame 很容易。可以分配一个常量值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">reviews[<span class="string">&#x27;critic&#x27;</span>] = <span class="string">&#x27;everyone&#x27;</span></span><br><span class="line">reviews[<span class="string">&#x27;critic&#x27;</span>]</span><br></pre></td></tr></table></figure>




<pre><code>0         everyone
1         everyone
2         everyone
3         everyone
4         everyone
            ...   
129966    everyone
129967    everyone
129968    everyone
129969    everyone
129970    everyone
Name: critic, Length: 129971, dtype: object
</code></pre>
<p>或者使用可迭代的值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">reviews[<span class="string">&#x27;index_backwards&#x27;</span>] = <span class="built_in">range</span>(<span class="built_in">len</span>(reviews), <span class="number">0</span>, -<span class="number">1</span>)</span><br><span class="line">reviews[<span class="string">&#x27;index_backwards&#x27;</span>]</span><br></pre></td></tr></table></figure>




<pre><code>0         129971
1         129970
2         129969
3         129968
4         129967
           ...  
129966         5
129967         4
129968         3
129969         2
129970         1
Name: index_backwards, Length: 129971, dtype: int64
</code></pre>
<h1 id="TEST"><a href="#TEST" class="headerlink" title="TEST"></a>TEST</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews = pd.read_csv(<span class="string">&quot;datasets/wine/winemag-data-130k-v2.csv&quot;</span>, index_col=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>description</th>
      <th>designation</th>
      <th>points</th>
      <th>price</th>
      <th>province</th>
      <th>region_1</th>
      <th>region_2</th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>title</th>
      <th>variety</th>
      <th>winery</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Italy</td>
      <td>Aromas include tropical fruit, broom, brimston...</td>
      <td>Vulkà Bianco</td>
      <td>87</td>
      <td>NaN</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Etna</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Nicosia 2013 Vulkà Bianco  (Etna)</td>
      <td>White Blend</td>
      <td>Nicosia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Portugal</td>
      <td>This is ripe and fruity, a wine that is smooth...</td>
      <td>Avidagos</td>
      <td>87</td>
      <td>15.0</td>
      <td>Douro</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Quinta dos Avidagos 2011 Avidagos Red (Douro)</td>
      <td>Portuguese Red</td>
      <td>Quinta dos Avidagos</td>
    </tr>
    <tr>
      <th>2</th>
      <td>US</td>
      <td>Tart and snappy, the flavors of lime flesh and...</td>
      <td>NaN</td>
      <td>87</td>
      <td>14.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Rainstorm 2013 Pinot Gris (Willamette Valley)</td>
      <td>Pinot Gris</td>
      <td>Rainstorm</td>
    </tr>
    <tr>
      <th>3</th>
      <td>US</td>
      <td>Pineapple rind, lemon pith and orange blossom ...</td>
      <td>Reserve Late Harvest</td>
      <td>87</td>
      <td>13.0</td>
      <td>Michigan</td>
      <td>Lake Michigan Shore</td>
      <td>NaN</td>
      <td>Alexander Peartree</td>
      <td>NaN</td>
      <td>St. Julian 2013 Reserve Late Harvest Riesling ...</td>
      <td>Riesling</td>
      <td>St. Julian</td>
    </tr>
    <tr>
      <th>4</th>
      <td>US</td>
      <td>Much like the regular bottling from 2012, this...</td>
      <td>Vintner's Reserve Wild Child Block</td>
      <td>87</td>
      <td>65.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Sweet Cheeks 2012 Vintner's Reserve Wild Child...</td>
      <td>Pinot Noir</td>
      <td>Sweet Cheeks</td>
    </tr>
  </tbody>
</table>
</div>



<p>1.从description中选择描述列，并将结果分配给变量 desc。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">desc = reviews[<span class="string">&#x27;description&#x27;</span>]</span><br><span class="line">desc</span><br></pre></td></tr></table></figure>




<pre><code>0         Aromas include tropical fruit, broom, brimston...
1         This is ripe and fruity, a wine that is smooth...
2         Tart and snappy, the flavors of lime flesh and...
3         Pineapple rind, lemon pith and orange blossom ...
4         Much like the regular bottling from 2012, this...
                                ...                        
129966    Notes of honeysuckle and cantaloupe sweeten th...
129967    Citation is given as much as a decade of bottl...
129968    Well-drained gravel soil gives this wine its c...
129969    A dry style of Pinot Gris, this is crisp with ...
129970    Big, rich and off-dry, this is powered by inte...
Name: description, Length: 129971, dtype: object
</code></pre>
<p>2.从评论的描述列中选择第一个值，将其分配给变量first_description。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">first_description = desc[<span class="number">0</span>]</span><br><span class="line">first_description</span><br></pre></td></tr></table></figure>




<pre><code>&quot;Aromas include tropical fruit, broom, brimstone and dried herb. The palate isn&#39;t overly expressive, offering unripened apple, citrus and dried sage alongside brisk acidity.&quot;
</code></pre>
<p>3.从reviews中选择第一行数据（第一条记录），并将其分配给变量first_row。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">first_row = reviews.loc[<span class="number">0</span>]</span><br><span class="line">first_row</span><br></pre></td></tr></table></figure>




<pre><code>country                                                              Italy
description              Aromas include tropical fruit, broom, brimston...
designation                                                   Vulkà Bianco
points                                                                  87
price                                                                  NaN
province                                                 Sicily &amp; Sardinia
region_1                                                              Etna
region_2                                                               NaN
taster_name                                                  Kerin O’Keefe
taster_twitter_handle                                         @kerinokeefe
title                                    Nicosia 2013 Vulkà Bianco  (Etna)
variety                                                        White Blend
winery                                                             Nicosia
Name: 0, dtype: object
</code></pre>
<p>4.从评论中的描述列中选择前 10 个值，将结果分配给变量first_descriptions。 </p>
<p>提示：将输出格式化为 pandas 系列。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">first_descriptions = reviews[<span class="string">&#x27;description&#x27;</span>].loc[<span class="number">0</span>:<span class="number">9</span>]</span><br><span class="line">first_descriptions</span><br></pre></td></tr></table></figure>




<pre><code>0    Aromas include tropical fruit, broom, brimston...
1    This is ripe and fruity, a wine that is smooth...
2    Tart and snappy, the flavors of lime flesh and...
3    Pineapple rind, lemon pith and orange blossom ...
4    Much like the regular bottling from 2012, this...
5    Blackberry and raspberry aromas show a typical...
6    Here&#39;s a bright, informal red that opens with ...
7    This dry and restrained wine offers spice in p...
8    Savory dried thyme notes accent sunnier flavor...
9    This has great depth of flavor with its fresh ...
Name: description, dtype: object
</code></pre>
<p>5.Select the records with index labels <code>1</code>, <code>2</code>, <code>3</code>, <code>5</code>, and <code>8</code>, assigning the result to the variable <code>sample_reviews</code>.</p>
<p>In other words, generate the following DataFrame:</p>
<p><img src="https://storage.googleapis.com/kaggle-media/learn/images/sHZvI1O.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sample_reviews = reviews.loc[[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">8</span>]]</span><br><span class="line">sample_reviews</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>description</th>
      <th>designation</th>
      <th>points</th>
      <th>price</th>
      <th>province</th>
      <th>region_1</th>
      <th>region_2</th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>title</th>
      <th>variety</th>
      <th>winery</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Portugal</td>
      <td>This is ripe and fruity, a wine that is smooth...</td>
      <td>Avidagos</td>
      <td>87</td>
      <td>15.0</td>
      <td>Douro</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Quinta dos Avidagos 2011 Avidagos Red (Douro)</td>
      <td>Portuguese Red</td>
      <td>Quinta dos Avidagos</td>
    </tr>
    <tr>
      <th>2</th>
      <td>US</td>
      <td>Tart and snappy, the flavors of lime flesh and...</td>
      <td>NaN</td>
      <td>87</td>
      <td>14.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Rainstorm 2013 Pinot Gris (Willamette Valley)</td>
      <td>Pinot Gris</td>
      <td>Rainstorm</td>
    </tr>
    <tr>
      <th>3</th>
      <td>US</td>
      <td>Pineapple rind, lemon pith and orange blossom ...</td>
      <td>Reserve Late Harvest</td>
      <td>87</td>
      <td>13.0</td>
      <td>Michigan</td>
      <td>Lake Michigan Shore</td>
      <td>NaN</td>
      <td>Alexander Peartree</td>
      <td>NaN</td>
      <td>St. Julian 2013 Reserve Late Harvest Riesling ...</td>
      <td>Riesling</td>
      <td>St. Julian</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Spain</td>
      <td>Blackberry and raspberry aromas show a typical...</td>
      <td>Ars In Vitro</td>
      <td>87</td>
      <td>15.0</td>
      <td>Northern Spain</td>
      <td>Navarra</td>
      <td>NaN</td>
      <td>Michael Schachner</td>
      <td>@wineschach</td>
      <td>Tandem 2011 Ars In Vitro Tempranillo-Merlot (N...</td>
      <td>Tempranillo-Merlot</td>
      <td>Tandem</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Germany</td>
      <td>Savory dried thyme notes accent sunnier flavor...</td>
      <td>Shine</td>
      <td>87</td>
      <td>12.0</td>
      <td>Rheinhessen</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Anna Lee C. Iijima</td>
      <td>NaN</td>
      <td>Heinz Eifel 2013 Shine Gewürztraminer (Rheinhe...</td>
      <td>Gewürztraminer</td>
      <td>Heinz Eifel</td>
    </tr>
  </tbody>
</table>
</div>



<p>创建一个变量 df，其中包含索引标签为 0、1、10 和 100 的记录的 Country、Province、Region_1 和 Region_2 列。换句话说，生成以下 DataFrame：</p>
<p><img src="https://storage.googleapis.com/kaggle-media/learn/images/FUCGiKP.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = reviews[[<span class="string">&#x27;country&#x27;</span>,<span class="string">&#x27;province&#x27;</span>,<span class="string">&#x27;region_1&#x27;</span>,<span class="string">&#x27;region_2&#x27;</span>]].loc[[<span class="number">0</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">100</span>]]</span><br><span class="line">df</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>province</th>
      <th>region_1</th>
      <th>region_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Italy</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Etna</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Portugal</td>
      <td>Douro</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>10</th>
      <td>US</td>
      <td>California</td>
      <td>Napa Valley</td>
      <td>Napa</td>
    </tr>
    <tr>
      <th>100</th>
      <td>US</td>
      <td>New York</td>
      <td>Finger Lakes</td>
      <td>Finger Lakes</td>
    </tr>
  </tbody>
</table>
</div>



<p>7.Create a variable <code>df</code> containing the <code>country</code> and <code>variety</code> columns of the first 100 records. </p>
<p>Hint: you may use <code>loc</code> or <code>iloc</code>. When working on the answer this question and the several of the ones that follow, keep the following “gotcha” described in the tutorial:</p>
<blockquote>
<p><code>iloc</code> uses the Python stdlib indexing scheme, where the first element of the range is included and the last one excluded.<br><code>loc</code>, meanwhile, indexes inclusively. </p>
</blockquote>
<blockquote>
<p>This is particularly confusing when the DataFrame index is a simple numerical list, e.g. <code>0,...,1000</code>. In this case <code>df.iloc[0:1000]</code> will return 1000 entries, while <code>df.loc[0:1000]</code> return 1001 of them! To get 1000 elements using <code>loc</code>, you will need to go one lower and ask for <code>df.iloc[0:999]</code>. </p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = reviews[[<span class="string">&#x27;country&#x27;</span>,<span class="string">&#x27;variety&#x27;</span>]].loc[<span class="number">0</span>:<span class="number">99</span>]</span><br><span class="line">df</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>variety</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Italy</td>
      <td>White Blend</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Portugal</td>
      <td>Portuguese Red</td>
    </tr>
    <tr>
      <th>2</th>
      <td>US</td>
      <td>Pinot Gris</td>
    </tr>
    <tr>
      <th>3</th>
      <td>US</td>
      <td>Riesling</td>
    </tr>
    <tr>
      <th>4</th>
      <td>US</td>
      <td>Pinot Noir</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>France</td>
      <td>Gamay</td>
    </tr>
    <tr>
      <th>96</th>
      <td>France</td>
      <td>Gamay</td>
    </tr>
    <tr>
      <th>97</th>
      <td>US</td>
      <td>Riesling</td>
    </tr>
    <tr>
      <th>98</th>
      <td>Italy</td>
      <td>Sangiovese</td>
    </tr>
    <tr>
      <th>99</th>
      <td>US</td>
      <td>Bordeaux-style Red Blend</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 2 columns</p>
</div>



<p>8.创建一个包含意大利葡萄酒评论的 DataFrame italian_wines。提示：reviews.country 等于什么？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">italian_wines = reviews[reviews[<span class="string">&#x27;country&#x27;</span>]==<span class="string">&#x27;Italy&#x27;</span>]</span><br><span class="line">italian_wines</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>description</th>
      <th>designation</th>
      <th>points</th>
      <th>price</th>
      <th>province</th>
      <th>region_1</th>
      <th>region_2</th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>title</th>
      <th>variety</th>
      <th>winery</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Italy</td>
      <td>Aromas include tropical fruit, broom, brimston...</td>
      <td>Vulkà Bianco</td>
      <td>87</td>
      <td>NaN</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Etna</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Nicosia 2013 Vulkà Bianco  (Etna)</td>
      <td>White Blend</td>
      <td>Nicosia</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Italy</td>
      <td>Here's a bright, informal red that opens with ...</td>
      <td>Belsito</td>
      <td>87</td>
      <td>16.0</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Vittoria</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Terre di Giurfo 2013 Belsito Frappato (Vittoria)</td>
      <td>Frappato</td>
      <td>Terre di Giurfo</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Italy</td>
      <td>This is dominated by oak and oak-driven aromas...</td>
      <td>Rosso</td>
      <td>87</td>
      <td>NaN</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Etna</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Masseria Setteporte 2012 Rosso  (Etna)</td>
      <td>Nerello Mascalese</td>
      <td>Masseria Setteporte</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Italy</td>
      <td>Delicate aromas recall white flower and citrus...</td>
      <td>Ficiligno</td>
      <td>87</td>
      <td>19.0</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Sicilia</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Baglio di Pianetto 2007 Ficiligno White (Sicilia)</td>
      <td>White Blend</td>
      <td>Baglio di Pianetto</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Italy</td>
      <td>Aromas of prune, blackcurrant, toast and oak c...</td>
      <td>Aynat</td>
      <td>87</td>
      <td>35.0</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Sicilia</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Canicattì 2009 Aynat Nero d'Avola (Sicilia)</td>
      <td>Nero d'Avola</td>
      <td>Canicattì</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>129929</th>
      <td>Italy</td>
      <td>This luminous sparkler has a sweet, fruit-forw...</td>
      <td>NaN</td>
      <td>91</td>
      <td>38.0</td>
      <td>Veneto</td>
      <td>Prosecco Superiore di Cartizze</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Col Vetoraz Spumanti NV  Prosecco Superiore di...</td>
      <td>Prosecco</td>
      <td>Col Vetoraz Spumanti</td>
    </tr>
    <tr>
      <th>129943</th>
      <td>Italy</td>
      <td>A blend of Nero d'Avola and Syrah, this convey...</td>
      <td>Adènzia</td>
      <td>90</td>
      <td>29.0</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Sicilia</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Baglio del Cristo di Campobello 2012 Adènzia R...</td>
      <td>Red Blend</td>
      <td>Baglio del Cristo di Campobello</td>
    </tr>
    <tr>
      <th>129947</th>
      <td>Italy</td>
      <td>A blend of 65% Cabernet Sauvignon, 30% Merlot ...</td>
      <td>Symposio</td>
      <td>90</td>
      <td>20.0</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Terre Siciliane</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Feudo Principi di Butera 2012 Symposio Red (Te...</td>
      <td>Red Blend</td>
      <td>Feudo Principi di Butera</td>
    </tr>
    <tr>
      <th>129961</th>
      <td>Italy</td>
      <td>Intense aromas of wild cherry, baking spice, t...</td>
      <td>NaN</td>
      <td>90</td>
      <td>30.0</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Sicilia</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>COS 2013 Frappato (Sicilia)</td>
      <td>Frappato</td>
      <td>COS</td>
    </tr>
    <tr>
      <th>129962</th>
      <td>Italy</td>
      <td>Blackberry, cassis, grilled herb and toasted a...</td>
      <td>Sàgana Tenuta San Giacomo</td>
      <td>90</td>
      <td>40.0</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Sicilia</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Cusumano 2012 Sàgana Tenuta San Giacomo Nero d...</td>
      <td>Nero d'Avola</td>
      <td>Cusumano</td>
    </tr>
  </tbody>
</table>
<p>19540 rows × 13 columns</p>
</div>



<p>9.创建一个 DataFrame top_oceania_wines，其中包含来自澳大利亚或新西兰的葡萄酒的至少 95 分（满分 100 分）的所有评论。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">top_oceania_wines = reviews[reviews.country.isin([<span class="string">&#x27;Australia&#x27;</span>, <span class="string">&#x27;New Zealand&#x27;</span>]) &amp; (reviews.points&gt;=<span class="number">95</span>)]</span><br><span class="line">top_oceania_wines</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>description</th>
      <th>designation</th>
      <th>points</th>
      <th>price</th>
      <th>province</th>
      <th>region_1</th>
      <th>region_2</th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>title</th>
      <th>variety</th>
      <th>winery</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>345</th>
      <td>Australia</td>
      <td>This wine contains some material over 100 year...</td>
      <td>Rare</td>
      <td>100</td>
      <td>350.0</td>
      <td>Victoria</td>
      <td>Rutherglen</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Chambers Rosewood Vineyards NV Rare Muscat (Ru...</td>
      <td>Muscat</td>
      <td>Chambers Rosewood Vineyards</td>
    </tr>
    <tr>
      <th>346</th>
      <td>Australia</td>
      <td>This deep brown wine smells like a damp, mossy...</td>
      <td>Rare</td>
      <td>98</td>
      <td>350.0</td>
      <td>Victoria</td>
      <td>Rutherglen</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Chambers Rosewood Vineyards NV Rare Muscadelle...</td>
      <td>Muscadelle</td>
      <td>Chambers Rosewood Vineyards</td>
    </tr>
    <tr>
      <th>348</th>
      <td>Australia</td>
      <td>Deep mahogany. Dried fig and black tea on the ...</td>
      <td>Grand</td>
      <td>97</td>
      <td>100.0</td>
      <td>Victoria</td>
      <td>Rutherglen</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Chambers Rosewood Vineyards NV Grand Muscat (R...</td>
      <td>Muscat</td>
      <td>Chambers Rosewood Vineyards</td>
    </tr>
    <tr>
      <th>349</th>
      <td>Australia</td>
      <td>RunRig is always complex, and the 2012 doesn't...</td>
      <td>RunRig</td>
      <td>97</td>
      <td>225.0</td>
      <td>South Australia</td>
      <td>Barossa</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Torbreck 2012 RunRig Shiraz-Viognier (Barossa)</td>
      <td>Shiraz-Viognier</td>
      <td>Torbreck</td>
    </tr>
    <tr>
      <th>356</th>
      <td>Australia</td>
      <td>Dusty, firm, powerful: just a few apt descript...</td>
      <td>Georgia's Paddock</td>
      <td>95</td>
      <td>85.0</td>
      <td>Victoria</td>
      <td>Heathcote</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Jasper Hill 2013 Georgia's Paddock Shiraz (Hea...</td>
      <td>Shiraz</td>
      <td>Jasper Hill</td>
    </tr>
    <tr>
      <th>360</th>
      <td>Australia</td>
      <td>Bacon and tapenade elements merge easily on th...</td>
      <td>Descendant</td>
      <td>95</td>
      <td>125.0</td>
      <td>South Australia</td>
      <td>Barossa Valley</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Torbreck 2012 Descendant Shiraz-Viognier (Baro...</td>
      <td>Shiraz-Viognier</td>
      <td>Torbreck</td>
    </tr>
    <tr>
      <th>365</th>
      <td>Australia</td>
      <td>The Taylor family selected Clare Valley for it...</td>
      <td>St. Andrews Single Vineyard Release</td>
      <td>95</td>
      <td>60.0</td>
      <td>South Australia</td>
      <td>Clare Valley</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Wakefield 2013 St. Andrews Single Vineyard Rel...</td>
      <td>Shiraz</td>
      <td>Wakefield</td>
    </tr>
    <tr>
      <th>14354</th>
      <td>Australia</td>
      <td>This wine's concentrated dark fruit shows in t...</td>
      <td>Old Vine</td>
      <td>95</td>
      <td>60.0</td>
      <td>South Australia</td>
      <td>Barossa Valley</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Kaesler 2006 Old Vine Shiraz (Barossa Valley)</td>
      <td>Shiraz</td>
      <td>Kaesler</td>
    </tr>
    <tr>
      <th>16538</th>
      <td>Australia</td>
      <td>Rich, dense and intense, this is a big, muscul...</td>
      <td>The Family Tree</td>
      <td>95</td>
      <td>65.0</td>
      <td>South Australia</td>
      <td>Barossa Valley</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Lambert 2013 The Family Tree Shiraz (Barossa V...</td>
      <td>Shiraz</td>
      <td>Lambert</td>
    </tr>
    <tr>
      <th>28573</th>
      <td>Australia</td>
      <td>Astralis has become one of Australia's top col...</td>
      <td>Astralis</td>
      <td>95</td>
      <td>350.0</td>
      <td>South Australia</td>
      <td>Clarendon</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Clarendon Hills 2005 Astralis Syrah (Clarendon)</td>
      <td>Syrah</td>
      <td>Clarendon Hills</td>
    </tr>
    <tr>
      <th>34502</th>
      <td>Australia</td>
      <td>This prodigious wine showcases Barossa's abili...</td>
      <td>The Relic</td>
      <td>98</td>
      <td>135.0</td>
      <td>South Australia</td>
      <td>Barossa Valley</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Standish 2006 The Relic Shiraz (Barossa Valley)</td>
      <td>Shiraz</td>
      <td>Standish</td>
    </tr>
    <tr>
      <th>34506</th>
      <td>Australia</td>
      <td>If Standish's Relic is the feminine side of Sh...</td>
      <td>The Standish Single Vineyard</td>
      <td>96</td>
      <td>135.0</td>
      <td>South Australia</td>
      <td>Barossa Valley</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Standish 2005 The Standish Single Vineyard Shi...</td>
      <td>Shiraz</td>
      <td>Standish</td>
    </tr>
    <tr>
      <th>38988</th>
      <td>Australia</td>
      <td>Penfolds Bin 707 has leapt in quality over the...</td>
      <td>Bin 707</td>
      <td>95</td>
      <td>200.0</td>
      <td>South Australia</td>
      <td>South Australia</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Penfolds 2009 Bin 707 Cabernet Sauvignon (Sout...</td>
      <td>Cabernet Sauvignon</td>
      <td>Penfolds</td>
    </tr>
    <tr>
      <th>39059</th>
      <td>Australia</td>
      <td>The Taylor family selected Clare Valley for it...</td>
      <td>St. Andrews Single Vineyard Release</td>
      <td>95</td>
      <td>60.0</td>
      <td>South Australia</td>
      <td>Clare Valley</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Wakefield 2013 St. Andrews Single Vineyard Rel...</td>
      <td>Shiraz</td>
      <td>Wakefield</td>
    </tr>
    <tr>
      <th>39961</th>
      <td>Australia</td>
      <td>As unevolved as they are, the dense and multil...</td>
      <td>Grange</td>
      <td>96</td>
      <td>185.0</td>
      <td>South Australia</td>
      <td>South Australia</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Penfolds 1996 Grange Shiraz (South Australia)</td>
      <td>Shiraz</td>
      <td>Penfolds</td>
    </tr>
    <tr>
      <th>39962</th>
      <td>Australia</td>
      <td>Seamless luxury from stem to stern, this ‘baby...</td>
      <td>RWT</td>
      <td>95</td>
      <td>70.0</td>
      <td>South Australia</td>
      <td>Barossa Valley</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Penfolds 1998 RWT Shiraz (Barossa Valley)</td>
      <td>Shiraz</td>
      <td>Penfolds</td>
    </tr>
    <tr>
      <th>45809</th>
      <td>Australia</td>
      <td>The 2007 Astralis impresses for its combinatio...</td>
      <td>Astralis</td>
      <td>95</td>
      <td>225.0</td>
      <td>South Australia</td>
      <td>Clarendon</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Clarendon Hills 2007 Astralis Syrah (Clarendon)</td>
      <td>Syrah</td>
      <td>Clarendon Hills</td>
    </tr>
    <tr>
      <th>56953</th>
      <td>Australia</td>
      <td>This inky, embryonic wine deserves to be cella...</td>
      <td>Grange</td>
      <td>99</td>
      <td>850.0</td>
      <td>South Australia</td>
      <td>South Australia</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Penfolds 2010 Grange Shiraz (South Australia)</td>
      <td>Shiraz</td>
      <td>Penfolds</td>
    </tr>
    <tr>
      <th>56956</th>
      <td>Australia</td>
      <td>You may have to scour the country to secure so...</td>
      <td>Andelmonde</td>
      <td>97</td>
      <td>95.0</td>
      <td>South Australia</td>
      <td>Barossa Valley</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Standish 2012 Andelmonde Shiraz (Barossa Valley)</td>
      <td>Shiraz</td>
      <td>Standish</td>
    </tr>
    <tr>
      <th>56957</th>
      <td>Australia</td>
      <td>Thorn Clarke has taken its Shiraz to a new lev...</td>
      <td>Ron Thorn Single Vineyard</td>
      <td>96</td>
      <td>89.0</td>
      <td>South Australia</td>
      <td>Barossa</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Thorn Clarke 2012 Ron Thorn Single Vineyard Sh...</td>
      <td>Shiraz</td>
      <td>Thorn Clarke</td>
    </tr>
    <tr>
      <th>56959</th>
      <td>Australia</td>
      <td>Is this the Yin to Grange's Yang? The wines ar...</td>
      <td>Hill of Grace</td>
      <td>96</td>
      <td>820.0</td>
      <td>South Australia</td>
      <td>Eden Valley</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Henschke 2010 Hill of Grace Shiraz (Eden Valley)</td>
      <td>Shiraz</td>
      <td>Henschke</td>
    </tr>
    <tr>
      <th>59977</th>
      <td>Australia</td>
      <td>This is a top example of the classic Australia...</td>
      <td>The Peake</td>
      <td>96</td>
      <td>150.0</td>
      <td>South Australia</td>
      <td>McLaren Vale</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Hickinbotham 2013 The Peake Cabernet-Shiraz (M...</td>
      <td>Cabernet-Shiraz</td>
      <td>Hickinbotham</td>
    </tr>
    <tr>
      <th>59984</th>
      <td>Australia</td>
      <td>This is a throwback to those brash, flavor-exu...</td>
      <td>One</td>
      <td>95</td>
      <td>95.0</td>
      <td>South Australia</td>
      <td>Langhorne Creek</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Heartland 2013 One Red (Langhorne Creek)</td>
      <td>Red Blend</td>
      <td>Heartland</td>
    </tr>
    <tr>
      <th>67096</th>
      <td>Australia</td>
      <td>Just a tiny serving of this dark nectar will l...</td>
      <td>Calliope Rare</td>
      <td>98</td>
      <td>86.0</td>
      <td>Victoria</td>
      <td>Rutherglen</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>R.L. Buller &amp; Son NV Calliope Rare Tokay (Ruth...</td>
      <td>Tokay</td>
      <td>R.L. Buller &amp; Son</td>
    </tr>
    <tr>
      <th>67101</th>
      <td>Australia</td>
      <td>This Muscat is the color of dark coffee, with ...</td>
      <td>Rare</td>
      <td>95</td>
      <td>300.0</td>
      <td>Victoria</td>
      <td>Rutherglen</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Chambers Rosewood Vineyards NV Rare Muscat (Ru...</td>
      <td>Muscat</td>
      <td>Chambers Rosewood Vineyards</td>
    </tr>
    <tr>
      <th>76392</th>
      <td>Australia</td>
      <td>When the alcohol levels are reined in to appro...</td>
      <td>Georgia's Paddock</td>
      <td>95</td>
      <td>85.0</td>
      <td>Victoria</td>
      <td>Heathcote</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Jasper Hill 2012 Georgia's Paddock Shiraz (Hea...</td>
      <td>Shiraz</td>
      <td>Jasper Hill</td>
    </tr>
    <tr>
      <th>77028</th>
      <td>Australia</td>
      <td>This has all the size and weight you've come t...</td>
      <td>Grange</td>
      <td>98</td>
      <td>850.0</td>
      <td>South Australia</td>
      <td>South Australia</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Penfolds 2008 Grange Shiraz (South Australia)</td>
      <td>Shiraz</td>
      <td>Penfolds</td>
    </tr>
    <tr>
      <th>77036</th>
      <td>Australia</td>
      <td>RWT (unromantically derived from “Red Wine Tri...</td>
      <td>RWT</td>
      <td>96</td>
      <td>150.0</td>
      <td>South Australia</td>
      <td>Barossa Valley</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Penfolds 2009 RWT Shiraz (Barossa Valley)</td>
      <td>Shiraz</td>
      <td>Penfolds</td>
    </tr>
    <tr>
      <th>77037</th>
      <td>Australia</td>
      <td>Winemaker Dave Powell is no longer with Torbre...</td>
      <td>RunRig</td>
      <td>96</td>
      <td>225.0</td>
      <td>South Australia</td>
      <td>Barossa Valley</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Torbreck 2007 RunRig Shiraz-Viognier (Barossa ...</td>
      <td>Shiraz-Viognier</td>
      <td>Torbreck</td>
    </tr>
    <tr>
      <th>77042</th>
      <td>Australia</td>
      <td>This is likely the most ageworthy Shiraz winem...</td>
      <td>Eligo</td>
      <td>95</td>
      <td>100.0</td>
      <td>South Australia</td>
      <td>Barossa</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>John Duval Wines 2010 Eligo Shiraz (Barossa)</td>
      <td>Shiraz</td>
      <td>John Duval Wines</td>
    </tr>
    <tr>
      <th>77044</th>
      <td>Australia</td>
      <td>The fruit for this offering comes from the Gre...</td>
      <td>R Reserve</td>
      <td>95</td>
      <td>105.0</td>
      <td>South Australia</td>
      <td>Barossa Valley</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Kilikanoon 2009 R Reserve Shiraz (Barossa Valley)</td>
      <td>Shiraz</td>
      <td>Kilikanoon</td>
    </tr>
    <tr>
      <th>77046</th>
      <td>Australia</td>
      <td>With aromas and flavors that range widely from...</td>
      <td>The Factor</td>
      <td>95</td>
      <td>125.0</td>
      <td>South Australia</td>
      <td>Barossa Valley</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Torbreck 2007 The Factor Shiraz (Barossa Valley)</td>
      <td>Shiraz</td>
      <td>Torbreck</td>
    </tr>
    <tr>
      <th>83357</th>
      <td>Australia</td>
      <td>A throwback to the monster Shiraz style of old...</td>
      <td>Grange</td>
      <td>96</td>
      <td>500.0</td>
      <td>South Australia</td>
      <td>South Australia</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Penfolds 2004 Grange Shiraz (South Australia)</td>
      <td>Shiraz</td>
      <td>Penfolds</td>
    </tr>
    <tr>
      <th>84815</th>
      <td>Australia</td>
      <td>The Factor is always one of Torbreck's biggest...</td>
      <td>The Factor</td>
      <td>95</td>
      <td>125.0</td>
      <td>South Australia</td>
      <td>Barossa</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Torbreck 2012 The Factor Shiraz (Barossa)</td>
      <td>Shiraz</td>
      <td>Torbreck</td>
    </tr>
    <tr>
      <th>84816</th>
      <td>Australia</td>
      <td>Nashwauk is Kaesler's McLaren Vale project, fi...</td>
      <td>Beacon</td>
      <td>95</td>
      <td>145.0</td>
      <td>South Australia</td>
      <td>McLaren Vale</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Nashwauk 2010 Beacon Shiraz (McLaren Vale)</td>
      <td>Shiraz</td>
      <td>Nashwauk</td>
    </tr>
    <tr>
      <th>87128</th>
      <td>Australia</td>
      <td>This full-bodied, muscular Shiraz is built for...</td>
      <td>Amery Vineyard Block 6</td>
      <td>96</td>
      <td>120.0</td>
      <td>South Australia</td>
      <td>McLaren Vale</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Kay Brothers 2012 Amery Vineyard Block 6 Shira...</td>
      <td>Shiraz</td>
      <td>Kay Brothers</td>
    </tr>
    <tr>
      <th>87137</th>
      <td>Australia</td>
      <td>Perhaps the best young wine I've tasted from M...</td>
      <td>NaN</td>
      <td>95</td>
      <td>84.0</td>
      <td>Western Australia</td>
      <td>Margaret River</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Moss Wood 2011 Cabernet Sauvignon (Margaret Ri...</td>
      <td>Cabernet Sauvignon</td>
      <td>Moss Wood</td>
    </tr>
    <tr>
      <th>87143</th>
      <td>Australia</td>
      <td>This is wonderfully complex and aromatic, with...</td>
      <td>St. Andrews Single Vineyard Release</td>
      <td>95</td>
      <td>60.0</td>
      <td>South Australia</td>
      <td>Clare Valley</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Wakefield 2012 St. Andrews Single Vineyard Rel...</td>
      <td>Shiraz</td>
      <td>Wakefield</td>
    </tr>
    <tr>
      <th>91851</th>
      <td>New Zealand</td>
      <td>This full-bodied, richly tannic wine delivers....</td>
      <td>Homage</td>
      <td>95</td>
      <td>100.0</td>
      <td>Hawke's Bay</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Trinity Hill 2013 Homage Syrah (Hawke's Bay)</td>
      <td>Syrah</td>
      <td>Trinity Hill</td>
    </tr>
    <tr>
      <th>98386</th>
      <td>Australia</td>
      <td>One of the more approachable of the d'Arenberg...</td>
      <td>Little Venice Single Vineyard</td>
      <td>95</td>
      <td>85.0</td>
      <td>South Australia</td>
      <td>McLaren Vale</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>D'Arenberg 2010 Little Venice Single Vineyard ...</td>
      <td>Shiraz</td>
      <td>D'Arenberg</td>
    </tr>
    <tr>
      <th>99318</th>
      <td>Australia</td>
      <td>From vines planted in 1912, this has been an i...</td>
      <td>Mount Edelstone Vineyard</td>
      <td>95</td>
      <td>200.0</td>
      <td>South Australia</td>
      <td>Eden Valley</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Henschke 2014 Mount Edelstone Vineyard Shiraz ...</td>
      <td>Shiraz</td>
      <td>Henschke</td>
    </tr>
    <tr>
      <th>99330</th>
      <td>Australia</td>
      <td>This Cabernet equivalent to Grange has explode...</td>
      <td>Bin 707</td>
      <td>95</td>
      <td>500.0</td>
      <td>South Australia</td>
      <td>South Australia</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Penfolds 2014 Bin 707 Cabernet Sauvignon (Sout...</td>
      <td>Cabernet Sauvignon</td>
      <td>Penfolds</td>
    </tr>
    <tr>
      <th>99340</th>
      <td>Australia</td>
      <td>This rich, opulent wine carries its massive oa...</td>
      <td>Les Amis</td>
      <td>95</td>
      <td>185.0</td>
      <td>South Australia</td>
      <td>Barossa Valley</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Torbreck 2013 Les Amis Grenache (Barossa Valley)</td>
      <td>Grenache</td>
      <td>Torbreck</td>
    </tr>
    <tr>
      <th>109427</th>
      <td>Australia</td>
      <td>This wine is dark brown in hue with a greenish...</td>
      <td>Rare</td>
      <td>99</td>
      <td>300.0</td>
      <td>Victoria</td>
      <td>Rutherglen</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Chambers Rosewood Vineyards NV Rare Muscadelle...</td>
      <td>Muscadelle</td>
      <td>Chambers Rosewood Vineyards</td>
    </tr>
    <tr>
      <th>109434</th>
      <td>Australia</td>
      <td>D'Arenberg's lineup of single-vineyard Shiraze...</td>
      <td>The Swinging Malaysian Single Vineyard</td>
      <td>96</td>
      <td>85.0</td>
      <td>South Australia</td>
      <td>McLaren Vale</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>D'Arenberg 2010 The Swinging Malaysian Single ...</td>
      <td>Shiraz</td>
      <td>D'Arenberg</td>
    </tr>
    <tr>
      <th>122421</th>
      <td>Australia</td>
      <td>Despite this wine's weight and richness, it re...</td>
      <td>Amon-Ra Unfiltered</td>
      <td>96</td>
      <td>110.0</td>
      <td>South Australia</td>
      <td>Barossa Valley</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Glaetzer 2010 Amon-Ra Unfiltered Shiraz (Baros...</td>
      <td>Shiraz</td>
      <td>Glaetzer</td>
    </tr>
    <tr>
      <th>122430</th>
      <td>Australia</td>
      <td>These blends are traditional in Australia—they...</td>
      <td>Anaperenna</td>
      <td>95</td>
      <td>80.0</td>
      <td>South Australia</td>
      <td>Barossa Valley</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Glaetzer 2010 Anaperenna Shiraz-Cabernet Sauvi...</td>
      <td>Shiraz-Cabernet Sauvignon</td>
      <td>Glaetzer</td>
    </tr>
    <tr>
      <th>122507</th>
      <td>New Zealand</td>
      <td>This blend of Cabernet Sauvignon (62.5%), Merl...</td>
      <td>SQM Gimblett Gravels Cabernets/Merlot</td>
      <td>95</td>
      <td>79.0</td>
      <td>Hawke's Bay</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Squawking Magpie 2014 SQM Gimblett Gravels Cab...</td>
      <td>Bordeaux-style Red Blend</td>
      <td>Squawking Magpie</td>
    </tr>
    <tr>
      <th>122939</th>
      <td>Australia</td>
      <td>Full-bodied and plush yet vibrant and imbued w...</td>
      <td>The Factor</td>
      <td>98</td>
      <td>125.0</td>
      <td>South Australia</td>
      <td>Barossa Valley</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>Torbreck 2013 The Factor Shiraz (Barossa Valley)</td>
      <td>Shiraz</td>
      <td>Torbreck</td>
    </tr>
  </tbody>
</table>
</div>



<h1 id="Summary-Functions-and-Maps"><a href="#Summary-Functions-and-Maps" class="headerlink" title="Summary Functions and Maps"></a>Summary Functions and Maps</h1><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>在上一教程中，我们学习了如何从 DataFrame 或 Series 中选择相关数据。正如我们在练习中演示的那样，从数据表示中提取正确的数据对于完成工作至关重要。</p>
<p>然而，数据并不总是以我们想要的格式从内存中直接取出。有时，我们必须自己再做一些工作来重新格式化数据，以完成手头的任务。本教程将介绍我们可以对数据进行的不同操作，以获得 “恰到好处 “的输入。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">reviews = pd.read_csv(<span class="string">&#x27;datasets/wine/winemag-data-130k-v2.csv&#x27;</span>,index_col=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>description</th>
      <th>designation</th>
      <th>points</th>
      <th>price</th>
      <th>province</th>
      <th>region_1</th>
      <th>region_2</th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>title</th>
      <th>variety</th>
      <th>winery</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Italy</td>
      <td>Aromas include tropical fruit, broom, brimston...</td>
      <td>Vulkà Bianco</td>
      <td>87</td>
      <td>NaN</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Etna</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Nicosia 2013 Vulkà Bianco  (Etna)</td>
      <td>White Blend</td>
      <td>Nicosia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Portugal</td>
      <td>This is ripe and fruity, a wine that is smooth...</td>
      <td>Avidagos</td>
      <td>87</td>
      <td>15.0</td>
      <td>Douro</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Quinta dos Avidagos 2011 Avidagos Red (Douro)</td>
      <td>Portuguese Red</td>
      <td>Quinta dos Avidagos</td>
    </tr>
    <tr>
      <th>2</th>
      <td>US</td>
      <td>Tart and snappy, the flavors of lime flesh and...</td>
      <td>NaN</td>
      <td>87</td>
      <td>14.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Rainstorm 2013 Pinot Gris (Willamette Valley)</td>
      <td>Pinot Gris</td>
      <td>Rainstorm</td>
    </tr>
    <tr>
      <th>3</th>
      <td>US</td>
      <td>Pineapple rind, lemon pith and orange blossom ...</td>
      <td>Reserve Late Harvest</td>
      <td>87</td>
      <td>13.0</td>
      <td>Michigan</td>
      <td>Lake Michigan Shore</td>
      <td>NaN</td>
      <td>Alexander Peartree</td>
      <td>NaN</td>
      <td>St. Julian 2013 Reserve Late Harvest Riesling ...</td>
      <td>Riesling</td>
      <td>St. Julian</td>
    </tr>
    <tr>
      <th>4</th>
      <td>US</td>
      <td>Much like the regular bottling from 2012, this...</td>
      <td>Vintner's Reserve Wild Child Block</td>
      <td>87</td>
      <td>65.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Sweet Cheeks 2012 Vintner's Reserve Wild Child...</td>
      <td>Pinot Noir</td>
      <td>Sweet Cheeks</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>129966</th>
      <td>Germany</td>
      <td>Notes of honeysuckle and cantaloupe sweeten th...</td>
      <td>Brauneberger Juffer-Sonnenuhr Spätlese</td>
      <td>90</td>
      <td>28.0</td>
      <td>Mosel</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Anna Lee C. Iijima</td>
      <td>NaN</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef) 2013 ...</td>
      <td>Riesling</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef)</td>
    </tr>
    <tr>
      <th>129967</th>
      <td>US</td>
      <td>Citation is given as much as a decade of bottl...</td>
      <td>NaN</td>
      <td>90</td>
      <td>75.0</td>
      <td>Oregon</td>
      <td>Oregon</td>
      <td>Oregon Other</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Citation 2004 Pinot Noir (Oregon)</td>
      <td>Pinot Noir</td>
      <td>Citation</td>
    </tr>
    <tr>
      <th>129968</th>
      <td>France</td>
      <td>Well-drained gravel soil gives this wine its c...</td>
      <td>Kritt</td>
      <td>90</td>
      <td>30.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Gresser 2013 Kritt Gewurztraminer (Als...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Gresser</td>
    </tr>
    <tr>
      <th>129969</th>
      <td>France</td>
      <td>A dry style of Pinot Gris, this is crisp with ...</td>
      <td>NaN</td>
      <td>90</td>
      <td>32.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Marcel Deiss 2012 Pinot Gris (Alsace)</td>
      <td>Pinot Gris</td>
      <td>Domaine Marcel Deiss</td>
    </tr>
    <tr>
      <th>129970</th>
      <td>France</td>
      <td>Big, rich and off-dry, this is powered by inte...</td>
      <td>Lieu-dit Harth Cuvée Caroline</td>
      <td>90</td>
      <td>21.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Schoffit 2012 Lieu-dit Harth Cuvée Car...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Schoffit</td>
    </tr>
  </tbody>
</table>
<p>129971 rows × 13 columns</p>
</div>



<h2 id="Summary-functions"><a href="#Summary-functions" class="headerlink" title="Summary functions"></a>Summary functions</h2><p>Pandas 提供了许多简单的“摘要函数”（不是官方名称），它们以某种有用的方式重组数据。例如，考虑describe()方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.points.describe()</span><br></pre></td></tr></table></figure>




<pre><code>count    129971.000000
mean         88.447138
std           3.039730
min          80.000000
25%          86.000000
50%          88.000000
75%          91.000000
max         100.000000
Name: points, dtype: float64
</code></pre>
<p>该方法生成给定列属性的高级摘要。它是类型感知的，这意味着它的输出会根据输入的数据类型而改变。上面的输出仅对数值数据有意义；对于字符串数据，我们得到的结果如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.taster_name.describe()</span><br></pre></td></tr></table></figure>




<pre><code>count         103727
unique            19
top       Roger Voss
freq           25514
Name: taster_name, dtype: object
</code></pre>
<p>如果你想得到DataFrame或Series中某一列的一些特定的简单汇总统计，通常有一个有用的pandas函数可以实现。</p>
<p>例如，我们可以使用mean()函数来查看所分配分数的平均值（例如，平均评分的葡萄酒的表现如何）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.points.mean()</span><br></pre></td></tr></table></figure>




<pre><code>88.44713820775404
</code></pre>
<p>要查看唯一值的列表，我们可以使用 unique() 函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.taster_name.unique()</span><br></pre></td></tr></table></figure>




<pre><code>array([&#39;Kerin O’Keefe&#39;, &#39;Roger Voss&#39;, &#39;Paul Gregutt&#39;,
       &#39;Alexander Peartree&#39;, &#39;Michael Schachner&#39;, &#39;Anna Lee C. Iijima&#39;,
       &#39;Virginie Boone&#39;, &#39;Matt Kettmann&#39;, nan, &#39;Sean P. Sullivan&#39;,
       &#39;Jim Gordon&#39;, &#39;Joe Czerwinski&#39;, &#39;Anne Krebiehl\xa0MW&#39;,
       &#39;Lauren Buzzeo&#39;, &#39;Mike DeSimone&#39;, &#39;Jeff Jenssen&#39;,
       &#39;Susan Kostrzewa&#39;, &#39;Carrie Dykes&#39;, &#39;Fiona Adams&#39;,
       &#39;Christina Pickard&#39;], dtype=object)
</code></pre>
<p>要查看唯一值的列表以及它们在数据集中出现的频率，我们可以使用 value_counts() 方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.taster_name.value_counts()</span><br></pre></td></tr></table></figure>




<pre><code>taster_name
Roger Voss            25514
Michael Schachner     15134
Kerin O’Keefe         10776
Virginie Boone         9537
Paul Gregutt           9532
Matt Kettmann          6332
Joe Czerwinski         5147
Sean P. Sullivan       4966
Anna Lee C. Iijima     4415
Jim Gordon             4177
Anne Krebiehl MW       3685
Lauren Buzzeo          1835
Susan Kostrzewa        1085
Mike DeSimone           514
Jeff Jenssen            491
Alexander Peartree      415
Carrie Dykes            139
Fiona Adams              27
Christina Pickard         6
Name: count, dtype: int64
</code></pre>
<h2 id="Maps"><a href="#Maps" class="headerlink" title="Maps"></a>Maps</h2><p>映射（map）是从数学中借用的术语，指的是将一组值 “映射 “到另一组值的函数。在数据科学中，我们经常需要从现有数据中创建新的表示方法，或者将数据从现在的格式转换为我们希望的格式。映射就是处理这些工作的工具，因此它对于完成工作极为重要！</p>
<p>有两种映射方法您会经常用到。</p>
<p>map()是第一个，也是稍微简单的一个。例如，假设我们想将葡萄酒得到的分数重新平均为0：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">review_points_mean = reviews.points.mean()</span><br><span class="line">reviews.points.<span class="built_in">map</span>(<span class="keyword">lambda</span> p: p - review_points_mean) <span class="comment">#输入points，函数为points-points_mean</span></span><br></pre></td></tr></table></figure>




<pre><code>0        -1.447138
1        -1.447138
2        -1.447138
3        -1.447138
4        -1.447138
            ...   
129966    1.552862
129967    1.552862
129968    1.552862
129969    1.552862
129970    1.552862
Name: points, Length: 129971, dtype: float64
</code></pre>
<p>您传递给map()的函数应该期望从Series中得到一个单独的值（在上面的示例中是一个点值），并返回该值的转换版本。 map()返回一个新的Series，其中所有的值都已被您的函数转换。</p>
<p>如果我们想通过在每一行上调用自定义方法来转换整个DataFrame，则apply()是等价的方法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">remean_points</span>(<span class="params">row</span>):</span><br><span class="line">    row.points = row.points - review_points_mean</span><br><span class="line">    <span class="keyword">return</span> row</span><br><span class="line"></span><br><span class="line">reviews.apply(remean_points, axis=<span class="string">&#x27;columns&#x27;</span>)</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>description</th>
      <th>designation</th>
      <th>points</th>
      <th>price</th>
      <th>province</th>
      <th>region_1</th>
      <th>region_2</th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>title</th>
      <th>variety</th>
      <th>winery</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Italy</td>
      <td>Aromas include tropical fruit, broom, brimston...</td>
      <td>Vulkà Bianco</td>
      <td>-1.447138</td>
      <td>NaN</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Etna</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Nicosia 2013 Vulkà Bianco  (Etna)</td>
      <td>White Blend</td>
      <td>Nicosia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Portugal</td>
      <td>This is ripe and fruity, a wine that is smooth...</td>
      <td>Avidagos</td>
      <td>-1.447138</td>
      <td>15.0</td>
      <td>Douro</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Quinta dos Avidagos 2011 Avidagos Red (Douro)</td>
      <td>Portuguese Red</td>
      <td>Quinta dos Avidagos</td>
    </tr>
    <tr>
      <th>2</th>
      <td>US</td>
      <td>Tart and snappy, the flavors of lime flesh and...</td>
      <td>NaN</td>
      <td>-1.447138</td>
      <td>14.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Rainstorm 2013 Pinot Gris (Willamette Valley)</td>
      <td>Pinot Gris</td>
      <td>Rainstorm</td>
    </tr>
    <tr>
      <th>3</th>
      <td>US</td>
      <td>Pineapple rind, lemon pith and orange blossom ...</td>
      <td>Reserve Late Harvest</td>
      <td>-1.447138</td>
      <td>13.0</td>
      <td>Michigan</td>
      <td>Lake Michigan Shore</td>
      <td>NaN</td>
      <td>Alexander Peartree</td>
      <td>NaN</td>
      <td>St. Julian 2013 Reserve Late Harvest Riesling ...</td>
      <td>Riesling</td>
      <td>St. Julian</td>
    </tr>
    <tr>
      <th>4</th>
      <td>US</td>
      <td>Much like the regular bottling from 2012, this...</td>
      <td>Vintner's Reserve Wild Child Block</td>
      <td>-1.447138</td>
      <td>65.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Sweet Cheeks 2012 Vintner's Reserve Wild Child...</td>
      <td>Pinot Noir</td>
      <td>Sweet Cheeks</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>129966</th>
      <td>Germany</td>
      <td>Notes of honeysuckle and cantaloupe sweeten th...</td>
      <td>Brauneberger Juffer-Sonnenuhr Spätlese</td>
      <td>1.552862</td>
      <td>28.0</td>
      <td>Mosel</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Anna Lee C. Iijima</td>
      <td>NaN</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef) 2013 ...</td>
      <td>Riesling</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef)</td>
    </tr>
    <tr>
      <th>129967</th>
      <td>US</td>
      <td>Citation is given as much as a decade of bottl...</td>
      <td>NaN</td>
      <td>1.552862</td>
      <td>75.0</td>
      <td>Oregon</td>
      <td>Oregon</td>
      <td>Oregon Other</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Citation 2004 Pinot Noir (Oregon)</td>
      <td>Pinot Noir</td>
      <td>Citation</td>
    </tr>
    <tr>
      <th>129968</th>
      <td>France</td>
      <td>Well-drained gravel soil gives this wine its c...</td>
      <td>Kritt</td>
      <td>1.552862</td>
      <td>30.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Gresser 2013 Kritt Gewurztraminer (Als...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Gresser</td>
    </tr>
    <tr>
      <th>129969</th>
      <td>France</td>
      <td>A dry style of Pinot Gris, this is crisp with ...</td>
      <td>NaN</td>
      <td>1.552862</td>
      <td>32.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Marcel Deiss 2012 Pinot Gris (Alsace)</td>
      <td>Pinot Gris</td>
      <td>Domaine Marcel Deiss</td>
    </tr>
    <tr>
      <th>129970</th>
      <td>France</td>
      <td>Big, rich and off-dry, this is powered by inte...</td>
      <td>Lieu-dit Harth Cuvée Caroline</td>
      <td>1.552862</td>
      <td>21.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Schoffit 2012 Lieu-dit Harth Cuvée Car...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Schoffit</td>
    </tr>
  </tbody>
</table>
<p>129971 rows × 13 columns</p>
</div>



<p>如果我们在调用views.apply()时使用的是axis&#x3D;’index’，那么我们就不需要传递一个函数来转换每一行，而是需要给出一个函数来转换每一列。请注意，map()和apply()分别返回新的、转换后的Series和DataFrames。它们不会修改被调用的原始数据。如果我们查看第一行的评论，我们可以看到它仍然具有原始的点值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.head(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>description</th>
      <th>designation</th>
      <th>points</th>
      <th>price</th>
      <th>province</th>
      <th>region_1</th>
      <th>region_2</th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>title</th>
      <th>variety</th>
      <th>winery</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Italy</td>
      <td>Aromas include tropical fruit, broom, brimston...</td>
      <td>Vulkà Bianco</td>
      <td>87</td>
      <td>NaN</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Etna</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Nicosia 2013 Vulkà Bianco  (Etna)</td>
      <td>White Blend</td>
      <td>Nicosia</td>
    </tr>
  </tbody>
</table>
</div>



<p>Pandas 提供了许多常见的内置映射操作。例如，以下是重新定义点列的更快方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">review_points_mean = reviews.points.mean()</span><br><span class="line">reviews.points - review_points_mean</span><br></pre></td></tr></table></figure>




<pre><code>0        -1.447138
1        -1.447138
2        -1.447138
3        -1.447138
4        -1.447138
            ...   
129966    1.552862
129967    1.552862
129968    1.552862
129969    1.552862
129970    1.552862
Name: points, Length: 129971, dtype: float64
</code></pre>
<p>在这段代码中，我们在左侧的大量值（系列中的所有值）和右侧的单个值（平均值）之间执行运算。Pandas查看该表达式，并计算出我们必须从数据集中的每个值中减去该平均值。</p>
<p>如果我们在等长序列之间执行这些操作，Pandas也会明白该怎么做。例如，结合数据集中的国家和地区信息的简单方法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.country + <span class="string">&quot; - &quot;</span> + reviews.region_1</span><br></pre></td></tr></table></figure>




<pre><code>0                     Italy - Etna
1                              NaN
2           US - Willamette Valley
3         US - Lake Michigan Shore
4           US - Willamette Valley
                    ...           
129966                         NaN
129967                 US - Oregon
129968             France - Alsace
129969             France - Alsace
129970             France - Alsace
Length: 129971, dtype: object
</code></pre>
<p>这些运算符比map()或apply()更快，因为它们使用了pandas内置的加速功能。所有标准的 Python 运算符 (&gt;, &lt;, &#x3D;&#x3D;, 等等) 都以这种方式工作。</p>
<p>然而，它们不如map()或apply()灵活，后者可以做更高级的事情，比如应用条件逻辑，而这是加减法无法做到的。</p>
<h1 id="TEST-1"><a href="#TEST-1" class="headerlink" title="TEST"></a>TEST</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">reviews = pd.read_csv(<span class="string">&#x27;datasets/wine/winemag-data-130k-v2.csv&#x27;</span>,index_col=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<p>1.review DataFrame 中points列的中位数是多少？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews[<span class="string">&#x27;points&#x27;</span>].median()</span><br></pre></td></tr></table></figure>




<pre><code>88.0
</code></pre>
<p>2.What countries are represented in the dataset? (Your answer should not include any duplicates.)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">countries=reviews[<span class="string">&#x27;country&#x27;</span>].unique()</span><br><span class="line">countries</span><br></pre></td></tr></table></figure>




<pre><code>array([&#39;Italy&#39;, &#39;Portugal&#39;, &#39;US&#39;, &#39;Spain&#39;, &#39;France&#39;, &#39;Germany&#39;,
       &#39;Argentina&#39;, &#39;Chile&#39;, &#39;Australia&#39;, &#39;Austria&#39;, &#39;South Africa&#39;,
       &#39;New Zealand&#39;, &#39;Israel&#39;, &#39;Hungary&#39;, &#39;Greece&#39;, &#39;Romania&#39;, &#39;Mexico&#39;,
       &#39;Canada&#39;, nan, &#39;Turkey&#39;, &#39;Czech Republic&#39;, &#39;Slovenia&#39;,
       &#39;Luxembourg&#39;, &#39;Croatia&#39;, &#39;Georgia&#39;, &#39;Uruguay&#39;, &#39;England&#39;,
       &#39;Lebanon&#39;, &#39;Serbia&#39;, &#39;Brazil&#39;, &#39;Moldova&#39;, &#39;Morocco&#39;, &#39;Peru&#39;,
       &#39;India&#39;, &#39;Bulgaria&#39;, &#39;Cyprus&#39;, &#39;Armenia&#39;, &#39;Switzerland&#39;,
       &#39;Bosnia and Herzegovina&#39;, &#39;Ukraine&#39;, &#39;Slovakia&#39;, &#39;Macedonia&#39;,
       &#39;China&#39;, &#39;Egypt&#39;], dtype=object)
</code></pre>
<p>3.How often does each country appear in the dataset? Create a Series reviews_per_country mapping countries to the count of reviews of wines from that country.<br>每个国家在数据集中出现的频率是多少？创建一个 Series Reviews_per_country，将国家映射到该国家的葡萄酒reviews数量。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">reviews[<span class="string">&#x27;country&#x27;</span>].value_counts()</span><br></pre></td></tr></table></figure>




<pre><code>country
US                        54504
France                    22093
Italy                     19540
Spain                      6645
Portugal                   5691
Chile                      4472
Argentina                  3800
Austria                    3345
Australia                  2329
Germany                    2165
New Zealand                1419
South Africa               1401
Israel                      505
Greece                      466
Canada                      257
Hungary                     146
Bulgaria                    141
Romania                     120
Uruguay                     109
Turkey                       90
Slovenia                     87
Georgia                      86
England                      74
Croatia                      73
Mexico                       70
Moldova                      59
Brazil                       52
Lebanon                      35
Morocco                      28
Peru                         16
Ukraine                      14
Serbia                       12
Czech Republic               12
Macedonia                    12
Cyprus                       11
India                         9
Switzerland                   7
Luxembourg                    6
Bosnia and Herzegovina        2
Armenia                       2
Slovakia                      1
China                         1
Egypt                         1
Name: count, dtype: int64
</code></pre>
<p>Create variable centered_price containing a version of the price column with the mean price subtracted. (Note: this ‘centering’ transformation is a common preprocessing step before applying various machine learning algorithms.)</p>
<p>创建变量 centered_price，其中包含减去平均价格的价格列版本。 （注意：这种“居中”转换是应用各种机器学习算法之前的常见预处理步骤。）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = reviews[<span class="string">&#x27;price&#x27;</span>].mean()</span><br><span class="line">reviews[<span class="string">&#x27;price&#x27;</span>].<span class="built_in">map</span>(<span class="keyword">lambda</span> p: p-a)</span><br></pre></td></tr></table></figure>




<pre><code>0               NaN
1        -20.363389
2        -21.363389
3        -22.363389
4         29.636611
            ...    
129966    -7.363389
129967    39.636611
129968    -5.363389
129969    -3.363389
129970   -14.363389
Name: price, Length: 129971, dtype: float64
</code></pre>
<p>I’m an economical wine buyer. Which wine is the “best bargain”? Create a variable bargain_wine with the title of the wine with the highest points-to-price ratio in the dataset.</p>
<p>我是一个经济实惠的葡萄酒买家。哪种酒是“最划算的”？使用数据集中积分价格比最高的葡萄酒的标题创建一个变量 deal_wine。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># reviews[[(reviews[&#x27;points&#x27;]/reviews[&#x27;price&#x27;]).idxmax()]]</span></span><br><span class="line">reviews[<span class="string">&#x27;title&#x27;</span>][(reviews[<span class="string">&#x27;points&#x27;</span>]/reviews[<span class="string">&#x27;price&#x27;</span>]).idxmax()]</span><br><span class="line"></span><br></pre></td></tr></table></figure>




<pre><code>&#39;Bandit NV Merlot (California)&#39;
</code></pre>
<p>6.There are only so many words you can use when describing a bottle of wine. Is a wine more likely to be “tropical” or “fruity”? Create a Series <code>descriptor_counts</code> counting how many times each of these two words appears in the <code>description</code> column in the dataset. (For simplicity, let’s ignore the capitalized versions of these words.)</p>
<p>在描述一瓶葡萄酒时，您可以使用的词汇有限。葡萄酒更可能是 “热带 “还是 “果味”？创建一个 “descriptor_counts “系列，计算这两个词在数据集的 “description “列中分别出现的次数。(为简单起见，让我们忽略这些词的大写版本）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">trop_ocurr</span>(<span class="params">row</span>):</span><br><span class="line">    <span class="keyword">return</span> re.search(<span class="string">&quot;tropical&quot;</span>,row.description)==<span class="literal">None</span>  </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">frui_ocurr</span>(<span class="params">row</span>):</span><br><span class="line">    <span class="keyword">return</span> re.search(<span class="string">&quot;fruity&quot;</span>,row.description)==<span class="literal">None</span>  </span><br><span class="line"></span><br><span class="line">a = reviews.apply(trop_ocurr, axis=<span class="string">&#x27;columns&#x27;</span>).value_counts()[<span class="literal">False</span>]</span><br><span class="line">b = reviews.apply(frui_ocurr, axis=<span class="string">&#x27;columns&#x27;</span>).value_counts()[<span class="literal">False</span>]</span><br><span class="line"></span><br><span class="line">pd.Series([a,b],index=[<span class="string">&#x27;tropical&#x27;</span>, <span class="string">&#x27;fruity&#x27;</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure>




<pre><code>0    3607
1    9090
dtype: int64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">############答案的方法##########</span></span><br><span class="line">n_trop = reviews.description.<span class="built_in">map</span>(<span class="keyword">lambda</span> desc: <span class="string">&quot;tropical&quot;</span> <span class="keyword">in</span> desc).<span class="built_in">sum</span>()</span><br><span class="line">n_fruity = reviews.description.<span class="built_in">map</span>(<span class="keyword">lambda</span> desc: <span class="string">&quot;fruity&quot;</span> <span class="keyword">in</span> desc).<span class="built_in">sum</span>()</span><br><span class="line">pd.Series([n_trop, n_fruity], index=[<span class="string">&#x27;tropical&#x27;</span>, <span class="string">&#x27;fruity&#x27;</span>])</span><br></pre></td></tr></table></figure>




<pre><code>tropical    3607
fruity      9090
dtype: int64
</code></pre>
<ol start="7">
<li>We’d like to host these wine reviews on our website, but a rating system ranging from 80 to 100 points is too hard to understand - we’d like to translate them into simple star ratings. A score of 95 or higher counts as 3 stars, a score of at least 85 but less than 95 is 2 stars. Any other score is 1 star.</li>
</ol>
<p>Also, the Canadian Vintners Association bought a lot of ads on the site, so any wines from Canada should automatically get 3 stars, regardless of points.</p>
<p>Create a series <code>star_ratings</code> with the number of stars corresponding to each review in the dataset.</p>
<p>我们希望将这些酒评放在我们的网站上，但从80分到100分的评分系统太难懂了–我们希望将其转化为简单的星级评分。95分及以上为3星，85分以上95分以下为2星。其他分数为1星。</p>
<p>此外，加拿大葡萄酒商协会在网站上购买了大量广告，因此任何来自加拿大的葡萄酒都应该自动获得3星，无论分数高低。</p>
<p>创建一个 “star_ratings “序列，其中包含数据集中每条review对应的星级数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a = pd.Series()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rate</span>(<span class="params">row</span>):</span><br><span class="line">    <span class="comment"># row[&#x27;points&#x27;]=3 if (row[&#x27;country&#x27;]==&#x27;Canada&#x27; or row[&#x27;points&#x27;]&gt;=95) else 2 if(row[&#x27;points&#x27;]&gt;=85) else 1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">3</span> <span class="keyword">if</span> (row[<span class="string">&#x27;country&#x27;</span>]==<span class="string">&#x27;Canada&#x27;</span> <span class="keyword">or</span> row[<span class="string">&#x27;points&#x27;</span>]&gt;=<span class="number">95</span>) <span class="keyword">else</span> <span class="number">2</span> <span class="keyword">if</span>(row[<span class="string">&#x27;points&#x27;</span>]&gt;=<span class="number">85</span>) <span class="keyword">else</span> <span class="number">1</span></span><br><span class="line">    <span class="comment"># return row</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># reviews.apply(rate, axis=&#x27;columns&#x27;)[&#x27;points&#x27;]</span></span><br><span class="line">reviews.apply(rate, axis=<span class="string">&#x27;columns&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>




<pre><code>0         2
1         2
2         2
3         2
4         2
         ..
129966    2
129967    2
129968    2
129969    2
129970    2
Length: 129971, dtype: int64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">###官方答案###</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">stars</span>(<span class="params">row</span>):</span><br><span class="line">    <span class="keyword">if</span> row.country == <span class="string">&#x27;Canada&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> row.points &gt;= <span class="number">95</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> row.points &gt;= <span class="number">85</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">reviews.apply(stars, axis=<span class="string">&#x27;columns&#x27;</span>)</span><br></pre></td></tr></table></figure>




<pre><code>0         2
1         2
2         2
3         2
4         2
         ..
129966    2
129967    2
129968    2
129969    2
129970    2
Length: 129971, dtype: int64
</code></pre>
<h1 id="Grouping-and-Sorting"><a href="#Grouping-and-Sorting" class="headerlink" title="Grouping and Sorting"></a>Grouping and Sorting</h1><p>映射允许我们对数据帧或系列中的数据进行转换，一次只转换整个列中的一个值。然而，我们经常希望对数据进行分组，然后对数据所在的组进行特定操作。</p>
<p>正如您将了解到的，我们通过groupby()操作来实现这一点。我们还将介绍一些其他主题，例如索引DataFrames的更复杂方法，以及如何排序数据。</p>
<h2 id="分组分析"><a href="#分组分析" class="headerlink" title="分组分析"></a>分组分析</h2><p>到目前为止，我们经常使用的一个函数是 value_counts() 函数。我们可以通过执行以下操作来复制 value_counts() 的作用：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">reviews = pd.read_csv(<span class="string">&#x27;datasets/wine/winemag-data-130k-v2.csv&#x27;</span>,index_col=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(reviews.groupby(<span class="string">&#x27;points&#x27;</span>).points.count())</span><br><span class="line"><span class="built_in">print</span>(reviews.groupby(<span class="string">&#x27;points&#x27;</span>).price.count())</span><br><span class="line"><span class="built_in">print</span>(reviews.groupby(<span class="string">&#x27;price&#x27;</span>).price.count())</span><br><span class="line"><span class="built_in">print</span>(reviews.groupby(<span class="string">&#x27;price&#x27;</span>).points.count())</span><br></pre></td></tr></table></figure>

<pre><code>points
80       397
81       692
82      1836
83      3025
84      6480
85      9530
86     12600
87     16933
88     17207
89     12226
90     15410
91     11359
92      9613
93      6489
94      3758
95      1535
96       523
97       229
98        77
99        33
100       19
Name: points, dtype: int64
points
80       395
81       680
82      1772
83      2886
84      6099
85      8902
86     11745
87     15767
88     16014
89     11324
90     14361
91     10564
92      8871
93      5935
94      3449
95      1406
96       482
97       207
98        69
99        28
100       19
Name: price, dtype: int64
price
4.0        11
5.0        46
6.0       120
7.0       433
8.0       892
         ... 
1900.0      1
2000.0      2
2013.0      1
2500.0      2
3300.0      1
Name: price, Length: 390, dtype: int64
price
4.0        11
5.0        46
6.0       120
7.0       433
8.0       892
         ... 
1900.0      1
2000.0      2
2013.0      1
2500.0      2
3300.0      1
Name: points, Length: 390, dtype: int64
</code></pre>
<p>groupby()创建了一组评论，这些评论为给定的葡萄酒分配了相同的分值。然后，对于每一组，我们抓取points()列并计算它出现的次数。 value_counts()只是groupby()操作的快捷方式。</p>
<p>我们可以对这些数据使用我们之前使用过的任何汇总函数。例如，要获得每个点值类别中最便宜的葡萄酒，我们可以执行以下操作：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.groupby(<span class="string">&#x27;points&#x27;</span>).price.<span class="built_in">min</span>()</span><br></pre></td></tr></table></figure>




<pre><code>points
80      5.0
81      5.0
82      4.0
83      4.0
84      4.0
85      4.0
86      4.0
87      5.0
88      6.0
89      7.0
90      8.0
91      7.0
92     11.0
93     12.0
94     13.0
95     20.0
96     20.0
97     35.0
98     50.0
99     44.0
100    80.0
Name: price, dtype: float64
</code></pre>
<p>您可以将我们生成的每个组视为DataFrame的一个片段，其中仅包含值匹配的数据。我们可以使用apply()方法直接访问该DataFrame，然后以我们认为合适的方式处理数据。例如，我们可以从数据集中的每个酒庄中选择第一款葡萄酒的名称：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.groupby(<span class="string">&#x27;winery&#x27;</span>).apply(<span class="keyword">lambda</span> df: df.title.iloc[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>




<pre><code>winery
1+1=3                                     1+1=3 NV Rosé Sparkling (Cava)
10 Knots                            10 Knots 2010 Viognier (Paso Robles)
100 Percent Wine              100 Percent Wine 2015 Moscato (California)
1000 Stories           1000 Stories 2013 Bourbon Barrel Aged Zinfande...
1070 Green                  1070 Green 2011 Sauvignon Blanc (Rutherford)
                                             ...                        
Órale                       Órale 2011 Cabronita Red (Santa Ynez Valley)
Öko                    Öko 2013 Made With Organically Grown Grapes Ma...
Ökonomierat Rebholz    Ökonomierat Rebholz 2007 Von Rotliegenden Spät...
àMaurice               àMaurice 2013 Fred Estate Syrah (Walla Walla V...
Štoka                                    Štoka 2009 Izbrani Teran (Kras)
Length: 16757, dtype: object
</code></pre>
<p>为了进行更细粒度的控制，您还可以按多列进行分组。举个例子，以下是我们如何按国家和省份挑选最好的葡萄酒的方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.groupby([<span class="string">&#x27;country&#x27;</span>, <span class="string">&#x27;province&#x27;</span>]).apply(<span class="keyword">lambda</span> df: df.loc[df.points.idxmax()])</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>country</th>
      <th>description</th>
      <th>designation</th>
      <th>points</th>
      <th>price</th>
      <th>province</th>
      <th>region_1</th>
      <th>region_2</th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>title</th>
      <th>variety</th>
      <th>winery</th>
    </tr>
    <tr>
      <th>country</th>
      <th>province</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Argentina</th>
      <th>Mendoza Province</th>
      <td>Argentina</td>
      <td>If the color doesn't tell the full story, the ...</td>
      <td>Nicasia Vineyard</td>
      <td>97</td>
      <td>120.0</td>
      <td>Mendoza Province</td>
      <td>Mendoza</td>
      <td>NaN</td>
      <td>Michael Schachner</td>
      <td>@wineschach</td>
      <td>Bodega Catena Zapata 2006 Nicasia Vineyard Mal...</td>
      <td>Malbec</td>
      <td>Bodega Catena Zapata</td>
    </tr>
    <tr>
      <th>Other</th>
      <td>Argentina</td>
      <td>Take note, this could be the best wine Colomé ...</td>
      <td>Reserva</td>
      <td>95</td>
      <td>90.0</td>
      <td>Other</td>
      <td>Salta</td>
      <td>NaN</td>
      <td>Michael Schachner</td>
      <td>@wineschach</td>
      <td>Colomé 2010 Reserva Malbec (Salta)</td>
      <td>Malbec</td>
      <td>Colomé</td>
    </tr>
    <tr>
      <th>Armenia</th>
      <th>Armenia</th>
      <td>Armenia</td>
      <td>Deep salmon in color, this wine offers a bouqu...</td>
      <td>Estate Bottled</td>
      <td>88</td>
      <td>15.0</td>
      <td>Armenia</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Mike DeSimone</td>
      <td>@worldwineguys</td>
      <td>Van Ardi 2015 Estate Bottled Rosé (Armenia)</td>
      <td>Rosé</td>
      <td>Van Ardi</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Australia</th>
      <th>Australia Other</th>
      <td>Australia</td>
      <td>Writes the book on how to make a wine filled w...</td>
      <td>Sarah's Blend</td>
      <td>93</td>
      <td>15.0</td>
      <td>Australia Other</td>
      <td>South Eastern Australia</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Marquis Philips 2000 Sarah's Blend Red (South ...</td>
      <td>Red Blend</td>
      <td>Marquis Philips</td>
    </tr>
    <tr>
      <th>New South Wales</th>
      <td>Australia</td>
      <td>De Bortoli's Noble One is as good as ever in 2...</td>
      <td>Noble One Bortytis</td>
      <td>94</td>
      <td>32.0</td>
      <td>New South Wales</td>
      <td>New South Wales</td>
      <td>NaN</td>
      <td>Joe Czerwinski</td>
      <td>@JoeCz</td>
      <td>De Bortoli 2007 Noble One Bortytis Semillon (N...</td>
      <td>Sémillon</td>
      <td>De Bortoli</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">Uruguay</th>
      <th>Juanico</th>
      <td>Uruguay</td>
      <td>This mature Bordeaux-style blend is earthy on ...</td>
      <td>Preludio Barrel Select Lote N 77</td>
      <td>90</td>
      <td>45.0</td>
      <td>Juanico</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Michael Schachner</td>
      <td>@wineschach</td>
      <td>Familia Deicas 2004 Preludio Barrel Select Lot...</td>
      <td>Red Blend</td>
      <td>Familia Deicas</td>
    </tr>
    <tr>
      <th>Montevideo</th>
      <td>Uruguay</td>
      <td>A rich, heady bouquet offers aromas of blackbe...</td>
      <td>Monte Vide Eu Tannat-Merlot-Tempranillo</td>
      <td>91</td>
      <td>60.0</td>
      <td>Montevideo</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Michael Schachner</td>
      <td>@wineschach</td>
      <td>Bouza 2015 Monte Vide Eu Tannat-Merlot-Tempran...</td>
      <td>Red Blend</td>
      <td>Bouza</td>
    </tr>
    <tr>
      <th>Progreso</th>
      <td>Uruguay</td>
      <td>Rusty in color but deep and complex in nature,...</td>
      <td>Etxe Oneko Fortified Sweet Red</td>
      <td>90</td>
      <td>46.0</td>
      <td>Progreso</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Michael Schachner</td>
      <td>@wineschach</td>
      <td>Pisano 2007 Etxe Oneko Fortified Sweet Red Tan...</td>
      <td>Tannat</td>
      <td>Pisano</td>
    </tr>
    <tr>
      <th>San Jose</th>
      <td>Uruguay</td>
      <td>Baked, sweet, heavy aromas turn earthy with ti...</td>
      <td>El Preciado Gran Reserva</td>
      <td>87</td>
      <td>50.0</td>
      <td>San Jose</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Michael Schachner</td>
      <td>@wineschach</td>
      <td>Castillo Viejo 2005 El Preciado Gran Reserva R...</td>
      <td>Red Blend</td>
      <td>Castillo Viejo</td>
    </tr>
    <tr>
      <th>Uruguay</th>
      <td>Uruguay</td>
      <td>Cherry and berry aromas are ripe, healthy and ...</td>
      <td>Blend 002 Limited Edition</td>
      <td>91</td>
      <td>22.0</td>
      <td>Uruguay</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Michael Schachner</td>
      <td>@wineschach</td>
      <td>Narbona NV Blend 002 Limited Edition Tannat-Ca...</td>
      <td>Tannat-Cabernet Franc</td>
      <td>Narbona</td>
    </tr>
  </tbody>
</table>
<p>425 rows × 13 columns</p>
</div>



<p>另一个值得一提的 groupby() 方法是 agg()，它允许您同时在 DataFrame 上运行一堆不同的函数。例如，我们可以生成数据集的简单统计摘要，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.groupby([<span class="string">&#x27;country&#x27;</span>]).price.agg([<span class="built_in">len</span>, <span class="built_in">min</span>, <span class="built_in">max</span>])</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>len</th>
      <th>min</th>
      <th>max</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Argentina</th>
      <td>3800</td>
      <td>4.0</td>
      <td>230.0</td>
    </tr>
    <tr>
      <th>Armenia</th>
      <td>2</td>
      <td>14.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>Australia</th>
      <td>2329</td>
      <td>5.0</td>
      <td>850.0</td>
    </tr>
    <tr>
      <th>Austria</th>
      <td>3345</td>
      <td>7.0</td>
      <td>1100.0</td>
    </tr>
    <tr>
      <th>Bosnia and Herzegovina</th>
      <td>2</td>
      <td>12.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>Brazil</th>
      <td>52</td>
      <td>10.0</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>Bulgaria</th>
      <td>141</td>
      <td>8.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>Canada</th>
      <td>257</td>
      <td>12.0</td>
      <td>120.0</td>
    </tr>
    <tr>
      <th>Chile</th>
      <td>4472</td>
      <td>5.0</td>
      <td>400.0</td>
    </tr>
    <tr>
      <th>China</th>
      <td>1</td>
      <td>18.0</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>Croatia</th>
      <td>73</td>
      <td>12.0</td>
      <td>65.0</td>
    </tr>
    <tr>
      <th>Cyprus</th>
      <td>11</td>
      <td>11.0</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>Czech Republic</th>
      <td>12</td>
      <td>15.0</td>
      <td>45.0</td>
    </tr>
    <tr>
      <th>Egypt</th>
      <td>1</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>England</th>
      <td>74</td>
      <td>25.0</td>
      <td>95.0</td>
    </tr>
    <tr>
      <th>France</th>
      <td>22093</td>
      <td>5.0</td>
      <td>3300.0</td>
    </tr>
    <tr>
      <th>Georgia</th>
      <td>86</td>
      <td>9.0</td>
      <td>40.0</td>
    </tr>
    <tr>
      <th>Germany</th>
      <td>2165</td>
      <td>5.0</td>
      <td>775.0</td>
    </tr>
    <tr>
      <th>Greece</th>
      <td>466</td>
      <td>8.0</td>
      <td>79.0</td>
    </tr>
    <tr>
      <th>Hungary</th>
      <td>146</td>
      <td>10.0</td>
      <td>764.0</td>
    </tr>
    <tr>
      <th>India</th>
      <td>9</td>
      <td>10.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>Israel</th>
      <td>505</td>
      <td>8.0</td>
      <td>150.0</td>
    </tr>
    <tr>
      <th>Italy</th>
      <td>19540</td>
      <td>5.0</td>
      <td>900.0</td>
    </tr>
    <tr>
      <th>Lebanon</th>
      <td>35</td>
      <td>13.0</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>Luxembourg</th>
      <td>6</td>
      <td>16.0</td>
      <td>30.0</td>
    </tr>
    <tr>
      <th>Macedonia</th>
      <td>12</td>
      <td>15.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>Mexico</th>
      <td>70</td>
      <td>8.0</td>
      <td>108.0</td>
    </tr>
    <tr>
      <th>Moldova</th>
      <td>59</td>
      <td>8.0</td>
      <td>42.0</td>
    </tr>
    <tr>
      <th>Morocco</th>
      <td>28</td>
      <td>14.0</td>
      <td>40.0</td>
    </tr>
    <tr>
      <th>New Zealand</th>
      <td>1419</td>
      <td>7.0</td>
      <td>130.0</td>
    </tr>
    <tr>
      <th>Peru</th>
      <td>16</td>
      <td>10.0</td>
      <td>68.0</td>
    </tr>
    <tr>
      <th>Portugal</th>
      <td>5691</td>
      <td>5.0</td>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>Romania</th>
      <td>120</td>
      <td>4.0</td>
      <td>320.0</td>
    </tr>
    <tr>
      <th>Serbia</th>
      <td>12</td>
      <td>15.0</td>
      <td>42.0</td>
    </tr>
    <tr>
      <th>Slovakia</th>
      <td>1</td>
      <td>16.0</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>Slovenia</th>
      <td>87</td>
      <td>7.0</td>
      <td>90.0</td>
    </tr>
    <tr>
      <th>South Africa</th>
      <td>1401</td>
      <td>5.0</td>
      <td>330.0</td>
    </tr>
    <tr>
      <th>Spain</th>
      <td>6645</td>
      <td>4.0</td>
      <td>770.0</td>
    </tr>
    <tr>
      <th>Switzerland</th>
      <td>7</td>
      <td>21.0</td>
      <td>160.0</td>
    </tr>
    <tr>
      <th>Turkey</th>
      <td>90</td>
      <td>14.0</td>
      <td>120.0</td>
    </tr>
    <tr>
      <th>US</th>
      <td>54504</td>
      <td>4.0</td>
      <td>2013.0</td>
    </tr>
    <tr>
      <th>Ukraine</th>
      <td>14</td>
      <td>6.0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>Uruguay</th>
      <td>109</td>
      <td>10.0</td>
      <td>130.0</td>
    </tr>
  </tbody>
</table>
</div>



<p>有效使用 groupby() 将使您能够利用数据集做很多真正强大的事情。</p>
<h2 id="Multi-indexes"><a href="#Multi-indexes" class="headerlink" title="Multi-indexes"></a>Multi-indexes</h2><p>在我们迄今为止看到的所有示例中，我们一直在使用单标签索引的DataFrame或Series对象。<br>groupby()略有不同，根据我们运行的操作，它有时会产生所谓的多索引。<br>多索引与常规索引的不同之处在于它具有多个级别。例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">countries_reviewed = reviews.groupby([<span class="string">&#x27;country&#x27;</span>, <span class="string">&#x27;province&#x27;</span>]).description.agg([<span class="built_in">len</span>])</span><br><span class="line">countries_reviewed</span><br><span class="line"><span class="comment"># reviews[&#x27;description&#x27;][0].__len__()</span></span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>len</th>
    </tr>
    <tr>
      <th>country</th>
      <th>province</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Argentina</th>
      <th>Mendoza Province</th>
      <td>3264</td>
    </tr>
    <tr>
      <th>Other</th>
      <td>536</td>
    </tr>
    <tr>
      <th>Armenia</th>
      <th>Armenia</th>
      <td>2</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Australia</th>
      <th>Australia Other</th>
      <td>245</td>
    </tr>
    <tr>
      <th>New South Wales</th>
      <td>85</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">Uruguay</th>
      <th>Juanico</th>
      <td>12</td>
    </tr>
    <tr>
      <th>Montevideo</th>
      <td>11</td>
    </tr>
    <tr>
      <th>Progreso</th>
      <td>11</td>
    </tr>
    <tr>
      <th>San Jose</th>
      <td>3</td>
    </tr>
    <tr>
      <th>Uruguay</th>
      <td>24</td>
    </tr>
  </tbody>
</table>
<p>425 rows × 1 columns</p>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mi = countries_reviewed.index</span><br><span class="line"><span class="built_in">type</span>(mi)</span><br></pre></td></tr></table></figure>




<pre><code>pandas.core.indexes.multi.MultiIndex
</code></pre>
<p>多级索引有几种处理分层结构的方法，而单级索引则没有这些方法。它们还需要两层标签来获取一个值。对于刚接触pandas的用户来说，处理多索引输出是一个常见的 “疑难杂症”。</p>
<p>在pandas文档的MultiIndex&#x2F;Advanced Selection部分详细介绍了多索引的用例和使用说明。</p>
<p>然而，一般来说，你最常使用的多索引方法是转换回普通索引的reset_index()方法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">countries_reviewed.reset_index()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>province</th>
      <th>len</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Argentina</td>
      <td>Mendoza Province</td>
      <td>3264</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Argentina</td>
      <td>Other</td>
      <td>536</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Armenia</td>
      <td>Armenia</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Australia</td>
      <td>Australia Other</td>
      <td>245</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Australia</td>
      <td>New South Wales</td>
      <td>85</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>420</th>
      <td>Uruguay</td>
      <td>Juanico</td>
      <td>12</td>
    </tr>
    <tr>
      <th>421</th>
      <td>Uruguay</td>
      <td>Montevideo</td>
      <td>11</td>
    </tr>
    <tr>
      <th>422</th>
      <td>Uruguay</td>
      <td>Progreso</td>
      <td>11</td>
    </tr>
    <tr>
      <th>423</th>
      <td>Uruguay</td>
      <td>San Jose</td>
      <td>3</td>
    </tr>
    <tr>
      <th>424</th>
      <td>Uruguay</td>
      <td>Uruguay</td>
      <td>24</td>
    </tr>
  </tbody>
</table>
<p>425 rows × 3 columns</p>
</div>



<h2 id="Sorting"><a href="#Sorting" class="headerlink" title="Sorting"></a>Sorting</h2><p>再次查看 countries_reviewed，我们可以看到分组返回的数据是按照索引顺序而不是值的顺序排列的。也就是说，在输出分组结果时，行的顺序取决于索引中的值，而不是数据中的值。</p>
<p>为了按照我们想要的顺序获得数据，我们可以自己对数据进行排序。sort_values()方法在这方面非常方便。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">countries_reviewed = countries_reviewed.reset_index()</span><br><span class="line">countries_reviewed.sort_values(by=<span class="string">&#x27;len&#x27;</span>)</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>province</th>
      <th>len</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>179</th>
      <td>Greece</td>
      <td>Muscat of Kefallonian</td>
      <td>1</td>
    </tr>
    <tr>
      <th>192</th>
      <td>Greece</td>
      <td>Sterea Ellada</td>
      <td>1</td>
    </tr>
    <tr>
      <th>194</th>
      <td>Greece</td>
      <td>Thraki</td>
      <td>1</td>
    </tr>
    <tr>
      <th>354</th>
      <td>South Africa</td>
      <td>Paardeberg</td>
      <td>1</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Brazil</td>
      <td>Serra do Sudeste</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>409</th>
      <td>US</td>
      <td>Oregon</td>
      <td>5373</td>
    </tr>
    <tr>
      <th>227</th>
      <td>Italy</td>
      <td>Tuscany</td>
      <td>5897</td>
    </tr>
    <tr>
      <th>118</th>
      <td>France</td>
      <td>Bordeaux</td>
      <td>5941</td>
    </tr>
    <tr>
      <th>415</th>
      <td>US</td>
      <td>Washington</td>
      <td>8639</td>
    </tr>
    <tr>
      <th>392</th>
      <td>US</td>
      <td>California</td>
      <td>36247</td>
    </tr>
  </tbody>
</table>
<p>425 rows × 3 columns</p>
</div>



<p>sort_values() 默认为升序排序，其中最低的值排在前面。然而，大多数时候我们想要降序排序，即数字较大的排在前面。事情是这样的：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">countries_reviewed.sort_values(by=<span class="string">&#x27;len&#x27;</span>, ascending=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>province</th>
      <th>len</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>392</th>
      <td>US</td>
      <td>California</td>
      <td>36247</td>
    </tr>
    <tr>
      <th>415</th>
      <td>US</td>
      <td>Washington</td>
      <td>8639</td>
    </tr>
    <tr>
      <th>118</th>
      <td>France</td>
      <td>Bordeaux</td>
      <td>5941</td>
    </tr>
    <tr>
      <th>227</th>
      <td>Italy</td>
      <td>Tuscany</td>
      <td>5897</td>
    </tr>
    <tr>
      <th>409</th>
      <td>US</td>
      <td>Oregon</td>
      <td>5373</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>101</th>
      <td>Croatia</td>
      <td>Krk</td>
      <td>1</td>
    </tr>
    <tr>
      <th>247</th>
      <td>New Zealand</td>
      <td>Gladstone</td>
      <td>1</td>
    </tr>
    <tr>
      <th>357</th>
      <td>South Africa</td>
      <td>Piekenierskloof</td>
      <td>1</td>
    </tr>
    <tr>
      <th>63</th>
      <td>Chile</td>
      <td>Coelemu</td>
      <td>1</td>
    </tr>
    <tr>
      <th>149</th>
      <td>Greece</td>
      <td>Beotia</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>425 rows × 3 columns</p>
</div>



<p>要按索引值排序，请使用配套方法 sort_index()。此方法具有相同的参数和默认顺序：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">countries_reviewed.sort_index()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>province</th>
      <th>len</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Argentina</td>
      <td>Mendoza Province</td>
      <td>3264</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Argentina</td>
      <td>Other</td>
      <td>536</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Armenia</td>
      <td>Armenia</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Australia</td>
      <td>Australia Other</td>
      <td>245</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Australia</td>
      <td>New South Wales</td>
      <td>85</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>420</th>
      <td>Uruguay</td>
      <td>Juanico</td>
      <td>12</td>
    </tr>
    <tr>
      <th>421</th>
      <td>Uruguay</td>
      <td>Montevideo</td>
      <td>11</td>
    </tr>
    <tr>
      <th>422</th>
      <td>Uruguay</td>
      <td>Progreso</td>
      <td>11</td>
    </tr>
    <tr>
      <th>423</th>
      <td>Uruguay</td>
      <td>San Jose</td>
      <td>3</td>
    </tr>
    <tr>
      <th>424</th>
      <td>Uruguay</td>
      <td>Uruguay</td>
      <td>24</td>
    </tr>
  </tbody>
</table>
<p>425 rows × 3 columns</p>
</div>



<p>最后，要知道您一次可以按多个列进行排序：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">countries_reviewed.sort_values(by=[<span class="string">&#x27;country&#x27;</span>, <span class="string">&#x27;len&#x27;</span>])</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>province</th>
      <th>len</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>Argentina</td>
      <td>Other</td>
      <td>536</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Argentina</td>
      <td>Mendoza Province</td>
      <td>3264</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Armenia</td>
      <td>Armenia</td>
      <td>2</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Australia</td>
      <td>Tasmania</td>
      <td>42</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Australia</td>
      <td>New South Wales</td>
      <td>85</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>421</th>
      <td>Uruguay</td>
      <td>Montevideo</td>
      <td>11</td>
    </tr>
    <tr>
      <th>422</th>
      <td>Uruguay</td>
      <td>Progreso</td>
      <td>11</td>
    </tr>
    <tr>
      <th>420</th>
      <td>Uruguay</td>
      <td>Juanico</td>
      <td>12</td>
    </tr>
    <tr>
      <th>424</th>
      <td>Uruguay</td>
      <td>Uruguay</td>
      <td>24</td>
    </tr>
    <tr>
      <th>419</th>
      <td>Uruguay</td>
      <td>Canelones</td>
      <td>43</td>
    </tr>
  </tbody>
</table>
<p>425 rows × 3 columns</p>
</div>



<h1 id="TEST-2"><a href="#TEST-2" class="headerlink" title="TEST"></a>TEST</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">reviews = pd.read_csv(<span class="string">&#x27;datasets/wine/winemag-data-130k-v2.csv&#x27;</span>)</span><br><span class="line">reviews.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>country</th>
      <th>description</th>
      <th>designation</th>
      <th>points</th>
      <th>price</th>
      <th>province</th>
      <th>region_1</th>
      <th>region_2</th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>title</th>
      <th>variety</th>
      <th>winery</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Italy</td>
      <td>Aromas include tropical fruit, broom, brimston...</td>
      <td>Vulkà Bianco</td>
      <td>87</td>
      <td>NaN</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Etna</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Nicosia 2013 Vulkà Bianco  (Etna)</td>
      <td>White Blend</td>
      <td>Nicosia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Portugal</td>
      <td>This is ripe and fruity, a wine that is smooth...</td>
      <td>Avidagos</td>
      <td>87</td>
      <td>15.0</td>
      <td>Douro</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Quinta dos Avidagos 2011 Avidagos Red (Douro)</td>
      <td>Portuguese Red</td>
      <td>Quinta dos Avidagos</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>US</td>
      <td>Tart and snappy, the flavors of lime flesh and...</td>
      <td>NaN</td>
      <td>87</td>
      <td>14.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Rainstorm 2013 Pinot Gris (Willamette Valley)</td>
      <td>Pinot Gris</td>
      <td>Rainstorm</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>US</td>
      <td>Pineapple rind, lemon pith and orange blossom ...</td>
      <td>Reserve Late Harvest</td>
      <td>87</td>
      <td>13.0</td>
      <td>Michigan</td>
      <td>Lake Michigan Shore</td>
      <td>NaN</td>
      <td>Alexander Peartree</td>
      <td>NaN</td>
      <td>St. Julian 2013 Reserve Late Harvest Riesling ...</td>
      <td>Riesling</td>
      <td>St. Julian</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>US</td>
      <td>Much like the regular bottling from 2012, this...</td>
      <td>Vintner's Reserve Wild Child Block</td>
      <td>87</td>
      <td>65.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Sweet Cheeks 2012 Vintner's Reserve Wild Child...</td>
      <td>Pinot Noir</td>
      <td>Sweet Cheeks</td>
    </tr>
  </tbody>
</table>
</div>



<h2 id="1-1"><a href="#1-1" class="headerlink" title="1."></a>1.</h2><p>Who are the most common wine reviewers in the dataset? Create a <code>Series</code> whose index is the <code>taster_twitter_handle</code> category from the dataset, and whose values count how many reviews each person wrote.</p>
<p>数据集中最常见的酒评人是谁？创建一个 “系列”，其索引是数据集中的 “taster_twitter_handle “类别，其值计算每个人写了多少评论。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.groupby(<span class="string">&#x27;taster_twitter_handle&#x27;</span>)[<span class="string">&#x27;taster_twitter_handle&#x27;</span>].count()</span><br></pre></td></tr></table></figure>




<pre><code>taster_twitter_handle
@AnneInVino          3685
@JoeCz               5147
@bkfiona               27
@gordone_cellars     4177
@kerinokeefe        10776
@laurbuzz            1835
@mattkettmann        6332
@paulgwine           9532
@suskostrzewa        1085
@vboone              9537
@vossroger          25514
@wawinereport        4966
@wineschach         15134
@winewchristina         6
@worldwineguys       1005
Name: taster_twitter_handle, dtype: int64
</code></pre>
<h2 id="2-1"><a href="#2-1" class="headerlink" title="2."></a>2.</h2><p>What is the best wine I can buy for a given amount of money? Create a <code>Series</code> whose index is wine prices and whose values is the maximum number of points a wine costing that much was given in a review. Sort the values by price, ascending (so that <code>4.0</code> dollars is at the top and <code>3300.0</code> dollars is at the bottom).</p>
<p>我花多少钱可以买到最好的葡萄酒？创建一个 “系列”，其索引是葡萄酒的价格，其值是该价格的葡萄酒在评论中得到的最高分。按价格升序排序（这样<code>4.0</code>美元在最上面，<code>3300.0</code>美元在最下面）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.groupby(<span class="string">&#x27;price&#x27;</span>)[<span class="string">&#x27;points&#x27;</span>].<span class="built_in">max</span>()</span><br></pre></td></tr></table></figure>




<pre><code>price
4.0       86
5.0       87
6.0       88
7.0       91
8.0       91
          ..
1900.0    98
2000.0    97
2013.0    91
2500.0    96
3300.0    88
Name: points, Length: 390, dtype: int64
</code></pre>
<h2 id="3-1"><a href="#3-1" class="headerlink" title="3."></a>3.</h2><p>What are the minimum and maximum prices for each <code>variety</code> of wine? Create a <code>DataFrame</code> whose index is the <code>variety</code> category from the dataset and whose values are the <code>min</code> and <code>max</code> values thereof.</p>
<p>每种葡萄酒的最低和最高价格是多少？创建一个<code>DataFrame</code>，其索引为数据集中的<code>variety</code>类别，其值为<code>min</code>和<code>max</code>值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">price_extremes = reviews.groupby(<span class="string">&#x27;variety&#x27;</span>)[<span class="string">&#x27;price&#x27;</span>].agg([<span class="built_in">min</span>,<span class="built_in">max</span>])</span><br><span class="line">price_extremes</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min</th>
      <th>max</th>
    </tr>
    <tr>
      <th>variety</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Abouriou</th>
      <td>15.0</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>Agiorgitiko</th>
      <td>10.0</td>
      <td>66.0</td>
    </tr>
    <tr>
      <th>Aglianico</th>
      <td>6.0</td>
      <td>180.0</td>
    </tr>
    <tr>
      <th>Aidani</th>
      <td>27.0</td>
      <td>27.0</td>
    </tr>
    <tr>
      <th>Airen</th>
      <td>8.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Zinfandel</th>
      <td>5.0</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>Zlahtina</th>
      <td>13.0</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>Zweigelt</th>
      <td>9.0</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>Çalkarası</th>
      <td>19.0</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>Žilavka</th>
      <td>15.0</td>
      <td>15.0</td>
    </tr>
  </tbody>
</table>
<p>707 rows × 2 columns</p>
</div>



<h2 id="4-1"><a href="#4-1" class="headerlink" title="4."></a>4.</h2><p>What are the most expensive wine varieties? Create a variable <code>sorted_varieties</code> containing a copy of the dataframe from the previous question where varieties are sorted in descending order based on minimum price, then on maximum price (to break ties).</p>
<p>最贵的葡萄酒品种是什么？创建一个变量<code>sorted_varieties</code>，其中包含上一个问题中数据帧的副本，根据最低价格，然后根据最高价格，按降序排列（打破并列关系）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">price_extremes.sort_values(by=[<span class="string">&#x27;min&#x27;</span>, <span class="string">&#x27;max&#x27;</span>],ascending=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min</th>
      <th>max</th>
    </tr>
    <tr>
      <th>variety</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ramisco</th>
      <td>495.0</td>
      <td>495.0</td>
    </tr>
    <tr>
      <th>Terrantez</th>
      <td>236.0</td>
      <td>236.0</td>
    </tr>
    <tr>
      <th>Francisa</th>
      <td>160.0</td>
      <td>160.0</td>
    </tr>
    <tr>
      <th>Rosenmuskateller</th>
      <td>150.0</td>
      <td>150.0</td>
    </tr>
    <tr>
      <th>Tinta Negra Mole</th>
      <td>112.0</td>
      <td>112.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Roscetto</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Sauvignon Blanc-Sauvignon Gris</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Tempranillo-Malbec</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Vital</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Zelen</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>707 rows × 2 columns</p>
</div>



<h2 id="5"><a href="#5" class="headerlink" title="5."></a>5.</h2><p>Create a <code>Series</code> whose index is reviewers and whose values is the average review score given out by that reviewer. Hint: you will need the <code>taster_name</code> and <code>points</code> columns.</p>
<p>创建一个 “系列”，其索引为reviewers，其值为该reviewer给出的平均review分数。提示：您将需要<code>taster_name</code>和<code>points</code>列。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># reviews.groupby(&#x27;taster_name&#x27;)[&#x27;points&#x27;].agg([&#x27;mean&#x27;])</span></span><br><span class="line">reviewer_mean_ratings = reviews.groupby(<span class="string">&#x27;taster_name&#x27;</span>).apply(<span class="keyword">lambda</span> df: df[<span class="string">&#x27;points&#x27;</span>].mean())</span><br><span class="line">reviewer_mean_ratings</span><br></pre></td></tr></table></figure>




<pre><code>taster_name
Alexander Peartree    85.855422
Anna Lee C. Iijima    88.415629
Anne Krebiehl MW      90.562551
Carrie Dykes          86.395683
Christina Pickard     87.833333
Fiona Adams           86.888889
Jeff Jenssen          88.319756
Jim Gordon            88.626287
Joe Czerwinski        88.536235
Kerin O’Keefe         88.867947
Lauren Buzzeo         87.739510
Matt Kettmann         90.008686
Michael Schachner     86.907493
Mike DeSimone         89.101167
Paul Gregutt          89.082564
Roger Voss            88.708003
Sean P. Sullivan      88.755739
Susan Kostrzewa       86.609217
Virginie Boone        89.213379
dtype: float64
</code></pre>
<p>Are there significant differences in the average scores assigned by the various reviewers? Run the cell below to use the <code>describe()</code> method to see a summary of the range of values.</p>
<p>不同评论人给出的平均分是否存在明显差异？运行下面的单元格，使用 <code>describe()</code>方法查看数值范围的摘要。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviewer_mean_ratings.describe()</span><br></pre></td></tr></table></figure>




<pre><code>count    19.000000
mean     88.233026
std       1.243610
min      85.855422
25%      87.323501
50%      88.536235
75%      88.975256
max      90.562551
dtype: float64
</code></pre>
<h2 id="6"><a href="#6" class="headerlink" title="6."></a>6.</h2><p>What combination of countries and varieties are most common? Create a <code>Series</code> whose index is a <code>MultiIndex</code>of <code>&#123;country, variety&#125;</code> pairs. For example, a pinot noir produced in the US should map to <code>&#123;&quot;US&quot;, &quot;Pinot Noir&quot;&#125;</code>. Sort the values in the <code>Series</code> in descending order based on wine count.</p>
<p>什么国家和品种的组合最常见？创建一个 <code>Series</code>，其索引是<code>&#123;country, variety&#125;</code> 对的 <code>MultiIndex</code>。例如，产自美国的黑比诺应该映射到<code>&#123;&quot;美国&quot;, &quot;黑比诺&quot;&#125;</code>。将 <code>Series</code>中的值按照葡萄酒数量降序排序。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">reviews.groupby([<span class="string">&#x27;country&#x27;</span>, <span class="string">&#x27;variety&#x27;</span>]).size().sort_values(ascending=<span class="literal">False</span>)</span><br><span class="line"><span class="comment"># reviews.head()</span></span><br></pre></td></tr></table></figure>




<pre><code>country  variety                 
US       Pinot Noir                  9885
         Cabernet Sauvignon          7315
         Chardonnay                  6801
France   Bordeaux-style Red Blend    4725
Italy    Red Blend                   3624
                                     ... 
Mexico   Cinsault                       1
         Grenache                       1
         Merlot                         1
         Rosado                         1
Uruguay  White Blend                    1
Length: 1612, dtype: int64
</code></pre>
<h1 id="Data-Types-and-Missing-Values"><a href="#Data-Types-and-Missing-Values" class="headerlink" title="Data Types and Missing Values"></a>Data Types and Missing Values</h1><h2 id="Dtypes"><a href="#Dtypes" class="headerlink" title="Dtypes"></a>Dtypes</h2><p>DataFrame 或 Series 中列的数据类型称为 dtype。 </p>
<p>您可以使用 dtype 属性来获取特定列的类型。例如，我们可以获取评论 DataFrame 中价格列的 dtype：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">reviews = pd.read_csv(<span class="string">&quot;datasets/wine/winemag-data-130k-v2.csv&quot;</span>, index_col=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.price.dtype</span><br></pre></td></tr></table></figure>




<pre><code>dtype(&#39;float64&#39;)
</code></pre>
<p>或者，dtypes 属性返回 DataFrame 中每列的 dtype：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.dtypes</span><br></pre></td></tr></table></figure>




<pre><code>country                   object
description               object
designation               object
points                     int64
price                    float64
province                  object
region_1                  object
region_2                  object
taster_name               object
taster_twitter_handle     object
title                     object
variety                   object
winery                    object
dtype: object
</code></pre>
<p>float64 表示使用 64 位浮点数；int64 表示使用类似大小的整数，以此类推。</p>
<p>需要注意的一个特殊情况是（在这里可以很清楚地看到），完全由字符串组成的列没有自己的类型，而是被赋予了对象类型。</p>
<p>我们可以使用 astype() 函数将一种类型的列转换为另一种类型，只要这种转换是合理的。例如，我们可以将积分列从现有的 int64 数据类型转换为 float64 数据类型：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.points.astype(<span class="string">&#x27;float64&#x27;</span>)</span><br></pre></td></tr></table></figure>




<pre><code>0         87.0
1         87.0
2         87.0
3         87.0
4         87.0
          ... 
129966    90.0
129967    90.0
129968    90.0
129969    90.0
129970    90.0
Name: points, Length: 129971, dtype: float64
</code></pre>
<p>DataFrame 或 Series 索引也有自己的数据类型：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.index.dtype</span><br></pre></td></tr></table></figure>




<pre><code>dtype(&#39;int64&#39;)
</code></pre>
<p>Pandas 还支持更奇特的数据类型，例如分类数据和时间序列数据。</p>
<h2 id="Missing-data"><a href="#Missing-data" class="headerlink" title="Missing data"></a>Missing data</h2><p>缺失值的输入值为 NaN，即 “Not a Number（非数值）”的缩写。由于技术原因，这些 NaN 值始终是 float64 类型。</p>
<p>Pandas 提供了一些专门针对缺失数据的方法。要选择 NaN 条目，可以使用 pd.isnull()（或其同伴 pd.notnull()）。使用方法如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews[pd.isnull(reviews.country)]</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>description</th>
      <th>designation</th>
      <th>points</th>
      <th>price</th>
      <th>province</th>
      <th>region_1</th>
      <th>region_2</th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>title</th>
      <th>variety</th>
      <th>winery</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>913</th>
      <td>NaN</td>
      <td>Amber in color, this wine has aromas of peach ...</td>
      <td>Asureti Valley</td>
      <td>87</td>
      <td>30.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Mike DeSimone</td>
      <td>@worldwineguys</td>
      <td>Gotsa Family Wines 2014 Asureti Valley Chinuri</td>
      <td>Chinuri</td>
      <td>Gotsa Family Wines</td>
    </tr>
    <tr>
      <th>3131</th>
      <td>NaN</td>
      <td>Soft, fruity and juicy, this is a pleasant, si...</td>
      <td>Partager</td>
      <td>83</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Barton &amp; Guestier NV Partager Red</td>
      <td>Red Blend</td>
      <td>Barton &amp; Guestier</td>
    </tr>
    <tr>
      <th>4243</th>
      <td>NaN</td>
      <td>Violet-red in color, this semisweet wine has a...</td>
      <td>Red Naturally Semi-Sweet</td>
      <td>88</td>
      <td>18.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Mike DeSimone</td>
      <td>@worldwineguys</td>
      <td>Kakhetia Traditional Winemaking 2012 Red Natur...</td>
      <td>Ojaleshi</td>
      <td>Kakhetia Traditional Winemaking</td>
    </tr>
    <tr>
      <th>9509</th>
      <td>NaN</td>
      <td>This mouthwatering blend starts with a nose of...</td>
      <td>Theopetra Malagouzia-Assyrtiko</td>
      <td>92</td>
      <td>28.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Susan Kostrzewa</td>
      <td>@suskostrzewa</td>
      <td>Tsililis 2015 Theopetra Malagouzia-Assyrtiko W...</td>
      <td>White Blend</td>
      <td>Tsililis</td>
    </tr>
    <tr>
      <th>9750</th>
      <td>NaN</td>
      <td>This orange-style wine has a cloudy yellow-gol...</td>
      <td>Orange Nikolaevo Vineyard</td>
      <td>89</td>
      <td>28.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Jeff Jenssen</td>
      <td>@worldwineguys</td>
      <td>Ross-idi 2015 Orange Nikolaevo Vineyard Chardo...</td>
      <td>Chardonnay</td>
      <td>Ross-idi</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>124176</th>
      <td>NaN</td>
      <td>This Swiss red blend is composed of four varie...</td>
      <td>Les Romaines</td>
      <td>90</td>
      <td>30.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Jeff Jenssen</td>
      <td>@worldwineguys</td>
      <td>Les Frères Dutruy 2014 Les Romaines Red</td>
      <td>Red Blend</td>
      <td>Les Frères Dutruy</td>
    </tr>
    <tr>
      <th>129407</th>
      <td>NaN</td>
      <td>Dry spicy aromas of dusty plum and tomato add ...</td>
      <td>Reserve</td>
      <td>89</td>
      <td>22.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Michael Schachner</td>
      <td>@wineschach</td>
      <td>El Capricho 2015 Reserve Cabernet Sauvignon</td>
      <td>Cabernet Sauvignon</td>
      <td>El Capricho</td>
    </tr>
    <tr>
      <th>129408</th>
      <td>NaN</td>
      <td>El Capricho is one of Uruguay's more consisten...</td>
      <td>Reserve</td>
      <td>89</td>
      <td>22.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Michael Schachner</td>
      <td>@wineschach</td>
      <td>El Capricho 2015 Reserve Tempranillo</td>
      <td>Tempranillo</td>
      <td>El Capricho</td>
    </tr>
    <tr>
      <th>129590</th>
      <td>NaN</td>
      <td>A blend of 60% Syrah, 30% Cabernet Sauvignon a...</td>
      <td>Shah</td>
      <td>90</td>
      <td>30.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Mike DeSimone</td>
      <td>@worldwineguys</td>
      <td>Büyülübağ 2012 Shah Red</td>
      <td>Red Blend</td>
      <td>Büyülübağ</td>
    </tr>
    <tr>
      <th>129900</th>
      <td>NaN</td>
      <td>This wine offers a delightful bouquet of black...</td>
      <td>NaN</td>
      <td>91</td>
      <td>32.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Mike DeSimone</td>
      <td>@worldwineguys</td>
      <td>Psagot 2014 Merlot</td>
      <td>Merlot</td>
      <td>Psagot</td>
    </tr>
  </tbody>
</table>
<p>63 rows × 13 columns</p>
</div>



<p>替换缺失值是一种常见操作。 Pandas 为这个问题提供了一个非常方便的方法：fillna()。 fillna() 提供了几种不同的策略来减少此类数据。例如，我们可以简单地将每个 NaN 替换为“Unknown”：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.region_2.fillna(<span class="string">&quot;Unknown&quot;</span>)</span><br></pre></td></tr></table></figure>




<pre><code>0                   Unknown
1                   Unknown
2         Willamette Valley
3                   Unknown
4         Willamette Valley
                ...        
129966              Unknown
129967         Oregon Other
129968              Unknown
129969              Unknown
129970              Unknown
Name: region_2, Length: 129971, dtype: object
</code></pre>
<p>或者，我们可以使用数据库中给定记录之后某个时间出现的第一个非空值来填充每个缺失值。这称为回填策略。</p>
<p>或者，我们可能有一个非空值需要替换。例如，假设自本数据集发布以来，评论员 Kerin O’Keefe 已将其 Twitter 手柄从 @kerinokeefe 更改为 @kerino。使用 replace() 方法是在数据集中反映这一情况的方法之一：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.taster_twitter_handle.replace(<span class="string">&quot;@kerinokeefe&quot;</span>, <span class="string">&quot;@kerino&quot;</span>)</span><br></pre></td></tr></table></figure>




<pre><code>0             @kerino
1          @vossroger
2         @paulgwine 
3                 NaN
4         @paulgwine 
             ...     
129966            NaN
129967    @paulgwine 
129968     @vossroger
129969     @vossroger
129970     @vossroger
Name: taster_twitter_handle, Length: 129971, dtype: object
</code></pre>
<p>这里值得一提的是 Replace() 方法，因为它可以方便地替换丢失的数据，这些数据在数据集中被赋予某种哨兵值：诸如“未知”、“未公开”、“无效”等。</p>
<h1 id="TEST-3"><a href="#TEST-3" class="headerlink" title="TEST"></a>TEST</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">reviews = pd.read_csv(<span class="string">&quot;datasets/wine/winemag-data-130k-v2.csv&quot;</span>, index_col=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<p>1.数据集中<code>pionts</code>列的数据类型是什么？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews[<span class="string">&#x27;points&#x27;</span>].dtype</span><br></pre></td></tr></table></figure>




<pre><code>dtype(&#39;int64&#39;)
</code></pre>
<p>2.从<code>points</code>列中的条目创建一个系列，但将条目转换为字符串。提示：字符串在 Python 中是 <code>str</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.points.astype(<span class="string">&#x27;str&#x27;</span>)</span><br></pre></td></tr></table></figure>




<pre><code>0         87
1         87
2         87
3         87
4         87
          ..
129966    90
129967    90
129968    90
129969    90
129970    90
Name: points, Length: 129971, dtype: object
</code></pre>
<p>3.有时价格列为空。数据集中有多少评论缺少价格？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews[<span class="string">&#x27;price&#x27;</span>].isnull().<span class="built_in">sum</span>()</span><br></pre></td></tr></table></figure>




<pre><code>8996
</code></pre>
<p>4.最常见的葡萄酒产区有哪些？创建一个Series，计算 <code>region_1</code> 字段中每个值出现的次数。这个字段经常缺少数据，因此用<code>unknown</code>替换缺少的值。按降序排序。输出结果应如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Unknown                    21247</span><br><span class="line">Napa Valley                 4480</span><br><span class="line">                           ...  </span><br><span class="line">Bardolino Superiore            1</span><br><span class="line">Primitivo del Tarantino        1</span><br><span class="line">Name: region_1, Length: 1230, dtype: int64</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">reviews[<span class="string">&#x27;region_1&#x27;</span>] = reviews[<span class="string">&#x27;region_1&#x27;</span>].fillna(<span class="string">&quot;Unknown&quot;</span>)</span><br><span class="line">reviews[<span class="string">&#x27;region_1&#x27;</span>].value_counts()</span><br></pre></td></tr></table></figure>




<pre><code>region_1
Unknown                    21247
Napa Valley                 4480
Columbia Valley (WA)        4124
Russian River Valley        3091
California                  2629
                           ...  
Lamezia                        1
Trentino Superiore             1
Grave del Friuli               1
Vin Santo di Carmignano        1
Paestum                        1
Name: count, Length: 1230, dtype: int64
</code></pre>
<h1 id="Renaming-and-Combining"><a href="#Renaming-and-Combining" class="headerlink" title="Renaming and Combining"></a>Renaming and Combining</h1><h2 id="Renaming"><a href="#Renaming" class="headerlink" title="Renaming"></a>Renaming</h2><p>我们在这里介绍的第一个函数是 rename()，它允许您更改索引名称和&#x2F;或列名称。例如，要更改数据集中的分数列以进行评分，我们将执行以下操作：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">reviews = pd.read_csv(<span class="string">&quot;datasets/wine/winemag-data-130k-v2.csv&quot;</span>, index_col=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.rename(columns=&#123;<span class="string">&#x27;points&#x27;</span>: <span class="string">&#x27;score&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>description</th>
      <th>designation</th>
      <th>score</th>
      <th>price</th>
      <th>province</th>
      <th>region_1</th>
      <th>region_2</th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>title</th>
      <th>variety</th>
      <th>winery</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Italy</td>
      <td>Aromas include tropical fruit, broom, brimston...</td>
      <td>Vulkà Bianco</td>
      <td>87</td>
      <td>NaN</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Etna</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Nicosia 2013 Vulkà Bianco  (Etna)</td>
      <td>White Blend</td>
      <td>Nicosia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Portugal</td>
      <td>This is ripe and fruity, a wine that is smooth...</td>
      <td>Avidagos</td>
      <td>87</td>
      <td>15.0</td>
      <td>Douro</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Quinta dos Avidagos 2011 Avidagos Red (Douro)</td>
      <td>Portuguese Red</td>
      <td>Quinta dos Avidagos</td>
    </tr>
    <tr>
      <th>2</th>
      <td>US</td>
      <td>Tart and snappy, the flavors of lime flesh and...</td>
      <td>NaN</td>
      <td>87</td>
      <td>14.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Rainstorm 2013 Pinot Gris (Willamette Valley)</td>
      <td>Pinot Gris</td>
      <td>Rainstorm</td>
    </tr>
    <tr>
      <th>3</th>
      <td>US</td>
      <td>Pineapple rind, lemon pith and orange blossom ...</td>
      <td>Reserve Late Harvest</td>
      <td>87</td>
      <td>13.0</td>
      <td>Michigan</td>
      <td>Lake Michigan Shore</td>
      <td>NaN</td>
      <td>Alexander Peartree</td>
      <td>NaN</td>
      <td>St. Julian 2013 Reserve Late Harvest Riesling ...</td>
      <td>Riesling</td>
      <td>St. Julian</td>
    </tr>
    <tr>
      <th>4</th>
      <td>US</td>
      <td>Much like the regular bottling from 2012, this...</td>
      <td>Vintner's Reserve Wild Child Block</td>
      <td>87</td>
      <td>65.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Sweet Cheeks 2012 Vintner's Reserve Wild Child...</td>
      <td>Pinot Noir</td>
      <td>Sweet Cheeks</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>129966</th>
      <td>Germany</td>
      <td>Notes of honeysuckle and cantaloupe sweeten th...</td>
      <td>Brauneberger Juffer-Sonnenuhr Spätlese</td>
      <td>90</td>
      <td>28.0</td>
      <td>Mosel</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Anna Lee C. Iijima</td>
      <td>NaN</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef) 2013 ...</td>
      <td>Riesling</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef)</td>
    </tr>
    <tr>
      <th>129967</th>
      <td>US</td>
      <td>Citation is given as much as a decade of bottl...</td>
      <td>NaN</td>
      <td>90</td>
      <td>75.0</td>
      <td>Oregon</td>
      <td>Oregon</td>
      <td>Oregon Other</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Citation 2004 Pinot Noir (Oregon)</td>
      <td>Pinot Noir</td>
      <td>Citation</td>
    </tr>
    <tr>
      <th>129968</th>
      <td>France</td>
      <td>Well-drained gravel soil gives this wine its c...</td>
      <td>Kritt</td>
      <td>90</td>
      <td>30.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Gresser 2013 Kritt Gewurztraminer (Als...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Gresser</td>
    </tr>
    <tr>
      <th>129969</th>
      <td>France</td>
      <td>A dry style of Pinot Gris, this is crisp with ...</td>
      <td>NaN</td>
      <td>90</td>
      <td>32.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Marcel Deiss 2012 Pinot Gris (Alsace)</td>
      <td>Pinot Gris</td>
      <td>Domaine Marcel Deiss</td>
    </tr>
    <tr>
      <th>129970</th>
      <td>France</td>
      <td>Big, rich and off-dry, this is powered by inte...</td>
      <td>Lieu-dit Harth Cuvée Caroline</td>
      <td>90</td>
      <td>21.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Schoffit 2012 Lieu-dit Harth Cuvée Car...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Schoffit</td>
    </tr>
  </tbody>
</table>
<p>129971 rows × 13 columns</p>
</div>



<p><code>rename()</code>可以让你通过分别指定索引或列关键字参数来重命名索引或列值。它支持多种输入格式，但通常 Python 字典是最方便的。下面是一个使用它重命名索引中某些元素的示例。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.rename(index=&#123;<span class="number">0</span>: <span class="string">&#x27;firstEntry&#x27;</span>, <span class="number">1</span>: <span class="string">&#x27;secondEntry&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>description</th>
      <th>designation</th>
      <th>points</th>
      <th>price</th>
      <th>province</th>
      <th>region_1</th>
      <th>region_2</th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>title</th>
      <th>variety</th>
      <th>winery</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>firstEntry</th>
      <td>Italy</td>
      <td>Aromas include tropical fruit, broom, brimston...</td>
      <td>Vulkà Bianco</td>
      <td>87</td>
      <td>NaN</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Etna</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Nicosia 2013 Vulkà Bianco  (Etna)</td>
      <td>White Blend</td>
      <td>Nicosia</td>
    </tr>
    <tr>
      <th>secondEntry</th>
      <td>Portugal</td>
      <td>This is ripe and fruity, a wine that is smooth...</td>
      <td>Avidagos</td>
      <td>87</td>
      <td>15.0</td>
      <td>Douro</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Quinta dos Avidagos 2011 Avidagos Red (Douro)</td>
      <td>Portuguese Red</td>
      <td>Quinta dos Avidagos</td>
    </tr>
    <tr>
      <th>2</th>
      <td>US</td>
      <td>Tart and snappy, the flavors of lime flesh and...</td>
      <td>NaN</td>
      <td>87</td>
      <td>14.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Rainstorm 2013 Pinot Gris (Willamette Valley)</td>
      <td>Pinot Gris</td>
      <td>Rainstorm</td>
    </tr>
    <tr>
      <th>3</th>
      <td>US</td>
      <td>Pineapple rind, lemon pith and orange blossom ...</td>
      <td>Reserve Late Harvest</td>
      <td>87</td>
      <td>13.0</td>
      <td>Michigan</td>
      <td>Lake Michigan Shore</td>
      <td>NaN</td>
      <td>Alexander Peartree</td>
      <td>NaN</td>
      <td>St. Julian 2013 Reserve Late Harvest Riesling ...</td>
      <td>Riesling</td>
      <td>St. Julian</td>
    </tr>
    <tr>
      <th>4</th>
      <td>US</td>
      <td>Much like the regular bottling from 2012, this...</td>
      <td>Vintner's Reserve Wild Child Block</td>
      <td>87</td>
      <td>65.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Sweet Cheeks 2012 Vintner's Reserve Wild Child...</td>
      <td>Pinot Noir</td>
      <td>Sweet Cheeks</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>129966</th>
      <td>Germany</td>
      <td>Notes of honeysuckle and cantaloupe sweeten th...</td>
      <td>Brauneberger Juffer-Sonnenuhr Spätlese</td>
      <td>90</td>
      <td>28.0</td>
      <td>Mosel</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Anna Lee C. Iijima</td>
      <td>NaN</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef) 2013 ...</td>
      <td>Riesling</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef)</td>
    </tr>
    <tr>
      <th>129967</th>
      <td>US</td>
      <td>Citation is given as much as a decade of bottl...</td>
      <td>NaN</td>
      <td>90</td>
      <td>75.0</td>
      <td>Oregon</td>
      <td>Oregon</td>
      <td>Oregon Other</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Citation 2004 Pinot Noir (Oregon)</td>
      <td>Pinot Noir</td>
      <td>Citation</td>
    </tr>
    <tr>
      <th>129968</th>
      <td>France</td>
      <td>Well-drained gravel soil gives this wine its c...</td>
      <td>Kritt</td>
      <td>90</td>
      <td>30.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Gresser 2013 Kritt Gewurztraminer (Als...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Gresser</td>
    </tr>
    <tr>
      <th>129969</th>
      <td>France</td>
      <td>A dry style of Pinot Gris, this is crisp with ...</td>
      <td>NaN</td>
      <td>90</td>
      <td>32.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Marcel Deiss 2012 Pinot Gris (Alsace)</td>
      <td>Pinot Gris</td>
      <td>Domaine Marcel Deiss</td>
    </tr>
    <tr>
      <th>129970</th>
      <td>France</td>
      <td>Big, rich and off-dry, this is powered by inte...</td>
      <td>Lieu-dit Harth Cuvée Caroline</td>
      <td>90</td>
      <td>21.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Schoffit 2012 Lieu-dit Harth Cuvée Car...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Schoffit</td>
    </tr>
  </tbody>
</table>
<p>129971 rows × 13 columns</p>
</div>



<p>你可能会经常重命名列，但很少重命名索引值。为此，set_index() 通常更方便。</p>
<p>行索引和列索引都可以有自己的名称属性。可以使用赠送的 rename_axis() 方法来更改这些名称。例如</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.rename_axis(<span class="string">&quot;wines&quot;</span>, axis=<span class="string">&#x27;rows&#x27;</span>).rename_axis(<span class="string">&quot;fields&quot;</span>, axis=<span class="string">&#x27;columns&#x27;</span>)</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>fields</th>
      <th>country</th>
      <th>description</th>
      <th>designation</th>
      <th>points</th>
      <th>price</th>
      <th>province</th>
      <th>region_1</th>
      <th>region_2</th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>title</th>
      <th>variety</th>
      <th>winery</th>
    </tr>
    <tr>
      <th>wines</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Italy</td>
      <td>Aromas include tropical fruit, broom, brimston...</td>
      <td>Vulkà Bianco</td>
      <td>87</td>
      <td>NaN</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Etna</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Nicosia 2013 Vulkà Bianco  (Etna)</td>
      <td>White Blend</td>
      <td>Nicosia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Portugal</td>
      <td>This is ripe and fruity, a wine that is smooth...</td>
      <td>Avidagos</td>
      <td>87</td>
      <td>15.0</td>
      <td>Douro</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Quinta dos Avidagos 2011 Avidagos Red (Douro)</td>
      <td>Portuguese Red</td>
      <td>Quinta dos Avidagos</td>
    </tr>
    <tr>
      <th>2</th>
      <td>US</td>
      <td>Tart and snappy, the flavors of lime flesh and...</td>
      <td>NaN</td>
      <td>87</td>
      <td>14.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Rainstorm 2013 Pinot Gris (Willamette Valley)</td>
      <td>Pinot Gris</td>
      <td>Rainstorm</td>
    </tr>
    <tr>
      <th>3</th>
      <td>US</td>
      <td>Pineapple rind, lemon pith and orange blossom ...</td>
      <td>Reserve Late Harvest</td>
      <td>87</td>
      <td>13.0</td>
      <td>Michigan</td>
      <td>Lake Michigan Shore</td>
      <td>NaN</td>
      <td>Alexander Peartree</td>
      <td>NaN</td>
      <td>St. Julian 2013 Reserve Late Harvest Riesling ...</td>
      <td>Riesling</td>
      <td>St. Julian</td>
    </tr>
    <tr>
      <th>4</th>
      <td>US</td>
      <td>Much like the regular bottling from 2012, this...</td>
      <td>Vintner's Reserve Wild Child Block</td>
      <td>87</td>
      <td>65.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Sweet Cheeks 2012 Vintner's Reserve Wild Child...</td>
      <td>Pinot Noir</td>
      <td>Sweet Cheeks</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>129966</th>
      <td>Germany</td>
      <td>Notes of honeysuckle and cantaloupe sweeten th...</td>
      <td>Brauneberger Juffer-Sonnenuhr Spätlese</td>
      <td>90</td>
      <td>28.0</td>
      <td>Mosel</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Anna Lee C. Iijima</td>
      <td>NaN</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef) 2013 ...</td>
      <td>Riesling</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef)</td>
    </tr>
    <tr>
      <th>129967</th>
      <td>US</td>
      <td>Citation is given as much as a decade of bottl...</td>
      <td>NaN</td>
      <td>90</td>
      <td>75.0</td>
      <td>Oregon</td>
      <td>Oregon</td>
      <td>Oregon Other</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Citation 2004 Pinot Noir (Oregon)</td>
      <td>Pinot Noir</td>
      <td>Citation</td>
    </tr>
    <tr>
      <th>129968</th>
      <td>France</td>
      <td>Well-drained gravel soil gives this wine its c...</td>
      <td>Kritt</td>
      <td>90</td>
      <td>30.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Gresser 2013 Kritt Gewurztraminer (Als...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Gresser</td>
    </tr>
    <tr>
      <th>129969</th>
      <td>France</td>
      <td>A dry style of Pinot Gris, this is crisp with ...</td>
      <td>NaN</td>
      <td>90</td>
      <td>32.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Marcel Deiss 2012 Pinot Gris (Alsace)</td>
      <td>Pinot Gris</td>
      <td>Domaine Marcel Deiss</td>
    </tr>
    <tr>
      <th>129970</th>
      <td>France</td>
      <td>Big, rich and off-dry, this is powered by inte...</td>
      <td>Lieu-dit Harth Cuvée Caroline</td>
      <td>90</td>
      <td>21.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Schoffit 2012 Lieu-dit Harth Cuvée Car...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Schoffit</td>
    </tr>
  </tbody>
</table>
<p>129971 rows × 13 columns</p>
</div>



<h2 id="Combining"><a href="#Combining" class="headerlink" title="Combining"></a>Combining</h2><p>在对数据集执行操作时，我们有时需要将不同的 DataFrames 和&#x2F;或 Series 以非同寻常的方式组合起来。Pandas 有三种核心方法可以实现这一目的。按照复杂程度递增的顺序，它们是 <code>concat()</code>、<code>join()</code> 和 <code>merge()</code>。<code>merge()</code> 的大部分功能也可以通过 <code>join()</code> 更简单地实现。</p>
<p>最简单的合并方法是 <code>concat()</code>。如果给定一个元素列表，该函数会将这些元素沿着一个轴挤在一起。</p>
<p>当我们在不同的 DataFrame 或 Series 对象中拥有相同字段（列）的数据时，这种方法非常有用。例如：YouTube 视频数据集根据来源国（例如本例中的加拿大和英国）对数据进行了分割。如果我们想同时研究多个国家，可以使用 <code>concat()</code> 将它们合并在一起：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">canadian_youtube = pd.read_csv(<span class="string">&quot;datasets/Trending_YouTube_Video_Statistics/CAvideos.csv&quot;</span>)</span><br><span class="line">british_youtube = pd.read_csv(<span class="string">&quot;datasets/Trending_YouTube_Video_Statistics/GBvideos.csv&quot;</span>)</span><br><span class="line"></span><br><span class="line">pd.concat([canadian_youtube,british_youtube])</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>video_id</th>
      <th>trending_date</th>
      <th>title</th>
      <th>channel_title</th>
      <th>category_id</th>
      <th>publish_time</th>
      <th>tags</th>
      <th>views</th>
      <th>likes</th>
      <th>dislikes</th>
      <th>comment_count</th>
      <th>thumbnail_link</th>
      <th>comments_disabled</th>
      <th>ratings_disabled</th>
      <th>video_error_or_removed</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>n1WpP7iowLc</td>
      <td>17.14.11</td>
      <td>Eminem - Walk On Water (Audio) ft. Beyoncé</td>
      <td>EminemVEVO</td>
      <td>10</td>
      <td>2017-11-10T17:00:03.000Z</td>
      <td>Eminem|"Walk"|"On"|"Water"|"Aftermath/Shady/In...</td>
      <td>17158579</td>
      <td>787425</td>
      <td>43420</td>
      <td>125882</td>
      <td>https://i.ytimg.com/vi/n1WpP7iowLc/default.jpg</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>Eminem's new track Walk on Water ft. Beyoncé i...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0dBIkQ4Mz1M</td>
      <td>17.14.11</td>
      <td>PLUSH - Bad Unboxing Fan Mail</td>
      <td>iDubbbzTV</td>
      <td>23</td>
      <td>2017-11-13T17:00:00.000Z</td>
      <td>plush|"bad unboxing"|"unboxing"|"fan mail"|"id...</td>
      <td>1014651</td>
      <td>127794</td>
      <td>1688</td>
      <td>13030</td>
      <td>https://i.ytimg.com/vi/0dBIkQ4Mz1M/default.jpg</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>STill got a lot of packages. Probably will las...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5qpjK5DgCt4</td>
      <td>17.14.11</td>
      <td>Racist Superman | Rudy Mancuso, King Bach &amp; Le...</td>
      <td>Rudy Mancuso</td>
      <td>23</td>
      <td>2017-11-12T19:05:24.000Z</td>
      <td>racist superman|"rudy"|"mancuso"|"king"|"bach"...</td>
      <td>3191434</td>
      <td>146035</td>
      <td>5339</td>
      <td>8181</td>
      <td>https://i.ytimg.com/vi/5qpjK5DgCt4/default.jpg</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>WATCH MY PREVIOUS VIDEO ▶ \n\nSUBSCRIBE ► http...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>d380meD0W0M</td>
      <td>17.14.11</td>
      <td>I Dare You: GOING BALD!?</td>
      <td>nigahiga</td>
      <td>24</td>
      <td>2017-11-12T18:01:41.000Z</td>
      <td>ryan|"higa"|"higatv"|"nigahiga"|"i dare you"|"...</td>
      <td>2095828</td>
      <td>132239</td>
      <td>1989</td>
      <td>17518</td>
      <td>https://i.ytimg.com/vi/d380meD0W0M/default.jpg</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>I know it's been a while since we did this sho...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2Vv-BfVoq4g</td>
      <td>17.14.11</td>
      <td>Ed Sheeran - Perfect (Official Music Video)</td>
      <td>Ed Sheeran</td>
      <td>10</td>
      <td>2017-11-09T11:04:14.000Z</td>
      <td>edsheeran|"ed sheeran"|"acoustic"|"live"|"cove...</td>
      <td>33523622</td>
      <td>1634130</td>
      <td>21082</td>
      <td>85067</td>
      <td>https://i.ytimg.com/vi/2Vv-BfVoq4g/default.jpg</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>🎧: https://ad.gt/yt-perfect\n💰: https://atlant...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>38911</th>
      <td>l884wKofd54</td>
      <td>18.14.06</td>
      <td>Enrique Iglesias - MOVE TO MIAMI (Official Vid...</td>
      <td>EnriqueIglesiasVEVO</td>
      <td>10</td>
      <td>2018-05-09T07:00:01.000Z</td>
      <td>Enrique Iglesias feat. Pitbull|"MOVE TO MIAMI"...</td>
      <td>25066952</td>
      <td>268088</td>
      <td>12783</td>
      <td>9933</td>
      <td>https://i.ytimg.com/vi/l884wKofd54/default.jpg</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>NEW SONG - MOVE TO MIAMI feat. Pitbull (Click ...</td>
    </tr>
    <tr>
      <th>38912</th>
      <td>IP8k2xkhOdI</td>
      <td>18.14.06</td>
      <td>Jacob Sartorius - Up With It (Official Music V...</td>
      <td>Jacob Sartorius</td>
      <td>10</td>
      <td>2018-05-11T17:09:16.000Z</td>
      <td>jacob sartorius|"jacob"|"up with it"|"jacob sa...</td>
      <td>1492219</td>
      <td>61998</td>
      <td>13781</td>
      <td>24330</td>
      <td>https://i.ytimg.com/vi/IP8k2xkhOdI/default.jpg</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>THE OFFICIAL UP WITH IT MUSIC VIDEO!Get my new...</td>
    </tr>
    <tr>
      <th>38913</th>
      <td>Il-an3K9pjg</td>
      <td>18.14.06</td>
      <td>Anne-Marie - 2002 [Official Video]</td>
      <td>Anne-Marie</td>
      <td>10</td>
      <td>2018-05-08T11:05:08.000Z</td>
      <td>anne|"marie"|"anne-marie"|"2002"|"two thousand...</td>
      <td>29641412</td>
      <td>394830</td>
      <td>8892</td>
      <td>19988</td>
      <td>https://i.ytimg.com/vi/Il-an3K9pjg/default.jpg</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>Get 2002 by Anne-Marie HERE ▶ http://ad.gt/200...</td>
    </tr>
    <tr>
      <th>38914</th>
      <td>-DRsfNObKIQ</td>
      <td>18.14.06</td>
      <td>Eleni Foureira - Fuego - Cyprus - LIVE - First...</td>
      <td>Eurovision Song Contest</td>
      <td>24</td>
      <td>2018-05-08T20:32:32.000Z</td>
      <td>Eurovision Song Contest|"2018"|"Lisbon"|"Cypru...</td>
      <td>14317515</td>
      <td>151870</td>
      <td>45875</td>
      <td>26766</td>
      <td>https://i.ytimg.com/vi/-DRsfNObKIQ/default.jpg</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>Eleni Foureira represented Cyprus at the first...</td>
    </tr>
    <tr>
      <th>38915</th>
      <td>4YFo4bdMO8Q</td>
      <td>18.14.06</td>
      <td>KYLE - Ikuyo feat.  2 Chainz &amp; Sophia Black [A...</td>
      <td>SuperDuperKyle</td>
      <td>10</td>
      <td>2018-05-11T04:06:35.000Z</td>
      <td>Kyle|"SuperDuperKyle"|"Ikuyo"|"2 Chainz"|"Soph...</td>
      <td>607552</td>
      <td>18271</td>
      <td>274</td>
      <td>1423</td>
      <td>https://i.ytimg.com/vi/4YFo4bdMO8Q/default.jpg</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>Debut album 'Light of Mine' out now: http://ky...</td>
    </tr>
  </tbody>
</table>
<p>79797 rows × 16 columns</p>
</div>



<p><code>join()</code>可让您组合具有共同索引的不同 DataFrame 对象。例如，要提取加拿大和英国同一天流行的视频，我们可以执行以下操作：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">left = canadian_youtube.set_index([<span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;trending_date&#x27;</span>])</span><br><span class="line">right = british_youtube.set_index([<span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;trending_date&#x27;</span>])</span><br><span class="line"></span><br><span class="line">left.join(right, lsuffix=<span class="string">&#x27;_CAN&#x27;</span>, rsuffix=<span class="string">&#x27;_UK&#x27;</span>)</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>video_id_CAN</th>
      <th>channel_title_CAN</th>
      <th>category_id_CAN</th>
      <th>publish_time_CAN</th>
      <th>tags_CAN</th>
      <th>views_CAN</th>
      <th>likes_CAN</th>
      <th>dislikes_CAN</th>
      <th>comment_count_CAN</th>
      <th>thumbnail_link_CAN</th>
      <th>...</th>
      <th>tags_UK</th>
      <th>views_UK</th>
      <th>likes_UK</th>
      <th>dislikes_UK</th>
      <th>comment_count_UK</th>
      <th>thumbnail_link_UK</th>
      <th>comments_disabled_UK</th>
      <th>ratings_disabled_UK</th>
      <th>video_error_or_removed_UK</th>
      <th>description_UK</th>
    </tr>
    <tr>
      <th>title</th>
      <th>trending_date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>!! THIS VIDEO IS NOTHING BUT PAIN !! | Getting Over It - Part 7</th>
      <th>18.04.01</th>
      <td>PNn8sECd7io</td>
      <td>Markiplier</td>
      <td>20</td>
      <td>2018-01-03T19:33:53.000Z</td>
      <td>getting over it|"markiplier"|"funny moments"|"...</td>
      <td>835930</td>
      <td>47058</td>
      <td>1023</td>
      <td>8250</td>
      <td>https://i.ytimg.com/vi/PNn8sECd7io/default.jpg</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>#1 Fortnite World Rank - 2,323 Solo Wins!</th>
      <th>18.09.03</th>
      <td>DvPW66IFhMI</td>
      <td>AlexRamiGaming</td>
      <td>20</td>
      <td>2018-03-09T07:15:52.000Z</td>
      <td>PS4 Battle Royale|"PS4 Pro Battle Royale"|"Bat...</td>
      <td>212838</td>
      <td>5199</td>
      <td>542</td>
      <td>11</td>
      <td>https://i.ytimg.com/vi/DvPW66IFhMI/default.jpg</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>#1 Fortnite World Rank - 2,330 Solo Wins!</th>
      <th>18.10.03</th>
      <td>EXEaMjFeiEk</td>
      <td>AlexRamiGaming</td>
      <td>20</td>
      <td>2018-03-10T06:26:17.000Z</td>
      <td>PS4 Battle Royale|"PS4 Pro Battle Royale"|"Bat...</td>
      <td>200764</td>
      <td>5620</td>
      <td>537</td>
      <td>45</td>
      <td>https://i.ytimg.com/vi/EXEaMjFeiEk/default.jpg</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">#1 MOST ANTICIPATED VIDEO (Timber Frame House Raising)</th>
      <th>17.20.12</th>
      <td>bYvQmusLaxw</td>
      <td>Pure Living for Life</td>
      <td>24</td>
      <td>2017-12-20T02:49:11.000Z</td>
      <td>timber frame|"timber framing"|"timber frame ra...</td>
      <td>79152</td>
      <td>7761</td>
      <td>159</td>
      <td>1965</td>
      <td>https://i.ytimg.com/vi/bYvQmusLaxw/default.jpg</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17.21.12</th>
      <td>bYvQmusLaxw</td>
      <td>Pure Living for Life</td>
      <td>24</td>
      <td>2017-12-20T02:49:11.000Z</td>
      <td>timber frame|"timber framing"|"timber frame ra...</td>
      <td>232762</td>
      <td>15515</td>
      <td>329</td>
      <td>3601</td>
      <td>https://i.ytimg.com/vi/bYvQmusLaxw/default.jpg</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">😲She Is So Nervous But BLOWS The ROOF After Taking on OPERA Song! | Britain´s Got Talent 2018</th>
      <th>18.02.05</th>
      <td>WttN1Z0XF4k</td>
      <td>How Talented</td>
      <td>24</td>
      <td>2018-04-28T19:40:58.000Z</td>
      <td>bgt|"bgt 2018"|"britain got talent"|"britain´s...</td>
      <td>713400</td>
      <td>4684</td>
      <td>260</td>
      <td>266</td>
      <td>https://i.ytimg.com/vi/WttN1Z0XF4k/default.jpg</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>18.29.04</th>
      <td>WttN1Z0XF4k</td>
      <td>How Talented</td>
      <td>24</td>
      <td>2018-04-28T19:40:58.000Z</td>
      <td>bgt|"bgt 2018"|"britain got talent"|"britain´s...</td>
      <td>231906</td>
      <td>1924</td>
      <td>78</td>
      <td>146</td>
      <td>https://i.ytimg.com/vi/WttN1Z0XF4k/default.jpg</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>18.30.04</th>
      <td>WttN1Z0XF4k</td>
      <td>How Talented</td>
      <td>24</td>
      <td>2018-04-28T19:40:58.000Z</td>
      <td>bgt|"bgt 2018"|"britain got talent"|"britain´s...</td>
      <td>476253</td>
      <td>3417</td>
      <td>176</td>
      <td>240</td>
      <td>https://i.ytimg.com/vi/WttN1Z0XF4k/default.jpg</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>🚨 BREAKING NEWS 🔴 Raja Live all Slot Channels Welcome 🎰</th>
      <th>18.07.05</th>
      <td>Wt9Gkpmbt44</td>
      <td>TheBigJackpot</td>
      <td>24</td>
      <td>2018-05-07T06:58:59.000Z</td>
      <td>Slot Machine|"win"|"Gambling"|"Big Win"|"raja"...</td>
      <td>28973</td>
      <td>2167</td>
      <td>175</td>
      <td>10</td>
      <td>https://i.ytimg.com/vi/Wt9Gkpmbt44/default.jpg</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>🚨Active Shooter at YouTube Headquarters - LIVE BREAKING NEWS COVERAGE</th>
      <th>18.04.04</th>
      <td>Az72jrKbANA</td>
      <td>Right Side Broadcasting Network</td>
      <td>25</td>
      <td>2018-04-03T23:12:37.000Z</td>
      <td>YouTube shooter|"YouTube active shooter"|"acti...</td>
      <td>103513</td>
      <td>1722</td>
      <td>181</td>
      <td>76</td>
      <td>https://i.ytimg.com/vi/Az72jrKbANA/default.jpg</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>40900 rows × 28 columns</p>
</div>



<p>此处 <code>lsuffix</code> 和 <code>rsuffix</code> 参数是必需的，因为数据在英国和加拿大数据集中具有相同的列名称。如果这不是真的（因为，比如说，我们事先重命名了它们），我们就不需要它们。</p>
<h1 id="TEST-4"><a href="#TEST-4" class="headerlink" title="TEST"></a>TEST</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">reviews = pd.read_csv(<span class="string">&quot;datasets/wine/winemag-data-130k-v2.csv&quot;</span>, index_col=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>description</th>
      <th>designation</th>
      <th>points</th>
      <th>price</th>
      <th>province</th>
      <th>region_1</th>
      <th>region_2</th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>title</th>
      <th>variety</th>
      <th>winery</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Italy</td>
      <td>Aromas include tropical fruit, broom, brimston...</td>
      <td>Vulkà Bianco</td>
      <td>87</td>
      <td>NaN</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Etna</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Nicosia 2013 Vulkà Bianco  (Etna)</td>
      <td>White Blend</td>
      <td>Nicosia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Portugal</td>
      <td>This is ripe and fruity, a wine that is smooth...</td>
      <td>Avidagos</td>
      <td>87</td>
      <td>15.0</td>
      <td>Douro</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Quinta dos Avidagos 2011 Avidagos Red (Douro)</td>
      <td>Portuguese Red</td>
      <td>Quinta dos Avidagos</td>
    </tr>
    <tr>
      <th>2</th>
      <td>US</td>
      <td>Tart and snappy, the flavors of lime flesh and...</td>
      <td>NaN</td>
      <td>87</td>
      <td>14.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Rainstorm 2013 Pinot Gris (Willamette Valley)</td>
      <td>Pinot Gris</td>
      <td>Rainstorm</td>
    </tr>
    <tr>
      <th>3</th>
      <td>US</td>
      <td>Pineapple rind, lemon pith and orange blossom ...</td>
      <td>Reserve Late Harvest</td>
      <td>87</td>
      <td>13.0</td>
      <td>Michigan</td>
      <td>Lake Michigan Shore</td>
      <td>NaN</td>
      <td>Alexander Peartree</td>
      <td>NaN</td>
      <td>St. Julian 2013 Reserve Late Harvest Riesling ...</td>
      <td>Riesling</td>
      <td>St. Julian</td>
    </tr>
    <tr>
      <th>4</th>
      <td>US</td>
      <td>Much like the regular bottling from 2012, this...</td>
      <td>Vintner's Reserve Wild Child Block</td>
      <td>87</td>
      <td>65.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Sweet Cheeks 2012 Vintner's Reserve Wild Child...</td>
      <td>Pinot Noir</td>
      <td>Sweet Cheeks</td>
    </tr>
  </tbody>
</table>
</div>



<p>1.<code>Region_1</code> 和 <code>Region_2</code> 是数据集中区域设置列的非常无信息的名称。创建<code>reviews</code>副本，并将这些列分别重命名为<code>region</code>和<code>locale</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.rename(columns=&#123;<span class="string">&#x27;region_1&#x27;</span>: <span class="string">&#x27;region&#x27;</span>,<span class="string">&#x27;region_2&#x27;</span>:<span class="string">&#x27;locale&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>description</th>
      <th>designation</th>
      <th>points</th>
      <th>price</th>
      <th>province</th>
      <th>region</th>
      <th>locale</th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>title</th>
      <th>variety</th>
      <th>winery</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Italy</td>
      <td>Aromas include tropical fruit, broom, brimston...</td>
      <td>Vulkà Bianco</td>
      <td>87</td>
      <td>NaN</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Etna</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Nicosia 2013 Vulkà Bianco  (Etna)</td>
      <td>White Blend</td>
      <td>Nicosia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Portugal</td>
      <td>This is ripe and fruity, a wine that is smooth...</td>
      <td>Avidagos</td>
      <td>87</td>
      <td>15.0</td>
      <td>Douro</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Quinta dos Avidagos 2011 Avidagos Red (Douro)</td>
      <td>Portuguese Red</td>
      <td>Quinta dos Avidagos</td>
    </tr>
    <tr>
      <th>2</th>
      <td>US</td>
      <td>Tart and snappy, the flavors of lime flesh and...</td>
      <td>NaN</td>
      <td>87</td>
      <td>14.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Rainstorm 2013 Pinot Gris (Willamette Valley)</td>
      <td>Pinot Gris</td>
      <td>Rainstorm</td>
    </tr>
    <tr>
      <th>3</th>
      <td>US</td>
      <td>Pineapple rind, lemon pith and orange blossom ...</td>
      <td>Reserve Late Harvest</td>
      <td>87</td>
      <td>13.0</td>
      <td>Michigan</td>
      <td>Lake Michigan Shore</td>
      <td>NaN</td>
      <td>Alexander Peartree</td>
      <td>NaN</td>
      <td>St. Julian 2013 Reserve Late Harvest Riesling ...</td>
      <td>Riesling</td>
      <td>St. Julian</td>
    </tr>
    <tr>
      <th>4</th>
      <td>US</td>
      <td>Much like the regular bottling from 2012, this...</td>
      <td>Vintner's Reserve Wild Child Block</td>
      <td>87</td>
      <td>65.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Sweet Cheeks 2012 Vintner's Reserve Wild Child...</td>
      <td>Pinot Noir</td>
      <td>Sweet Cheeks</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>129966</th>
      <td>Germany</td>
      <td>Notes of honeysuckle and cantaloupe sweeten th...</td>
      <td>Brauneberger Juffer-Sonnenuhr Spätlese</td>
      <td>90</td>
      <td>28.0</td>
      <td>Mosel</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Anna Lee C. Iijima</td>
      <td>NaN</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef) 2013 ...</td>
      <td>Riesling</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef)</td>
    </tr>
    <tr>
      <th>129967</th>
      <td>US</td>
      <td>Citation is given as much as a decade of bottl...</td>
      <td>NaN</td>
      <td>90</td>
      <td>75.0</td>
      <td>Oregon</td>
      <td>Oregon</td>
      <td>Oregon Other</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Citation 2004 Pinot Noir (Oregon)</td>
      <td>Pinot Noir</td>
      <td>Citation</td>
    </tr>
    <tr>
      <th>129968</th>
      <td>France</td>
      <td>Well-drained gravel soil gives this wine its c...</td>
      <td>Kritt</td>
      <td>90</td>
      <td>30.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Gresser 2013 Kritt Gewurztraminer (Als...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Gresser</td>
    </tr>
    <tr>
      <th>129969</th>
      <td>France</td>
      <td>A dry style of Pinot Gris, this is crisp with ...</td>
      <td>NaN</td>
      <td>90</td>
      <td>32.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Marcel Deiss 2012 Pinot Gris (Alsace)</td>
      <td>Pinot Gris</td>
      <td>Domaine Marcel Deiss</td>
    </tr>
    <tr>
      <th>129970</th>
      <td>France</td>
      <td>Big, rich and off-dry, this is powered by inte...</td>
      <td>Lieu-dit Harth Cuvée Caroline</td>
      <td>90</td>
      <td>21.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Schoffit 2012 Lieu-dit Harth Cuvée Car...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Schoffit</td>
    </tr>
  </tbody>
</table>
<p>129971 rows × 13 columns</p>
</div>



<p>2.将数据集中的索引名称设置为 <code>wines</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reviews.rename_axis(<span class="string">&quot;wines&quot;</span>, axis=<span class="string">&#x27;columns&#x27;</span>)</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>wines</th>
      <th>country</th>
      <th>description</th>
      <th>designation</th>
      <th>points</th>
      <th>price</th>
      <th>province</th>
      <th>region_1</th>
      <th>region_2</th>
      <th>taster_name</th>
      <th>taster_twitter_handle</th>
      <th>title</th>
      <th>variety</th>
      <th>winery</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Italy</td>
      <td>Aromas include tropical fruit, broom, brimston...</td>
      <td>Vulkà Bianco</td>
      <td>87</td>
      <td>NaN</td>
      <td>Sicily &amp; Sardinia</td>
      <td>Etna</td>
      <td>NaN</td>
      <td>Kerin O’Keefe</td>
      <td>@kerinokeefe</td>
      <td>Nicosia 2013 Vulkà Bianco  (Etna)</td>
      <td>White Blend</td>
      <td>Nicosia</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Portugal</td>
      <td>This is ripe and fruity, a wine that is smooth...</td>
      <td>Avidagos</td>
      <td>87</td>
      <td>15.0</td>
      <td>Douro</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Quinta dos Avidagos 2011 Avidagos Red (Douro)</td>
      <td>Portuguese Red</td>
      <td>Quinta dos Avidagos</td>
    </tr>
    <tr>
      <th>2</th>
      <td>US</td>
      <td>Tart and snappy, the flavors of lime flesh and...</td>
      <td>NaN</td>
      <td>87</td>
      <td>14.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Rainstorm 2013 Pinot Gris (Willamette Valley)</td>
      <td>Pinot Gris</td>
      <td>Rainstorm</td>
    </tr>
    <tr>
      <th>3</th>
      <td>US</td>
      <td>Pineapple rind, lemon pith and orange blossom ...</td>
      <td>Reserve Late Harvest</td>
      <td>87</td>
      <td>13.0</td>
      <td>Michigan</td>
      <td>Lake Michigan Shore</td>
      <td>NaN</td>
      <td>Alexander Peartree</td>
      <td>NaN</td>
      <td>St. Julian 2013 Reserve Late Harvest Riesling ...</td>
      <td>Riesling</td>
      <td>St. Julian</td>
    </tr>
    <tr>
      <th>4</th>
      <td>US</td>
      <td>Much like the regular bottling from 2012, this...</td>
      <td>Vintner's Reserve Wild Child Block</td>
      <td>87</td>
      <td>65.0</td>
      <td>Oregon</td>
      <td>Willamette Valley</td>
      <td>Willamette Valley</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Sweet Cheeks 2012 Vintner's Reserve Wild Child...</td>
      <td>Pinot Noir</td>
      <td>Sweet Cheeks</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>129966</th>
      <td>Germany</td>
      <td>Notes of honeysuckle and cantaloupe sweeten th...</td>
      <td>Brauneberger Juffer-Sonnenuhr Spätlese</td>
      <td>90</td>
      <td>28.0</td>
      <td>Mosel</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Anna Lee C. Iijima</td>
      <td>NaN</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef) 2013 ...</td>
      <td>Riesling</td>
      <td>Dr. H. Thanisch (Erben Müller-Burggraef)</td>
    </tr>
    <tr>
      <th>129967</th>
      <td>US</td>
      <td>Citation is given as much as a decade of bottl...</td>
      <td>NaN</td>
      <td>90</td>
      <td>75.0</td>
      <td>Oregon</td>
      <td>Oregon</td>
      <td>Oregon Other</td>
      <td>Paul Gregutt</td>
      <td>@paulgwine</td>
      <td>Citation 2004 Pinot Noir (Oregon)</td>
      <td>Pinot Noir</td>
      <td>Citation</td>
    </tr>
    <tr>
      <th>129968</th>
      <td>France</td>
      <td>Well-drained gravel soil gives this wine its c...</td>
      <td>Kritt</td>
      <td>90</td>
      <td>30.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Gresser 2013 Kritt Gewurztraminer (Als...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Gresser</td>
    </tr>
    <tr>
      <th>129969</th>
      <td>France</td>
      <td>A dry style of Pinot Gris, this is crisp with ...</td>
      <td>NaN</td>
      <td>90</td>
      <td>32.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Marcel Deiss 2012 Pinot Gris (Alsace)</td>
      <td>Pinot Gris</td>
      <td>Domaine Marcel Deiss</td>
    </tr>
    <tr>
      <th>129970</th>
      <td>France</td>
      <td>Big, rich and off-dry, this is powered by inte...</td>
      <td>Lieu-dit Harth Cuvée Caroline</td>
      <td>90</td>
      <td>21.0</td>
      <td>Alsace</td>
      <td>Alsace</td>
      <td>NaN</td>
      <td>Roger Voss</td>
      <td>@vossroger</td>
      <td>Domaine Schoffit 2012 Lieu-dit Harth Cuvée Car...</td>
      <td>Gewürztraminer</td>
      <td>Domaine Schoffit</td>
    </tr>
  </tbody>
</table>
<p>129971 rows × 13 columns</p>
</div>



<p>3.Things on Reddit 数据集包含了来自 reddit.com 上部分排名靠前的论坛（”subreddits”）的产品链接。运行下面的单元格，加载在 <code>/r/gaming</code> 子论坛上提到的产品的数据框，以及在 <code>r//movies</code> 子论坛上提到的产品的数据框。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gaming_products = pd.read_csv(<span class="string">&quot;datasets/top-things/reddits/g/gaming.csv&quot;</span>)</span><br><span class="line">gaming_products[<span class="string">&#x27;subreddit&#x27;</span>] = <span class="string">&quot;r/gaming&quot;</span></span><br><span class="line">movie_products = pd.read_csv(<span class="string">&quot;datasets/top-things/reddits/m/movies.csv&quot;</span>)</span><br><span class="line">movie_products[<span class="string">&#x27;subreddit&#x27;</span>] = <span class="string">&quot;r/movies&quot;</span></span><br></pre></td></tr></table></figure>

<p>创建一个包含 Reddit 子版块中提到的产品(<code>either subreddit</code>)的 <code>DataFrame</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gaming_products.head()</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>category</th>
      <th>amazon_link</th>
      <th>total_mentions</th>
      <th>subreddit_mentions</th>
      <th>subreddit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>BOOMco Halo Covenant Needler Blaster</td>
      <td>Toys &amp; Games</td>
      <td>https://www.amazon.com/BOOMco-Halo-Covenant-Ne...</td>
      <td>4.0</td>
      <td>4</td>
      <td>r/gaming</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Raspberry PI 3 Model B 1.2GHz 64-bit quad-core...</td>
      <td>Electronics</td>
      <td>https://www.amazon.com/Raspberry-Model-A1-2GHz...</td>
      <td>19.0</td>
      <td>3</td>
      <td>r/gaming</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CanaKit 5V 2.5A Raspberry Pi 3 Power Supply / ...</td>
      <td>Electronics</td>
      <td>https://www.amazon.com/CanaKit-Raspberry-Suppl...</td>
      <td>7.0</td>
      <td>3</td>
      <td>r/gaming</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Panasonic K-KJ17MCA4BA Advanced Individual Cel...</td>
      <td>Electronics</td>
      <td>https://www.amazon.com/Panasonic-Advanced-Indi...</td>
      <td>29.0</td>
      <td>2</td>
      <td>r/gaming</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Mayflash GameCube Controller Adapter for Wii U...</td>
      <td>Electronics</td>
      <td>https://www.amazon.com/GameCube-Controller-Ada...</td>
      <td>24.0</td>
      <td>2</td>
      <td>r/gaming</td>
    </tr>
  </tbody>
</table>
</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.concat([gaming_products,movie_products])</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>category</th>
      <th>amazon_link</th>
      <th>total_mentions</th>
      <th>subreddit_mentions</th>
      <th>subreddit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>BOOMco Halo Covenant Needler Blaster</td>
      <td>Toys &amp; Games</td>
      <td>https://www.amazon.com/BOOMco-Halo-Covenant-Ne...</td>
      <td>4.0</td>
      <td>4</td>
      <td>r/gaming</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Raspberry PI 3 Model B 1.2GHz 64-bit quad-core...</td>
      <td>Electronics</td>
      <td>https://www.amazon.com/Raspberry-Model-A1-2GHz...</td>
      <td>19.0</td>
      <td>3</td>
      <td>r/gaming</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CanaKit 5V 2.5A Raspberry Pi 3 Power Supply / ...</td>
      <td>Electronics</td>
      <td>https://www.amazon.com/CanaKit-Raspberry-Suppl...</td>
      <td>7.0</td>
      <td>3</td>
      <td>r/gaming</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Panasonic K-KJ17MCA4BA Advanced Individual Cel...</td>
      <td>Electronics</td>
      <td>https://www.amazon.com/Panasonic-Advanced-Indi...</td>
      <td>29.0</td>
      <td>2</td>
      <td>r/gaming</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Mayflash GameCube Controller Adapter for Wii U...</td>
      <td>Electronics</td>
      <td>https://www.amazon.com/GameCube-Controller-Ada...</td>
      <td>24.0</td>
      <td>2</td>
      <td>r/gaming</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>298</th>
      <td>Welcome to Night Vale CD: A Novel</td>
      <td>Books</td>
      <td>https://www.amazon.com/Welcome-Night-Vale-CD-N...</td>
      <td>1.0</td>
      <td>1</td>
      <td>r/movies</td>
    </tr>
    <tr>
      <th>299</th>
      <td>Ran (StudioCanal Collection) [Blu-ray]</td>
      <td>Movies &amp; TV</td>
      <td>https://www.amazon.com/StudioCanal-Collection-...</td>
      <td>1.0</td>
      <td>1</td>
      <td>r/movies</td>
    </tr>
    <tr>
      <th>300</th>
      <td>The Art of John Alvin</td>
      <td>Books</td>
      <td>https://www.amazon.com/Art-John-Alvin-Andrea/d...</td>
      <td>1.0</td>
      <td>1</td>
      <td>r/movies</td>
    </tr>
    <tr>
      <th>301</th>
      <td>Apocalypto [Blu-ray]</td>
      <td>Movies &amp; TV</td>
      <td>https://www.amazon.com/Apocalypto-Blu-ray-Rudy...</td>
      <td>1.0</td>
      <td>1</td>
      <td>r/movies</td>
    </tr>
    <tr>
      <th>302</th>
      <td>Cinelinx: A Card Game for People Who Love Movi...</td>
      <td>Toys &amp; Games</td>
      <td>https://www.amazon.com/Cinelinx-Card-Game-Peop...</td>
      <td>1.0</td>
      <td>1</td>
      <td>r/movies</td>
    </tr>
  </tbody>
</table>
<p>796 rows × 6 columns</p>
</div>



<p>4.Kaggle 上的举重数据库数据集包括一张用于举重比赛的 CSV 表和一张单独的举重参赛者表。运行下面的单元格将这些数据集加载到数据框中：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">powerlifting_meets = pd.read_csv(<span class="string">&quot;datasets/openpowerlifting/v1/meets.csv&quot;</span>)</span><br><span class="line">powerlifting_competitors =  pd.read_csv(<span class="string">&quot;datasets/openpowerlifting/v1/openpowerlifting.csv&quot;</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powerlifting_competitors</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MeetID</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Equipment</th>
      <th>Age</th>
      <th>Division</th>
      <th>BodyweightKg</th>
      <th>WeightClassKg</th>
      <th>Squat4Kg</th>
      <th>BestSquatKg</th>
      <th>Bench4Kg</th>
      <th>BestBenchKg</th>
      <th>Deadlift4Kg</th>
      <th>BestDeadliftKg</th>
      <th>TotalKg</th>
      <th>Place</th>
      <th>Wilks</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Angie Belk Terry</td>
      <td>F</td>
      <td>Wraps</td>
      <td>47.0</td>
      <td>Mst 45-49</td>
      <td>59.60</td>
      <td>60</td>
      <td>NaN</td>
      <td>47.63</td>
      <td>NaN</td>
      <td>20.41</td>
      <td>NaN</td>
      <td>70.31</td>
      <td>138.35</td>
      <td>1</td>
      <td>155.05</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>Dawn Bogart</td>
      <td>F</td>
      <td>Single-ply</td>
      <td>42.0</td>
      <td>Mst 40-44</td>
      <td>58.51</td>
      <td>60</td>
      <td>NaN</td>
      <td>142.88</td>
      <td>NaN</td>
      <td>95.25</td>
      <td>NaN</td>
      <td>163.29</td>
      <td>401.42</td>
      <td>1</td>
      <td>456.38</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>Dawn Bogart</td>
      <td>F</td>
      <td>Single-ply</td>
      <td>42.0</td>
      <td>Open Senior</td>
      <td>58.51</td>
      <td>60</td>
      <td>NaN</td>
      <td>142.88</td>
      <td>NaN</td>
      <td>95.25</td>
      <td>NaN</td>
      <td>163.29</td>
      <td>401.42</td>
      <td>1</td>
      <td>456.38</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>Dawn Bogart</td>
      <td>F</td>
      <td>Raw</td>
      <td>42.0</td>
      <td>Open Senior</td>
      <td>58.51</td>
      <td>60</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>95.25</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>95.25</td>
      <td>1</td>
      <td>108.29</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>Destiny Dula</td>
      <td>F</td>
      <td>Raw</td>
      <td>18.0</td>
      <td>Teen 18-19</td>
      <td>63.68</td>
      <td>67.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>31.75</td>
      <td>NaN</td>
      <td>90.72</td>
      <td>122.47</td>
      <td>1</td>
      <td>130.47</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>386409</th>
      <td>8481</td>
      <td>William Barabas</td>
      <td>M</td>
      <td>Multi-ply</td>
      <td>NaN</td>
      <td>Elite</td>
      <td>113.58</td>
      <td>125</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>347.50</td>
      <td>347.50</td>
      <td>2</td>
      <td>202.60</td>
    </tr>
    <tr>
      <th>386410</th>
      <td>8481</td>
      <td>Justin Zottl</td>
      <td>M</td>
      <td>Multi-ply</td>
      <td>NaN</td>
      <td>Elite</td>
      <td>119.02</td>
      <td>125</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>322.50</td>
      <td>322.50</td>
      <td>3</td>
      <td>185.77</td>
    </tr>
    <tr>
      <th>386411</th>
      <td>8481</td>
      <td>Jake Anderson</td>
      <td>M</td>
      <td>Multi-ply</td>
      <td>NaN</td>
      <td>Elite</td>
      <td>120.29</td>
      <td>125</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>367.50</td>
      <td>367.50</td>
      <td>1</td>
      <td>211.17</td>
    </tr>
    <tr>
      <th>386412</th>
      <td>8481</td>
      <td>Jeff Bumanglag</td>
      <td>M</td>
      <td>Multi-ply</td>
      <td>NaN</td>
      <td>Elite</td>
      <td>126.73</td>
      <td>140</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>320.00</td>
      <td>320.00</td>
      <td>3</td>
      <td>181.85</td>
    </tr>
    <tr>
      <th>386413</th>
      <td>8481</td>
      <td>Shane Hammock</td>
      <td>M</td>
      <td>Multi-ply</td>
      <td>NaN</td>
      <td>Elite</td>
      <td>129.46</td>
      <td>140</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>362.50</td>
      <td>362.50</td>
      <td>2</td>
      <td>205.18</td>
    </tr>
  </tbody>
</table>
<p>386414 rows × 17 columns</p>
</div>



<p>两个表都包含对 <code>MeetID</code> 的引用，MeetID 是数据库中包含的每次会议（竞赛）的唯一键。使用它，生成一个将两个表合并为一个的数据集。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">left = powerlifting_meets.set_index([<span class="string">&#x27;MeetID&#x27;</span>])</span><br><span class="line">right = powerlifting_competitors.set_index([<span class="string">&#x27;MeetID&#x27;</span>])</span><br><span class="line">left.join(right)</span><br><span class="line"><span class="comment"># powerlifting_meets.join(powerlifting_competitors)</span></span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th &#123;
    vertical-align: top;
&#125;

.dataframe thead th &#123;
    text-align: right;
&#125;
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MeetPath</th>
      <th>Federation</th>
      <th>Date</th>
      <th>MeetCountry</th>
      <th>MeetState</th>
      <th>MeetTown</th>
      <th>MeetName</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Equipment</th>
      <th>...</th>
      <th>WeightClassKg</th>
      <th>Squat4Kg</th>
      <th>BestSquatKg</th>
      <th>Bench4Kg</th>
      <th>BestBenchKg</th>
      <th>Deadlift4Kg</th>
      <th>BestDeadliftKg</th>
      <th>TotalKg</th>
      <th>Place</th>
      <th>Wilks</th>
    </tr>
    <tr>
      <th>MeetID</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>365strong/1601</td>
      <td>365Strong</td>
      <td>2016-10-29</td>
      <td>USA</td>
      <td>NC</td>
      <td>Charlotte</td>
      <td>2016 Junior &amp; Senior National Powerlifting Cha...</td>
      <td>Angie Belk Terry</td>
      <td>F</td>
      <td>Wraps</td>
      <td>...</td>
      <td>60</td>
      <td>NaN</td>
      <td>47.63</td>
      <td>NaN</td>
      <td>20.41</td>
      <td>NaN</td>
      <td>70.31</td>
      <td>138.35</td>
      <td>1</td>
      <td>155.05</td>
    </tr>
    <tr>
      <th>0</th>
      <td>365strong/1601</td>
      <td>365Strong</td>
      <td>2016-10-29</td>
      <td>USA</td>
      <td>NC</td>
      <td>Charlotte</td>
      <td>2016 Junior &amp; Senior National Powerlifting Cha...</td>
      <td>Dawn Bogart</td>
      <td>F</td>
      <td>Single-ply</td>
      <td>...</td>
      <td>60</td>
      <td>NaN</td>
      <td>142.88</td>
      <td>NaN</td>
      <td>95.25</td>
      <td>NaN</td>
      <td>163.29</td>
      <td>401.42</td>
      <td>1</td>
      <td>456.38</td>
    </tr>
    <tr>
      <th>0</th>
      <td>365strong/1601</td>
      <td>365Strong</td>
      <td>2016-10-29</td>
      <td>USA</td>
      <td>NC</td>
      <td>Charlotte</td>
      <td>2016 Junior &amp; Senior National Powerlifting Cha...</td>
      <td>Dawn Bogart</td>
      <td>F</td>
      <td>Single-ply</td>
      <td>...</td>
      <td>60</td>
      <td>NaN</td>
      <td>142.88</td>
      <td>NaN</td>
      <td>95.25</td>
      <td>NaN</td>
      <td>163.29</td>
      <td>401.42</td>
      <td>1</td>
      <td>456.38</td>
    </tr>
    <tr>
      <th>0</th>
      <td>365strong/1601</td>
      <td>365Strong</td>
      <td>2016-10-29</td>
      <td>USA</td>
      <td>NC</td>
      <td>Charlotte</td>
      <td>2016 Junior &amp; Senior National Powerlifting Cha...</td>
      <td>Dawn Bogart</td>
      <td>F</td>
      <td>Raw</td>
      <td>...</td>
      <td>60</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>95.25</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>95.25</td>
      <td>1</td>
      <td>108.29</td>
    </tr>
    <tr>
      <th>0</th>
      <td>365strong/1601</td>
      <td>365Strong</td>
      <td>2016-10-29</td>
      <td>USA</td>
      <td>NC</td>
      <td>Charlotte</td>
      <td>2016 Junior &amp; Senior National Powerlifting Cha...</td>
      <td>Destiny Dula</td>
      <td>F</td>
      <td>Raw</td>
      <td>...</td>
      <td>67.5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>31.75</td>
      <td>NaN</td>
      <td>90.72</td>
      <td>122.47</td>
      <td>1</td>
      <td>130.47</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>8481</th>
      <td>xpc/2017-finals</td>
      <td>XPC</td>
      <td>2017-03-03</td>
      <td>USA</td>
      <td>OH</td>
      <td>Columbus</td>
      <td>2017 XPC Finals</td>
      <td>William Barabas</td>
      <td>M</td>
      <td>Multi-ply</td>
      <td>...</td>
      <td>125</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>347.50</td>
      <td>347.50</td>
      <td>2</td>
      <td>202.60</td>
    </tr>
    <tr>
      <th>8481</th>
      <td>xpc/2017-finals</td>
      <td>XPC</td>
      <td>2017-03-03</td>
      <td>USA</td>
      <td>OH</td>
      <td>Columbus</td>
      <td>2017 XPC Finals</td>
      <td>Justin Zottl</td>
      <td>M</td>
      <td>Multi-ply</td>
      <td>...</td>
      <td>125</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>322.50</td>
      <td>322.50</td>
      <td>3</td>
      <td>185.77</td>
    </tr>
    <tr>
      <th>8481</th>
      <td>xpc/2017-finals</td>
      <td>XPC</td>
      <td>2017-03-03</td>
      <td>USA</td>
      <td>OH</td>
      <td>Columbus</td>
      <td>2017 XPC Finals</td>
      <td>Jake Anderson</td>
      <td>M</td>
      <td>Multi-ply</td>
      <td>...</td>
      <td>125</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>367.50</td>
      <td>367.50</td>
      <td>1</td>
      <td>211.17</td>
    </tr>
    <tr>
      <th>8481</th>
      <td>xpc/2017-finals</td>
      <td>XPC</td>
      <td>2017-03-03</td>
      <td>USA</td>
      <td>OH</td>
      <td>Columbus</td>
      <td>2017 XPC Finals</td>
      <td>Jeff Bumanglag</td>
      <td>M</td>
      <td>Multi-ply</td>
      <td>...</td>
      <td>140</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>320.00</td>
      <td>320.00</td>
      <td>3</td>
      <td>181.85</td>
    </tr>
    <tr>
      <th>8481</th>
      <td>xpc/2017-finals</td>
      <td>XPC</td>
      <td>2017-03-03</td>
      <td>USA</td>
      <td>OH</td>
      <td>Columbus</td>
      <td>2017 XPC Finals</td>
      <td>Shane Hammock</td>
      <td>M</td>
      <td>Multi-ply</td>
      <td>...</td>
      <td>140</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>362.50</td>
      <td>362.50</td>
      <td>2</td>
      <td>205.18</td>
    </tr>
  </tbody>
</table>
<p>386414 rows × 23 columns</p>
</div>



<h1 id="完成"><a href="#完成" class="headerlink" title="完成"></a>完成</h1><p><img src="/./pic/%E5%AD%A6%E4%B9%A0pandas-%E4%BB%8Ekaggle%E4%B8%8A/55173134486000.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<p>test for vue</p>
<p>aaaaaaa</p>
<!-- <h1 id="app"></h1> -->

<!-- <div id="app"></div> -->

<div id="app">
  <h1></h1>
  <button v-on:click="changeMessage">Change Message</button>
</div>

<!-- <script>
  const { createApp, ref } = Vue

  createApp({
    setup() {
      const message = ref('Hello vue!')
      return {
        message
      }
    }
  }).mount('#app')

var kkkk ="aaaaaaaaaaa"
</script> -->

<h1>sssssss</h1></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://eshyee.github.io">SHYEE</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://eshyee.github.io/2023/07/18/%E5%AD%A6%E4%B9%A0pandas-%E4%BB%8Ekaggle%E4%B8%8A/">https://eshyee.github.io/2023/07/18/%E5%AD%A6%E4%B9%A0pandas-%E4%BB%8Ekaggle%E4%B8%8A/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/python/">python</a><a class="post-meta__tags" href="/tags/pandas/">pandas</a><a class="post-meta__tags" href="/tags/kaggle/">kaggle</a></div><div class="post_share"><div class="social-share" data-image="https://source.unsplash.com/1920x1080/?plasma" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/07/19/Discharge-Directionality-and-Dominance-of-Right-Handed-Modes-in-Helicon-Plasmas-due-to-Radial-Electron-Density-Gradients/" title="Discharge Directionality and Dominance of Right-Handed Modes in Helicon Plasmas due to Radial Electron Density Gradients"><img class="cover" src="https://source.unsplash.com/1920x1080/?plasma" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Discharge Directionality and Dominance of Right-Handed Modes in Helicon Plasmas due to Radial Electron Density Gradients</div></div></a></div><div class="next-post pull-right"><a href="/2023/07/15/%E8%AE%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84%E4%BA%BA%E8%84%B8%E8%AF%86%E5%88%AB/" title="记一个简单的人脸识别"><img class="cover" src="https://source.unsplash.com/1920x1080/?plasma" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">记一个简单的人脸识别</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2023/09/21/diffusion-model/" title="diffusion model"><img class="cover" src="https://source.unsplash.com/1920x1080/?plasma" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-21</div><div class="title">diffusion model</div></div></a></div><div><a href="/2020/03/05/python%E5%85%A5%E9%97%A82/" title="python入门2"><img class="cover" src="https://source.unsplash.com/1920x1080/?plasma" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-03-05</div><div class="title">python入门2</div></div></a></div><div><a href="/2020/03/05/python%E5%85%A5%E9%97%A8/" title="python入门"><img class="cover" src="https://source.unsplash.com/1920x1080/?plasma" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-03-05</div><div class="title">python入门</div></div></a></div><div><a href="/2020/03/05/python%E5%85%A5%E9%97%A83/" title="python入门3"><img class="cover" src="https://source.unsplash.com/1920x1080/?plasma" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-03-05</div><div class="title">python入门3</div></div></a></div><div><a href="/2021/03/30/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" title="机器学习"><img class="cover" src="https://source.unsplash.com/1920x1080/?plasma" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-30</div><div class="title">机器学习</div></div></a></div><div><a href="/2023/09/04/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%B0%8Ftips/" title="深度学习小tips"><img class="cover" src="https://source.unsplash.com/1920x1080/?plasma" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-09-04</div><div class="title">深度学习小tips</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/pic/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">SHYEE</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">106</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">107</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">37</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/eshyee"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/eshyee" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:eshyee@foxmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">等离子体实验室</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%88%E6%9D%A5%E4%B8%AA%E5%B0%8F%E6%B5%8B%E8%AF%95"><span class="toc-number">1.</span> <span class="toc-text">先来个小测试</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1"><span class="toc-number">1.1.</span> <span class="toc-text">1.</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2"><span class="toc-number">1.2.</span> <span class="toc-text">2.</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3"><span class="toc-number">1.3.</span> <span class="toc-text">3.</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4"><span class="toc-number">1.4.</span> <span class="toc-text">4.</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Indexing-in-pandas"><span class="toc-number">2.</span> <span class="toc-text">Indexing in pandas</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Index-based-selection"><span class="toc-number">2.1.</span> <span class="toc-text">Index-based selection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Label-based-selection"><span class="toc-number">2.2.</span> <span class="toc-text">Label-based selection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Choosing-between-loc-and-iloc"><span class="toc-number">2.3.</span> <span class="toc-text">Choosing between loc and iloc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Manipulating-the-index"><span class="toc-number">2.4.</span> <span class="toc-text">Manipulating the index</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Conditional-selection"><span class="toc-number">2.5.</span> <span class="toc-text">Conditional selection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E9%85%8D%E6%95%B0%E6%8D%AE"><span class="toc-number">2.6.</span> <span class="toc-text">分配数据</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#TEST"><span class="toc-number">3.</span> <span class="toc-text">TEST</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Summary-Functions-and-Maps"><span class="toc-number">4.</span> <span class="toc-text">Summary Functions and Maps</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-number">4.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Summary-functions"><span class="toc-number">4.2.</span> <span class="toc-text">Summary functions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Maps"><span class="toc-number">4.3.</span> <span class="toc-text">Maps</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#TEST-1"><span class="toc-number">5.</span> <span class="toc-text">TEST</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Grouping-and-Sorting"><span class="toc-number">6.</span> <span class="toc-text">Grouping and Sorting</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E5%88%86%E6%9E%90"><span class="toc-number">6.1.</span> <span class="toc-text">分组分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Multi-indexes"><span class="toc-number">6.2.</span> <span class="toc-text">Multi-indexes</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sorting"><span class="toc-number">6.3.</span> <span class="toc-text">Sorting</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#TEST-2"><span class="toc-number">7.</span> <span class="toc-text">TEST</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1"><span class="toc-number">7.1.</span> <span class="toc-text">1.</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1"><span class="toc-number">7.2.</span> <span class="toc-text">2.</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1"><span class="toc-number">7.3.</span> <span class="toc-text">3.</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1"><span class="toc-number">7.4.</span> <span class="toc-text">4.</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5"><span class="toc-number">7.5.</span> <span class="toc-text">5.</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6"><span class="toc-number">7.6.</span> <span class="toc-text">6.</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Data-Types-and-Missing-Values"><span class="toc-number">8.</span> <span class="toc-text">Data Types and Missing Values</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Dtypes"><span class="toc-number">8.1.</span> <span class="toc-text">Dtypes</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Missing-data"><span class="toc-number">8.2.</span> <span class="toc-text">Missing data</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#TEST-3"><span class="toc-number">9.</span> <span class="toc-text">TEST</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Renaming-and-Combining"><span class="toc-number">10.</span> <span class="toc-text">Renaming and Combining</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Renaming"><span class="toc-number">10.1.</span> <span class="toc-text">Renaming</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Combining"><span class="toc-number">10.2.</span> <span class="toc-text">Combining</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#TEST-4"><span class="toc-number">11.</span> <span class="toc-text">TEST</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%8C%E6%88%90"><span class="toc-number">12.</span> <span class="toc-text">完成</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#app"><span class="toc-number">13.</span> <span class="toc-text"></span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">14.</span> <span class="toc-text">sssssss</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/02/12/Deep%20learning%20via%20CNN%20for%20identification%20of%20blue%20core%20phenomenon%20in%20helicon%20plasma%20discharge/" title="Deep learning via CNN for identification of blue core phenomenon in helicon plasma discharge"><img src="https://source.unsplash.com/1920x1080/?plasma" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Deep learning via CNN for identification of blue core phenomenon in helicon plasma discharge"/></a><div class="content"><a class="title" href="/2025/02/12/Deep%20learning%20via%20CNN%20for%20identification%20of%20blue%20core%20phenomenon%20in%20helicon%20plasma%20discharge/" title="Deep learning via CNN for identification of blue core phenomenon in helicon plasma discharge">Deep learning via CNN for identification of blue core phenomenon in helicon plasma discharge</a><time datetime="2025-02-12T06:31:17.000Z" title="Created 2025-02-12 14:31:17">2025-02-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/25/Relationship-of-mode-transitions-and-standing-waves-in-helicon-plasmas/" title="Relationship of mode transitions and standing waves in helicon plasmas"><img src="https://source.unsplash.com/1920x1080/?plasma" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Relationship of mode transitions and standing waves in helicon plasmas"/></a><div class="content"><a class="title" href="/2023/10/25/Relationship-of-mode-transitions-and-standing-waves-in-helicon-plasmas/" title="Relationship of mode transitions and standing waves in helicon plasmas">Relationship of mode transitions and standing waves in helicon plasmas</a><time datetime="2023-10-25T11:30:28.000Z" title="Created 2023-10-25 19:30:28">2023-10-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/14/Effects-of-magnetic-field-on-electron-power-absorption-in-helicon-fluid-simulation/" title="Effects of magnetic field on electron power absorption in helicon fluid simulation"><img src="https://source.unsplash.com/1920x1080/?plasma" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Effects of magnetic field on electron power absorption in helicon fluid simulation"/></a><div class="content"><a class="title" href="/2023/10/14/Effects-of-magnetic-field-on-electron-power-absorption-in-helicon-fluid-simulation/" title="Effects of magnetic field on electron power absorption in helicon fluid simulation">Effects of magnetic field on electron power absorption in helicon fluid simulation</a><time datetime="2023-10-14T08:09:12.000Z" title="Created 2023-10-14 16:09:12">2023-10-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/07/Damping-characteristics-of-helicon-and-Trivelpiece%E2%80%93Gould-waves-in-high-density-and-low-magnetic-field-helicon-plasma/" title="Damping characteristics of helicon and Trivelpiece–Gould waves in high density and low magnetic field helicon plasma"><img src="https://source.unsplash.com/1920x1080/?plasma" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Damping characteristics of helicon and Trivelpiece–Gould waves in high density and low magnetic field helicon plasma"/></a><div class="content"><a class="title" href="/2023/10/07/Damping-characteristics-of-helicon-and-Trivelpiece%E2%80%93Gould-waves-in-high-density-and-low-magnetic-field-helicon-plasma/" title="Damping characteristics of helicon and Trivelpiece–Gould waves in high density and low magnetic field helicon plasma">Damping characteristics of helicon and Trivelpiece–Gould waves in high density and low magnetic field helicon plasma</a><time datetime="2023-10-07T03:15:01.000Z" title="Created 2023-10-07 11:15:01">2023-10-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/09/28/vue/" title="vue"><img src="https://source.unsplash.com/1920x1080/?plasma" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="vue"/></a><div class="content"><a class="title" href="/2023/09/28/vue/" title="vue">vue</a><time datetime="2023-09-28T02:48:17.000Z" title="Created 2023-09-28 10:48:17">2023-09-28</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2025 By SHYEE</div><div class="framework-info"></div><div class="footer_custom_text">Hi, welcome to <a target="_blank" rel="noopener" href="http://shyee.club">SHYEECLUB</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"></div><script src="http://shyee.club/js/test.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>